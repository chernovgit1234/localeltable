(function(){var t={75473:function(t){const e="ศูนย์บาทถ้วน",n=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],r=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function o(t){let e="";const i=t.length,a=7;if(i>a){const e=i-a+1,n=t.slice(0,e),r=t.slice(e);return o(n)+"ล้าน"+o(r)}for(let o=0;o<i;o++){const a=t[o];a>0&&(e+=n[a]+r[i-o-1])}return e}function i(t){let e=t;e=e.replace("หนึ่งสิบ","สิบ"),e=e.replace("สองสิบ","ยี่สิบ");const n=5;return e.length>n&&e.length-e.lastIndexOf("หนึ่ง")===n&&(e=e.substr(0,e.length-n)+"เอ็ด"),e}function a(t,n){let r="";return r=""===t&&""===n?e:""!==t&&""===n?t+"บาทถ้วน":""===t&&""!==n?n+"สตางค์":t+"บาท"+n+"สตางค์",r}function c(t){let n=e;if(isNaN(t))return n;if(t>=Number.MAX_SAFE_INTEGER)return n;const r=Math.floor(t).toString(),c=Math.round(t%1*100).toString(),s=Array.from(r).map(Number),u=Array.from(c).map(Number);let f=o(s),l=o(u);return f=i(f),l=i(l),n=a(f,l),n}null!=t.exports&&(t.exports=c)},84856:function(t,e){(function(t){"undefined"===typeof DO_NOT_EXPORT_BESSEL?t(e):t({})})((function(t){t.version="1.0.2";var e=Math;function n(t,e){for(var n=0,r=0;n<t.length;++n)r=e*r+t[n];return r}function r(t,e,n,r,o){if(0===e)return n;if(1===e)return r;for(var i=2/t,a=r,c=1;c<e;++c)a=r*c*i+o*n,n=r,r=a;return a}function o(t,e,n,o,i){return function(n,a){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}if(0===a)return t(n);if(1===a)return e(n);if(a<0)return NaN;a|=0;var c=t(n),s=e(n);return r(n,a,c,s,i)}}var i=function(){var t=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(r){var s=0,u=0,f=0,l=r*r;if(r<8)u=n(o,l),f=n(i,l),s=u/f;else{var h=r-.785398164;l=64/l,u=n(a,l),f=n(c,l),s=e.sqrt(t/r)*(e.cos(h)*u-e.sin(h)*f*8/r)}return s}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),f=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(r){var o=0,i=0,a=0,c=r*r,s=e.abs(r)-2.356194491;return Math.abs(r)<8?(i=r*n(u,c),a=n(f,c),o=i/a):(c=64/c,i=n(l,c),a=n(h,c),o=e.sqrt(t/e.abs(r))*(e.cos(s)*i-e.sin(s)*a*8/e.abs(r)),r<0&&(o=-o)),o}return function t(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*t(n,-o);if(n<0)return(o%2?-1:1)*t(-n,o);if(0===o)return s(n);if(1===o)return p(n);if(0===n)return 0;var i=0;if(n>o)i=r(n,o,s(n),p(n),-1);else{for(var a=2*e.floor((o+e.floor(e.sqrt(40*o)))/2),c=!1,u=0,f=0,l=1,h=0,d=2/n,m=a;m>0;m--)h=m*d*l-u,u=l,l=h,e.abs(l)>1e10&&(l*=1e-10,u*=1e-10,i*=1e-10,f*=1e-10),c&&(f+=l),c=!c,m==o&&(i=u);f=2*f-l,i/=f}return i}}(),a=function(){var t=.636619772,r=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),a=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),c=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse();function u(o){var u=0,f=0,l=0,h=o*o,p=o-.785398164;return o<8?(f=n(r,h),l=n(a,h),u=f/l+t*i(o,0)*e.log(o)):(h=64/h,f=n(c,h),l=n(s,h),u=e.sqrt(t/o)*(e.sin(p)*f+e.cos(p)*l*8/o)),u}var f=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function d(r){var o=0,a=0,c=0,s=r*r,u=r-2.356194491;return r<8?(a=r*n(f,s),c=n(l,s),o=a/c+t*(i(r,1)*e.log(r)-1/r)):(s=64/s,a=n(h,s),c=n(p,s),o=e.sqrt(t/r)*(e.sin(u)*a+e.cos(u)*c*8/r)),o}return o(u,d,"BESSELY",1,-1)}(),c=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),r=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function o(o){return o<=3.75?n(t,o*o/14.0625):e.exp(e.abs(o))/e.sqrt(e.abs(o))*n(r,3.75/e.abs(o))}var i=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function c(t){return t<3.75?t*n(i,t*t/14.0625):(t<0?-1:1)*e.exp(e.abs(t))/e.sqrt(e.abs(t))*n(a,3.75/e.abs(t))}return function t(n,r){if(r=Math.round(r),0===r)return o(n);if(1===r)return c(n);if(r<0)return NaN;if(0===e.abs(n))return 0;if(n==1/0)return 1/0;var i,a=0,s=2/e.abs(n),u=0,f=1,l=0,h=2*e.round((r+e.round(e.sqrt(40*r)))/2);for(i=h;i>0;i--)l=i*s*f+u,u=f,f=l,e.abs(f)>1e10&&(f*=1e-10,u*=1e-10,a*=1e-10),i==r&&(a=u);return a*=t(n,0)/f,n<0&&r%2?-a:a}}(),s=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function i(o){return o<=2?-e.log(o/2)*c(o,0)+n(t,o*o/4):e.exp(-o)/e.sqrt(o)*n(r,2/o)}var a=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function u(t){return t<=2?e.log(t/2)*c(t,1)+1/t*n(a,t*t/4):e.exp(-t)/e.sqrt(t)*n(s,2/t)}return o(i,u,"BESSELK",2,1)}();t.besselj=i,t.bessely=a,t.besseli=c,t.besselk=s}))},49743:function(t,e,n){class r extends Error{constructor(t,e,n){if(super(e),null==e&&null==n&&r.errorMap.has(t))return r.errorMap.get(t);null==e&&null==n?(this._error=t,r.errorMap.set(t,this)):this._error=t,this.details=n}get error(){return this._error}get name(){return this._error}equals(t){return t instanceof r&&t._error===this._error}toString(){return this._error}}r.errorMap=new Map,r.DIV0=new r("#DIV/0!"),r.NA=new r("#N/A"),r.NAME=new r("#NAME?"),r.NULL=new r("#NULL!"),r.NUM=new r("#NUM!"),r.REF=new r("#REF!"),r.VALUE=new r("#VALUE!"),r.NOT_IMPLEMENTED=t=>new r("#NAME?",`Function ${t} is not implemented.`),r.TOO_MANY_ARGS=t=>new r("#N/A",`Function ${t} has too many arguments.`),r.ARG_MISSING=t=>{const{Types:e}=n(32272);return new r("#N/A",`Argument type ${t.map((t=>e[t])).join(", ")} is missing.`)},r.ERROR=(t,e)=>new r("#ERROR!",t,e),t.exports=r},73375:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o,c=864e5,s=new Date(Date.UTC(1900,0,1)),u=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],f=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],h=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,p=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,d=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,m=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function g(t){const e=t.match(p),n=t.match(d),r=t.match(m);return e?t=e[1]+e[3]+(new Date).getFullYear()+e[5]:n?t=n[1]+n[3]+(new Date).getFullYear()+n[5]:r&&(t=r[1]+r[3]+(new Date).getFullYear()+r[5]),new Date(Date.parse(`${t} UTC`))}function E(t){const e=t.match(h);if(!e)return;const n=e[2]?e[2]:":00",r=e[3]?e[3]:":00",o=e[4]?" "+e[4]:"",i=new Date(Date.parse(`1/1/1900 ${e[1]+n+r+o} UTC`));let a=new Date;return a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())),new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()))}function v(t){const e=t>-22038912e5?2:1;return Math.floor((t-s)/864e5)+e}function y(t){if(t<0)throw r.VALUE;return t<=60?new Date(s.getTime()+864e5*(t-1)):new Date(s.getTime()+864e5*(t-2))}function N(t){if(t instanceof Date)return{date:t};t=a.accept(t);let e,n=!0;return isNaN(t)?(e=E(t),e?n=!1:e=g(t)):(t=Number(t),e=y(t)),{date:e,isDateGiven:n}}function T(t){return N(t).date}function R(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function A(t){return 1900===t||1===new Date(t,1,29).getMonth()}const M={DATE:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>=1e4)throw r.NUM;return t<1900&&(t+=1900),v(Date.UTC(t,e-1,n))},DATEDIF:(t,e,n)=>{if(t=T(t),e=T(e),n=a.accept(n,i.STRING).toLowerCase(),t>e)throw r.NUM;const o=e.getUTCFullYear()-t.getUTCFullYear(),s=e.getUTCMonth()-t.getUTCMonth(),u=e.getUTCDate()-t.getUTCDate();let f;switch(n){case"y":return f=s<0||0===s&&u<0?-1:0,f+o;case"m":return f=u<0?-1:0,12*o+s+f;case"d":return Math.floor(e-t)/c;case"md":return t.setUTCFullYear(e.getUTCFullYear()),u<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/c;case"ym":return f=u<0?-1:0,(f+12*o+s)%12;case"yd":return s<0||0===s&&u<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/c}},DATEVALUE:t=>{t=a.accept(t,i.STRING);const{date:e,isDateGiven:n}=N(t);if(!n)return 0;const o=v(e);if(o<0||o>2958465)throw r.VALUE;return o},DAY:t=>{const e=T(t);return e.getUTCDate()},DAYS:(t,e)=>{t=T(t),e=T(e);let n=0;return e<-22038912e5&&-22038912e5<t&&(n=1),Math.floor(t-e)/c+n},DAYS360:(t,e,n)=>{t=T(t),e=T(e),n=a.accept(n,i.BOOLEAN,!1),31===t.getUTCDate()&&t.setUTCDate(30),!n&&t.getUTCDate()<30&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):31===e.getUTCDate()&&e.setUTCDate(30);const r=e.getUTCFullYear()-t.getUTCFullYear(),o=e.getUTCMonth()-t.getUTCMonth(),c=e.getUTCDate()-t.getUTCDate();return 30*o+c+12*r*30},EDATE:(t,e)=>(t=T(t),e=a.accept(e,i.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),v(t)),EOMONTH:(t,e)=>(t=T(t),e=a.accept(e,i.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),v(t)),HOUR:t=>{const e=T(t);return e.getUTCHours()},ISOWEEKNUM:t=>{const e=T(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=n.getUTCDay();n.setUTCDate(n.getUTCDate()+4-r);const o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n-o)/864e5+1)/7)},MINUTE:t=>{const e=T(t);return e.getUTCMinutes()},MONTH:t=>{const e=T(t);return e.getUTCMonth()+1},NETWORKDAYS:(t,e,n)=>{t=T(t),e=T(e);let r=1;if(t>e){r=-1;const n=t;t=e,e=n}const o=[];null!=n&&a.flattenParams([n],i.NUMBER,!1,(t=>{o.push(T(t))}));let c=0;while(t<=e){if(0!==t.getUTCDay()&&6!==t.getUTCDay()){let e=!1;for(let n=0;n<o.length;n++)if(R(t,o[n])){e=!0;break}e||c++}t.setUTCDate(t.getUTCDate()+1)}return r*c},"NETWORKDAYS.INTL":(t,e,n,o)=>{t=T(t),e=T(e);let c=1;if(t>e){c=-1;const n=t;t=e,e=n}if(n=a.accept(n,null,1),"1111111"===n)return 0;if("string"===typeof n&&Number(n).toString()!==n){if(7!==n.length)throw r.VALUE;n=n.charAt(6)+n.slice(0,6);const t=[];for(let e=0;e<n.length;e++)"1"===n.charAt(e)&&t.push(e);n=t}else{if("number"!==typeof n)throw r.VALUE;n=l[n]}const s=[];null!=o&&a.flattenParams([o],i.NUMBER,!1,(t=>{s.push(T(t))}));let u=0;while(t<=e){let e=!1;for(let r=0;r<n.length;r++)if(n[r]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let n=0;n<s.length;n++)if(R(t,s[n])){e=!0;break}e||u++}t.setUTCDate(t.getUTCDate()+1)}return c*u},NOW:()=>{const t=new Date;return v(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>{const e=T(t);return e.getUTCSeconds()},TIME:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>32767||e<0||e>32767||n<0||n>32767)throw r.NUM;return(3600*t+60*e+n)/86400},TIMEVALUE:t=>(t=T(t),(3600*t.getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400),TODAY:()=>{const t=new Date;return v(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{const n=T(t);e=a.accept(e,i.NUMBER,1);const o=n.getUTCDay(),c=f[e];if(!c)throw r.NUM;return c[o]},WEEKNUM:(t,e)=>{const n=T(t);if(e=a.accept(e,i.NUMBER,1),21===e)return M.ISOWEEKNUM(t);const r=u[e],o=new Date(Date.UTC(n.getUTCFullYear(),0,1)),c=o.getUTCDay()<r?1:0;return Math.ceil(((n-o)/864e5+1)/7)+c},WORKDAY:(t,e,n)=>M["WORKDAY.INTL"](t,e,1,n),"WORKDAY.INTL":(t,e,n,o)=>{if(t=T(t),e=a.accept(e,i.NUMBER),n=a.accept(n,null,1),"1111111"===n)throw r.VALUE;if("string"===typeof n&&Number(n).toString()!==n){if(7!==n.length)throw r.VALUE;n=n.charAt(6)+n.slice(0,6);const t=[];for(let e=0;e<n.length;e++)"1"===n.charAt(e)&&t.push(e);n=t}else{if("number"!==typeof n)throw r.VALUE;if(n=l[n],null==n)throw r.NUM}const c=[];null!=o&&a.flattenParams([o],i.NUMBER,!1,(t=>{c.push(T(t))})),t.setUTCDate(t.getUTCDate()+1);let s=0;while(s<e){let e=!1;for(let r=0;r<n.length;r++)if(n[r]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let n=0;n<c.length;n++)if(R(t,c[n])){e=!0;break}e||s++}t.setUTCDate(t.getUTCDate()+1)}return v(t)-1},YEAR:t=>{const e=T(t);return e.getUTCFullYear()},YEARFRAC:(t,e,n)=>{if(t=T(t),e=T(e),t>e){const n=t;t=e,e=n}if(n=a.accept(n,i.NUMBER,0),n=Math.trunc(n),n<0||n>4)throw r.VALUE;let o=t.getUTCDate();const c=t.getUTCMonth()+1,s=t.getUTCFullYear();let u=e.getUTCDate();const f=e.getUTCMonth()+1,l=e.getUTCFullYear();switch(n){case 0:return 31===o&&31===u?(o=30,u=30):31===o?o=30:30===o&&31===u&&(u=30),Math.abs(u+30*f+360*l-(o+30*c+360*s))/360;case 1:if(l-s<2){const n=A(s)&&1900!==s?366:365,r=M.DAYS(e,t);return r/n}{const n=l-s+1,r=(new Date(l+1,0,1)-new Date(s,0,1))/1e3/60/60/24,o=r/n;return M.DAYS(e,t)/o}case 2:return Math.abs(M.DAYS(e,t)/360);case 3:return Math.abs(M.DAYS(e,t)/365);case 4:return Math.abs(u+30*f+360*l-(o+30*c+360*s))/360}}};t.exports=M},82425:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o,c=n(47747),s=n(30285),u=2.5066282746310002,f={"BETA.DIST":(t,e,n,o,s,u)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),s=a.accept(s,i.NUMBER,0),u=a.accept(u,i.NUMBER,1),e<=0||n<=0||t<s||t>u||s===u)throw r.NUM;return t=(t-s)/(u-s),o?c.beta.cdf(t,e,n):c.beta.pdf(t,e,n)/(u-s)},"BETA.INV":(t,e,n,o,s)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.NUMBER,0),s=a.accept(s,i.NUMBER,1),e<=0||n<=0||t<=0||t>1)throw r.NUM;return c.beta.inv(t,e,n)*(s-o)+o},"BINOM.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),e<0||n<0||n>1||t<0||t>e)throw r.NUM;return o?c.binomial.cdf(t,e,n):c.binomial.pdf(t,e,n)},"BINOM.DIST.RANGE":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.NUMBER,n),t<0||e<0||e>1||n<0||n>t||o<n||o>t)throw r.NUM;let c=0;for(let r=n;r<=o;r++)c+=s.COMBIN(t,r)*Math.pow(e,r)*Math.pow(1-e,t-r);return c},"BINOM.INV":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||e<0||e>1||n<0||n>1)throw r.NUM;let o=0;while(o<=t){if(c.binomial.cdf(o,t,e)>=n)return o;o++}},"CHISQ.DIST":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw r.NUM;return n?c.chisquare.cdf(t,e):c.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw r.NUM;return 1-c.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw r.NUM;return c.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw r.NUM;return c.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{const n=a.accept(t,i.ARRAY,void 0,!1,!1),o=a.accept(e,i.ARRAY,void 0,!1,!1);if(n.length!==o.length||n[0].length!==o[0].length||1===n.length&&1===n[0].length)throw r.NA;const c=n.length,s=n[0].length;let u=(c-1)*(s-1);u=1===c?s-1:c-1;let f=0;for(let i=0;i<c;i++)for(let t=0;t<s;t++)if("number"===typeof n[i][t]&&"number"===typeof o[i][t]){if(0===o[i][t])throw r.DIV0;f+=Math.pow(n[i][t]-o[i][t],2)/o[i][t]}let l=Math.exp(-.5*f);u%2===1&&(l*=Math.sqrt(2*f/Math.PI));let h=u;while(h>=2)l=l*f/h,h-=2;let p=l,d=u;while(p>1e-15*l)d+=2,p=p*f/d,l+=p;return 1-l},"CONFIDENCE.NORM":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),n=Math.trunc(n),t<=0||t>=1||e<=0||n<1)throw r.NUM;return c.normalci(1,t,e,n)[1]-1},"CONFIDENCE.T":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),n=Math.trunc(n),t<=0||t>=1||e<=0||n<1)throw r.NUM;if(1===n)throw r.DIV0;return c.tci(1,t,e,n)[1]-1},CORREL:(t,e)=>{if(t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"===typeof t[r]&&"number"===typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;return c.corrcoeff(n,o)},"COVARIANCE.P":(t,e)=>{if(t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"===typeof t[r]&&"number"===typeof e[r]&&(n.push(t[r]),o.push(e[r]));const s=c.mean(n),u=c.mean(o);let f=0;for(let r=0;r<n.length;r++)f+=(n[r]-s)*(o[r]-u);return f/n.length},"COVARIANCE.S":(t,e)=>{if(t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"===typeof t[r]&&"number"===typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;return c.covariance(n,o)},DEVSQ:(...t)=>{let e=0,n=[];a.flattenParams(t,i.NUMBER,!0,((t,r)=>{"number"===typeof t&&(e+=t,n.push(t))}));const r=e/n.length;e=0;for(let o=0;o<n.length;o++)e+=(n[o]-r)**2;return e},"EXPON.DIST":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.BOOLEAN),t<0||e<=0)throw r.NUM;return n?c.exponential.cdf(t,e):c.exponential.pdf(t,e)},"F.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),t<0||e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),o?c.centralF.cdf(t,e,n):c.centralF.pdf(t,e,n)},"F.DIST.RT":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),1-c.centralF.cdf(t,e,n)},"F.INV":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>1)throw r.NUM;if(e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),c.centralF.inv(t,e,n)},"F.INV.RT":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>1)throw r.NUM;if(e<1||e>=Math.pow(10,10))throw r.NUM;if(n<1||n>=Math.pow(10,10))throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),c.centralF.inv(1-t,e,n)},"F.TEST":(t,e)=>{t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0);const n=[],o=[];let s=0,u=0;for(let r=0;r<Math.max(t.length,e.length);r++)"number"===typeof t[r]&&(n.push(t[r]),s+=t[r]),"number"===typeof e[r]&&(o.push(e[r]),u+=e[r]);if(n.length<=1||o.length<=1)throw r.DIV0;s/=n.length,u/=o.length;let f=0,l=0;for(let r=0;r<n.length;r++)f+=(s-n[r])**2;f/=n.length-1;for(let r=0;r<o.length;r++)l+=(u-o[r])**2;return l/=o.length-1,2*c.centralF.cdf(f/l,n.length-1,o.length-1)},FISHER:t=>{if(t=a.accept(t,i.NUMBER),t<=-1||t>=1)throw r.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{t=a.accept(t,i.NUMBER);let e=Math.exp(2*t);return(e-1)/(e+1)},FORECAST:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.ARRAY,void 0,!0,!0),n=a.accept(n,i.ARRAY,void 0,!0,!0),n.length!==e.length)throw r.NA;const o=[],s=[];let u=!0;for(let r=0;r<e.length;r++)"number"===typeof e[r]&&"number"===typeof n[r]&&(o.push(e[r]),s.push(n[r]),n[r]!==n[0]&&(u=!1));if(u)throw r.DIV0;const f=c.mean(o),l=c.mean(s);let h=0,p=0;for(let r=0;r<o.length;r++)h+=(s[r]-l)*(o[r]-f),p+=(s[r]-l)**2;const d=h/p,m=f-d*l;return m+d*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>f.FORECAST(...t),FREQUENCY:(t,e)=>{t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0);const n=[];for(let o=0;o<e.length;o++)"number"===typeof e[o]&&n.push(e[o]);n.sort(),n.push(1/0);const r=[];for(let o=0;o<n.length;o++){r[o]=[],r[o][0]=0;for(let e=0;e<t.length;e++){if("number"!==typeof t[e])continue;const i=t[e];i<=n[o]&&(r[o][0]++,t[e]=null)}}return r},GAMMA:t=>{if(t=a.accept(t,i.NUMBER),0===t||t<0&&t===Math.trunc(t))throw r.NUM;return c.gammafn(t)},"GAMMA.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),t<0||e<=0||n<=0)throw r.NUM;return o?c.gamma.cdf(t,e,n,!0):c.gamma.pdf(t,e,n,!1)},"GAMMA.INV":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>1||e<=0||n<=0)throw r.NUM;return c.gamma.inv(t,e,n)},GAMMALN:t=>{if(t=a.accept(t,i.NUMBER),t<=0)throw r.NUM;return c.gammaln(t)},"GAMMALN.PRECISE":t=>{if(t=a.accept(t,i.NUMBER),t<=0)throw r.NUM;return c.gammaln(t)},GAUSS:t=>(t=a.accept(t,i.NUMBER),c.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{const e=[];return a.flattenParams(t,i.NUMBER,!0,((t,n)=>{"number"===typeof t&&e.push(t)})),c.geomean(e)},GROWTH:(t,e,n,o)=>{t=a.accept(t,i.ARRAY,void 0,!0,!0);for(let i=0;i<t.length;i++)if("number"!==typeof t[i])throw r.VALUE;e=a.accept(e,i.ARRAY,null,!0,!0);const c=null==e;if(null==e){e=[];for(let n=1;n<=t.length;n++)e.push(n)}else{if(e.length!==t.length)throw r.REF;for(let t=0;t<e.length;t++)if("number"!==typeof e[t])throw r.VALUE}if(n=a.accept(n,i.ARRAY,null,!1,!0),null==n&&c){n=[];for(let e=1;e<=t.length;e++)n.push(e);n=[n]}else null==n&&(n=Array.isArray(e[0])?e:[e]);o=a.accept(o,i.BOOLEAN,!0);const s=t.length;let u,f,l=0,h=0,p=0,d=0;for(let r=0;r<s;r++){const n=e[r],o=Math.log(t[r]);l+=n,h+=o,p+=n*o,d+=n*n}l/=s,h/=s,p/=s,d/=s,o?(u=(p-l*h)/(d-l*l),f=h-u*l):(u=p/d,f=0);const m=[];for(let i=0;i<n.length;i++){m[i]=[];for(let t=0;t<n[0].length;t++){if("number"!==typeof n[i][t])throw r.VALUE;m[i][t]=Math.exp(f+u*n[i][t])}}return m},HARMEAN:(...t)=>{let e=0,n=0;return a.flattenParams(t,i.NUMBER,!0,((t,r)=>{"number"===typeof t&&(n+=1/t,e++)})),e/n},"HYPGEOM.DIST":(t,e,n,o,c)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.NUMBER),c=a.accept(c,i.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),n=Math.trunc(n),o=Math.trunc(o),o<=0||t<0||e<=0||n<=0)throw r.NUM;if(e>o)throw r.NUM;if(n>o)throw r.NUM;if(e<t||n<t)throw r.NUM;if(t<e-o+n)throw r.NUM;function u(t,e,n,r){return s.COMBIN(n,t)*s.COMBIN(r-n,e-t)/s.COMBIN(r,e)}function f(t,e,n,r){let o=0;for(let i=0;i<=t;i++)o+=u(i,e,n,r);return o}return c?f(t,e,n,o):u(t,e,n,o)},INTERCEPT:(t,e)=>{if(t=a.accept(t,i.ARRAY,void 0,!0,!0),e=a.accept(e,i.ARRAY,void 0,!0,!0),e.length!==t.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"===typeof t[r]&&"number"===typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;const s=c.mean(n),u=c.mean(o);let f=0,l=0;for(let r=0;r<n.length;r++)f+=(o[r]-u)*(n[r]-s),l+=(o[r]-u)**2;const h=f/l;return s-h*u},KURT:(...t)=>{let e=0,n=[];a.flattenParams(t,i.NUMBER,!0,((t,r)=>{"number"===typeof t&&(e+=t,n.push(t))}));const r=n.length;e/=r;let o=0;for(let i=0;i<r;i++)o+=Math.pow(n[i]-e,4);return o/=Math.pow(c.stdev(n,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*o-3*(r-1)*(r-1)/((r-2)*(r-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),t<=0||n<=0)throw r.NUM;return o?c.lognormal.cdf(t,e,n):c.lognormal.pdf(t,e,n)},"LOGNORM.INV":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<=0||t>=1)throw r.NUM;if(n<=0)throw r.NUM;return c.lognormal.inv(t,e,n)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),n<0||n>1)throw r.NUM;if(t<0||e<1)throw r.NUM;return o?c.negbin.cdf(t,e,n):c.negbin.pdf(t,e,n)},"NORM.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),n<=0)throw r.NUM;return o?c.normal.cdf(t,e,n):c.normal.pdf(t,e,n)},"NORM.INV":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<=0||t>=1)throw r.NUM;if(n<=0)throw r.NUM;return c.normal.inv(t,e,n)},"NORM.S.DIST":(t,e)=>(t=a.accept(t,i.NUMBER),e=a.accept(e,i.BOOLEAN),e?c.normal.cdf(t,0,1):c.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if(t=a.accept(t,i.NUMBER),t<=0||t>=1)throw r.NUM;return c.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>(t=a.accept(t,i.NUMBER),Math.exp(-.5*t*t)/u),"POISSON.DIST":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.BOOLEAN),t<0||e<0)throw r.NUM;return t=Math.trunc(t),n?c.poisson.cdf(t,e):c.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),n<=0)throw r.NUM;return(t-e)/n},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.BOOLEAN),e<1)throw r.NUM;return n?c.studentt.cdf(t,e):c.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),e<1||t<0)throw r.NUM;return 2*(1-c.studentt.cdf(t,e))},"T.DIST.RT":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),e<1)throw r.NUM;return 1-c.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<=0||t>1||e<1)throw r.NUM;return e=e%1===0?e:Math.trunc(e),c.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<=0||t>1||e<1)throw r.NUM;return e=e%1===0?e:Math.trunc(e),Math.abs(c.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,n,o)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),o=a.accept(o,i.BOOLEAN),t<0||e<=0||n<=0)throw r.NUM;return o?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},"Z.TEST":()=>{}};t.exports={DistributionFunctions:f}},82868:function(t,e,n){const r=n(49743),o=n(14632),{FormulaHelpers:i,Types:a}=n(32272),c=i,s=n(84856),u=n(47747),f=536870911,l=-536870912,h=511,p=-512,d=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,m=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,g=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function E(t){t=c.accept(t);let e=0,n=0,o="i";if("number"===typeof t)return{real:t,im:n,unit:o};if("boolean"===typeof t)throw r.VALUE;let i=t.match(d);if(i)return e=Number(i[0]),{real:e,im:n,unit:o};if(i=t.match(m),i)return n=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),o=i[0].slice(-1),{real:e,im:n,unit:o};if(i=t.match(g),i)return e=Number(i[1]),n=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),o=i[0].slice(-1),{real:e,im:n,unit:o};throw r.NUM}const v={BESSELI:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw r.NUM;return s.besseli(t,e)},BESSELJ:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw r.NUM;return s.besselj(t,e)},BESSELK:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw r.NUM;return s.besselk(t,e)},BESSELY:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw r.NUM;return s.bessely(t,e)},BIN2DEC:t=>{t=c.accept(t,a.NUMBER_NO_BOOLEAN);let e=t.toString();if(e.length>10)throw r.NUM;return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)+p:parseInt(e,2)},BIN2HEX:(t,e)=>{t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,null);const n=t.toString();if(n.length>10)throw r.NUM;if(10===n.length&&"1"===n.substring(0,1))return(parseInt(n.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const i=parseInt(t,2).toString(16);if(null==e)return i.toUpperCase();if(e<0)throw r.NUM;if(e=Math.trunc(e),e>=i.length)return(o.REPT("0",e-i.length)+i).toUpperCase();throw r.NUM},BIN2OCT:(t,e)=>{t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER,null);let n=t.toString();if(n.length>10)throw r.NUM;if(10===n.length&&"1"===n.substr(0,1))return(parseInt(n.substr(1),2)+1073741312).toString(8);let i=parseInt(t,2).toString(8);if(null==e)return i.toUpperCase();if(e<0)throw r.NUM;if(e=Math.trunc(e),e>=i.length)return o.REPT("0",e-i.length)+i;throw r.NUM},BITAND:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||e<0)throw r.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw r.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw r.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),e=Math.trunc(e),Math.abs(e)>53)throw r.NUM;if(t<0||Math.floor(t)!==t||t>0xffffffffffff)throw r.NUM;const n=e>=0?t*2**e:Math.trunc(t/2**-e);if(n>0xffffffffffff)throw r.NUM;return n},BITOR:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||e<0)throw r.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw r.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw r.NUM;return t|e},BITRSHIFT:(t,e)=>(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),v.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||t>0xffffffffffff||Math.floor(t)!==t)throw r.NUM;if(e<0||e>0xffffffffffff||Math.floor(e)!==e)throw r.NUM;return t^e},COMPLEX:(t,e,n)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),n=c.accept(n,a.STRING,"i"),"i"!==n&&"j"!==n)throw r.VALUE;if(0===t&&0===e)return 0;if(0===t)return 1===e?n:-1===e?"-"+n:e.toString()+n;if(0===e)return t.toString();{let r=e>0?"+":"";return 1===e?t.toString()+r+n:-1===e?t.toString()+r+"-"+n:t.toString()+r+e.toString()+n}},DEC2BIN:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<p||t>h)throw r.NUM;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let n=parseInt(t,10).toString(2);if(null==e)return n;if(e=Math.trunc(e),e<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n},DEC2HEX:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<-549755813888||t>549755813888)throw r.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let n=parseInt(t,10).toString(16);if(null==e)return n.toUpperCase();if(e=Math.trunc(e),e<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n.toUpperCase()},DEC2OCT:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<-536870912||t>536870912)throw r.NUM;if(t<0)return(t+1073741824).toString(8);let n=parseInt(t,10).toString(8);if(null==e)return n.toUpperCase();if(e=Math.trunc(e),e<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n},DELTA:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,0),t===e?1:0),ERF:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,0),u.erf(t)),ERFC:t=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),u.erfc(t)),GESTEP:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,0),t>=e?1:0),HEX2BIN:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let n=10===t.length&&"f"===t.substr(0,1).toLowerCase(),i=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(i<p||i>h)throw r.NUM;if(n)return"1"+o.REPT("0",9-(i+512).toString(2).length)+(i+512).toString(2);let s=i.toString(2);if(null==e)return s;if(e=Math.trunc(e),e<=0||e<s.length)throw r.NUM;return o.REPT("0",e-s.length)+s},HEX2DEC:t=>{if(t=c.accept(t,a.STRING),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if(t=c.accept(t,a.STRING),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let n=v.HEX2DEC(t);if(n>f||n<l)throw r.NUM;return v.DEC2OCT(n,e)},IMABS:t=>{const{real:e,im:n}=E(t);return Math.sqrt(Math.pow(e,2)+Math.pow(n,2))},IMAGINARY:t=>E(t).im,IMARGUMENT:t=>{const{real:e,im:n}=E(t);if(0===e&&0===n)throw r.DIV0;return 0===e&&n>0?Math.PI/2:0===e&&n<0?-Math.PI/2:e<0&&0===n?Math.PI:e>0&&0===n?0:e>0?Math.atan(n/e):e<0&&n>0?Math.atan(n/e)+Math.PI:Math.atan(n/e)-Math.PI},IMCONJUGATE:t=>{const{real:e,im:n,unit:r}=E(t);return 0!==n?v.COMPLEX(e,-n,r):""+e},IMCOS:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.cos(e)*(Math.exp(n)+Math.exp(-n))/2,i=-Math.sin(e)*(Math.exp(n)-Math.exp(-n))/2;return v.COMPLEX(o,i,r)},IMCOSH:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.cos(n)*(Math.exp(e)+Math.exp(-e))/2,i=-Math.sin(n)*(Math.exp(e)-Math.exp(-e))/2;return v.COMPLEX(o,-i,r)},IMCOT:t=>{t=c.accept(t);let e=v.IMCOS(t),n=v.IMSIN(t);return v.IMDIV(e,n)},IMCSC:t=>(t=c.accept(t),v.IMDIV("1",v.IMSIN(t))),IMCSCH:t=>(t=c.accept(t),v.IMDIV("1",v.IMSINH(t))),IMDIV:(t,e)=>{const n=E(t),o=n.real,i=n.im,a=n.unit,c=E(e),s=c.real,u=c.im,f=c.unit;if(0===s&&0===u||a!==f)throw r.NUM;let l=a,h=Math.pow(s,2)+Math.pow(u,2);return v.COMPLEX((o*s+i*u)/h,(i*s-o*u)/h,l)},IMEXP:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.exp(e);return v.COMPLEX(o*Math.cos(n),o*Math.sin(n),r)},IMLN:t=>{const{real:e,im:n,unit:r}=E(t);return v.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2))),Math.atan(n/e),r)},IMLOG10:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2)))/Math.log(10),i=Math.atan(n/e)/Math.log(10);return v.COMPLEX(o,i,r)},IMLOG2:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2)))/Math.log(2),i=Math.atan(n/e)/Math.log(2);return v.COMPLEX(o,i,r)},IMPOWER:(t,e)=>{let{unit:n}=E(t);e=c.accept(e,a.NUMBER_NO_BOOLEAN);let r=Math.pow(v.IMABS(t),e),o=v.IMARGUMENT(t),i=r*Math.cos(e*o),s=r*Math.sin(e*o);return v.COMPLEX(i,s,n)},IMPRODUCT:(...t)=>{let e,n=0;return c.flattenParams(t,null,!1,(t=>{if(0===n)e=c.accept(t),E(e);else{const n=E(e),o=n.real,i=n.im,a=n.unit,c=E(t),s=c.real,u=c.im,f=c.unit;if(a!==f)throw r.VALUE;e=v.COMPLEX(o*s-i*u,o*u+i*s)}n++}),1),e},IMREAL:t=>E(t).real,IMSEC:t=>v.IMDIV("1",v.IMCOS(t)),IMSECH:t=>v.IMDIV("1",v.IMCOSH(t)),IMSIN:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.sin(e)*(Math.exp(n)+Math.exp(-n))/2,i=Math.cos(e)*(Math.exp(n)-Math.exp(-n))/2;return v.COMPLEX(o,i,r)},IMSINH:t=>{const{real:e,im:n,unit:r}=E(t);let o=Math.cos(n)*(Math.exp(e)-Math.exp(-e))/2,i=Math.sin(n)*(Math.exp(e)+Math.exp(-e))/2;return v.COMPLEX(o,i,r)},IMSQRT:t=>{const{unit:e}=E(t);let n=Math.sqrt(v.IMABS(t)),r=v.IMARGUMENT(t);return v.COMPLEX(n*Math.cos(r/2),n*Math.sin(r/2),e)},IMSUB:(t,e)=>{const n=E(t),o=n.real,i=n.im,a=n.unit,c=E(e),s=c.real,u=c.im,f=c.unit;if(a!==f)throw r.VALUE;return v.COMPLEX(o-s,i-u,a)},IMSUM:(...t)=>{let e,n=0,o=0;return c.flattenParams(t,null,!1,(t=>{const{real:i,im:a,unit:c}=E(t);if(e||(e=c),e!==c)throw r.VALUE;n+=i,o+=a})),v.COMPLEX(n,o,e)},IMTAN:t=>{const{unit:e}=E(t);return v.IMDIV(v.IMSIN(t),v.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER,null),t.length>10)throw r.NUM;if(e>10)throw r.NUM;if(null!==e&&e<0)throw r.NUM;e=Math.trunc(e);let n=10===t.length&&"7"===t.substring(0,1),i=v.OCT2DEC(t);if(i<p||i>h)return r.NUM;if(n)return"1"+o.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);let s=i.toString(2);if(0===e)return s;if(e<s.length)throw r.NUM;return o.REPT("0",e-s.length)+s},OCT2DEC:t=>{if(t=c.accept(t,a.STRING),t.length>10)throw r.NUM;for(const n of t)if(n<"0"||n>"7")throw r.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER_NO_BOOLEAN,null),t.length>10)throw r.NUM;for(const o of t)if(o<"0"||o>"7")throw r.NUM;if(e=Math.trunc(e),e<0||e>10)throw r.NUM;let n=v.OCT2DEC(t),i=v.DEC2HEX(n);if(0===e)return i;if(e<i.length)throw r.NUM;return o.REPT("0",e-i.length)+i}};t.exports=v},22013:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o,c={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},s={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if(t=a.accept(t),t instanceof r)return c[t.toString()];throw r.NA},INFO:()=>{},ISBLANK:t=>!!t.ref&&(null==t.value||""===t.value),ISERR:t=>(t=a.accept(t),t instanceof r&&"#N/A"!==t.toString()),ISERROR:t=>(t=a.accept(t),t instanceof r),ISEVEN:t=>(t=a.accept(t,i.NUMBER),t=Math.trunc(t),t%2===0),ISLOGICAL:t=>(t=a.accept(t),"boolean"===typeof t),ISNA:t=>(t=a.accept(t),t instanceof r&&"#N/A"===t.toString()),ISNONTEXT:t=>(t=a.accept(t),"string"!==typeof t),ISNUMBER:t=>(t=a.accept(t),"number"===typeof t),ISREF:t=>!!t.ref&&((!a.isCellRef(t)||!(t.ref.row>1048576||t.ref.col>16384))&&((!a.isRangeRef(t)||!(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384))&&(t=a.accept(t),!(t instanceof r&&"#REF!"===t.toString())))),ISTEXT:t=>(t=a.accept(t),"string"===typeof t),N:t=>{t=a.accept(t);const e=typeof t;if("number"===e)return t;if("boolean"===e)return Number(t);if(t instanceof r)throw t;return 0},NA:()=>{throw r.NA},TYPE:t=>{if(t.ref){if(a.isRangeRef(t))return 16;if(a.isCellRef(t)&&(t=a.accept(t),"string"===typeof t&&0===t.length))return 1}t=a.accept(t);const e=typeof t;return"number"===e?1:"string"===e?2:"boolean"===e?4:t instanceof r?16:Array.isArray(t)?64:void 0}};t.exports=s},40548:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o;function c(t){let e=0,n=0;return a.flattenParams(t,null,!0,(t=>{const r=typeof t;"string"===r?"TRUE"===t?t=!0:"FALSE"===t&&(t=!1):"number"===r&&(t=Boolean(t)),"boolean"===typeof t&&(!0===t?e++:n++)})),[e,n]}const s={AND:(...t)=>{const[e,n]=c(t);return 0===e&&0===n?r.VALUE:e>0&&0===n},FALSE:()=>!1,IF:(t,e,n,r)=>(e=a.accept(e,i.BOOLEAN),n=a.accept(n),r=a.accept(r,null,!1),e?n:r),IFERROR:(t,e)=>t.value instanceof r?a.accept(e):a.accept(t),IFNA:function(t,e){if(arguments.length>2)throw r.TOO_MANY_ARGS("IFNA");return r.NA.equals(t.value)?a.accept(e):a.accept(t)},IFS:(...t)=>{if(t.length%2!==0)return new r("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let e=0;e<t.length/2;e++){const n=a.accept(t[2*e],i.BOOLEAN),r=a.accept(t[2*e+1]);if(n)return r}return r.NA},NOT:t=>(t=a.accept(t,i.BOOLEAN),!t),OR:(...t)=>{const[e,n]=c(t);return 0===e&&0===n?r.VALUE:e>0},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{const[e,n]=c(t);return 0===e&&0===n?r.VALUE:e%2===1}};t.exports=s},30285:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i,Factorials:a,Criteria:c}=n(32272),{Infix:s}=n(33084),u=o,f=[],l=[];function h(t){return t<=100?a[t]:f[t]>0?f[t]:f[t]=h(t-1)*t}function p(t){return 1===t||0===t?1:2===t?2:l[t]>0?l[t]:l[t]=p(t-2)*t}const d={ABS:t=>(t=u.accept(t,i.NUMBER),Math.abs(t)),AGGREGATE:(t,e,n,...r)=>{},ARABIC:t=>{if(t=u.accept(t,i.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new r("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]})),e},BASE:(t,e,n)=>{if(t=u.accept(t,i.NUMBER),t<0||t>=2**53)throw r.NUM;if(e=u.accept(e,i.NUMBER),e<2||e>36)throw r.NUM;if(n=u.accept(n,i.NUMBER,0),n<0)throw r.NUM;const o=t.toString(e).toUpperCase();return new Array(Math.max(n+1-o.length,0)).join("0")+o},CEILING:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),0===e)return 0;if(t/e%1===0)return t;const n=Math.abs(e),r=Math.floor(Math.abs(t)/n);if(t<0){const t=e<0;return t?-n*(r+1):-n*r}return(r+1)*n},"CEILING.MATH":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,t>0?1:-1),n=u.accept(n,i.NUMBER,0),t>=0)return d.CEILING(t,e);const r=n?e:0;return d.CEILING(t,e)-r},"CEILING.PRECISE":(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,1),d.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),t<0||e<0||t<e)throw r.NUM;const n=d.FACT(t),o=d.FACT(e);return n/o/d.FACT(t-e)},COMBINA:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),(0===t||1===t)&&0===e)return 1;if(t<0||e<0)throw r.NUM;return d.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=u.accept(t,i.STRING),e=u.accept(e,i.NUMBER),e=Math.trunc(e),e<2||e>36)throw r.NUM;const n=parseInt(t,e);if(isNaN(n))throw r.NUM;return n},DEGREES:t=>(t=u.accept(t,i.NUMBER),t*(180/Math.PI)),EVEN:t=>d.CEILING(t,-2),EXP:t=>(t=u.accept(t,i.NUMBER),Math.exp(t)),FACT:t=>{if(t=u.accept(t,i.NUMBER),t=Math.trunc(t),t>170||t<0)throw r.NUM;return t<=100?a[t]:h(t)},FACTDOUBLE:t=>{if(t=u.accept(t,i.NUMBER),t=Math.trunc(t),t<-1)throw r.NUM;return-1===t?1:p(t)},FLOOR:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),0===e)return 0;if(t>0&&e<0)throw r.NUM;if(t/e%1===0)return t;const n=Math.abs(e),o=Math.floor(Math.abs(t)/n);if(t<0){const t=e<0;return t?-n*o:-n*(o+1)}return o*n},"FLOOR.MATH":(t,e,n)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,t>0?1:-1),n=u.accept(n,i.NUMBER,0),0===n||t>=0?d.FLOOR(t,Math.abs(e)):d.FLOOR(t,e)+e),"FLOOR.PRECISE":(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,1),d.FLOOR(t,Math.abs(e))),GCD:(...t)=>{const e=[];u.flattenParams(t,null,!1,(t=>{if(t="boolean"===typeof t?NaN:Number(t),isNaN(t))throw r.VALUE;if(t<0||t>9007199254740990)throw r.NUM;e.push(Math.trunc(t))}),0);let n,o,i=t.length,a=Math.abs(e[0]);for(n=1;n<i;n++){o=Math.abs(e[n]);while(a&&o)a>o?a%=o:o%=a;a+=o}return a},INT:t=>(t=u.accept(t,i.NUMBER),Math.floor(t)),"ISO.CEILING":(...t)=>d["CEILING.PRECISE"](...t),LCM:(...t)=>{const e=[];u.flattenParams(t,null,!1,(t=>{if(t="boolean"===typeof t?NaN:Number(t),isNaN(t))throw r.VALUE;if(t<0||t>9007199254740990)throw r.NUM;e.push(Math.trunc(t))}),1);let n=e.length,o=Math.abs(e[0]);for(let r=1;r<n;r++){let t=Math.abs(e[r]),n=o;while(o&&t)o>t?o%=t:t%=o;o=Math.abs(n*e[r])/(o+t)}return o},LN:t=>(t=u.accept(t,i.NUMBER),Math.log(t)),LOG:(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,10),Math.log(t)/Math.log(e)),LOG10:t=>(t=u.accept(t,i.NUMBER),Math.log10(t)),MDETERM:t=>{if(t=u.accept(t,i.ARRAY,void 0,!1,!0),t[0].length!==t.length)throw r.VALUE;const e=t.length,n=t[0].length;let o,a,c=0;if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let r=0;r<n;r++){o=t[0][r],a=t[0][r];for(let i=1;i<e;i++)a*=t[i][((r+i)%n+n)%n],o*=t[i][((r-i)%n+n)%n];c+=a-o}return c},MINVERSE:t=>{},MMULT:(t,e)=>{t=u.accept(t,i.ARRAY,void 0,!1,!0),e=u.accept(e,i.ARRAY,void 0,!1,!0);const n=t.length,o=t[0].length,a=e.length,c=e[0].length,s=new Array(n);if(o!==a)throw r.VALUE;for(let i=0;i<n;i++){s[i]=new Array(c);for(let n=0;n<c;n++){s[i][n]=0;for(let a=0;a<o;a++){const o=t[i][a],c=e[a][n];if("number"!==typeof o||"number"!==typeof c)throw r.VALUE;s[i][n]+=t[i][a]*e[a][n]}}}return s},MOD:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),0===e)throw r.DIV0;return t-e*d.INT(t/e)},MROUND:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),0===e)return 0;if(t>0&&e<0||t<0&&e>0)throw r.NUM;return t/e%1===0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,n=1;return u.flattenParams(t,i.NUMBER,!1,(t=>{if(t<0)throw r.NUM;e+=t,n*=h(t)})),h(e)/n},MUNIT:t=>{t=u.accept(t,i.NUMBER);const e=[];for(let n=0;n<t;n++){const r=[];for(let e=0;e<t;e++)n===e?r.push(1):r.push(0);e.push(r)}return e},ODD:t=>{if(t=u.accept(t,i.NUMBER),0===t)return 1;let e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),t**e),PRODUCT:(...t)=>{let e=1;return u.flattenParams(t,null,!0,((t,n)=>{const r=Number(t);n.isLiteral&&!isNaN(r)?e*=r:"number"===typeof t&&(e*=t)}),1),e},QUOTIENT:(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),Math.trunc(t/e)),RADIANS:t=>(t=u.accept(t,i.NUMBER),t/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),Math.floor(Math.random()*(e-t+1)+t)),ROMAN:(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER,0),0!==e)throw Error("ROMAN: only allows form=0 (classic form).");const n=String(t).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",a=3;while(a--)o=(r[+n.pop()+10*a]||"")+o;return new Array(+n.join("")+1).join("M")+o},ROUND:(t,e)=>{t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;return e>0?r*Math.round(Math.abs(t)*n)/n:0===e?r*Math.round(Math.abs(t)):r*Math.round(Math.abs(t)/n)*n},ROUNDDOWN:(t,e)=>{t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;if(e>0){const e=1/n*.5;return r*Math.round((Math.abs(t)-e)*n)/n}if(0===e){const e=.5;return r*Math.round(Math.abs(t)-e)}{const e=.5*n;return r*Math.round((Math.abs(t)-e)/n)*n}},ROUNDUP:(t,e)=>{t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;if(e>0){const e=1/n*.5;return r*Math.round((Math.abs(t)+e)*n)/n}if(0===e){const e=.5;return r*Math.round(Math.abs(t)+e)}{const e=.5*n;return r*Math.round((Math.abs(t)+e)/n)*n}},SERIESSUM:(t,e,n,o)=>{t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER);let a,c=0;return u.flattenParams([o],i.NUMBER,!1,(o=>{if("number"!==typeof o)throw r.VALUE;0===c?a=o*Math.pow(t,e):a+=o*Math.pow(t,e+c*n),c++})),a},SIGN:t=>(t=u.accept(t,i.NUMBER),t>0?1:0===t?0:-1),SQRT:t=>{if(t=u.accept(t,i.NUMBER),t<0)throw r.NUM;return Math.sqrt(t)},SQRTPI:t=>{if(t=u.accept(t,i.NUMBER),t<0)throw r.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return u.flattenParams(t,i.NUMBER,!0,((t,n)=>{(n.isLiteral||"number"===typeof t)&&(e+=t)})),e},SUMIF:(t,e,n,r)=>{const o=u.retrieveRanges(t,e,r);e=o[0],r=o[1],n=u.retrieveArg(t,n);const i=n.isArray;n=c.parse(u.accept(n));let a=0;return e.forEach(((t,e)=>{t.forEach(((t,o)=>{const c=r[e][o];"number"===typeof c&&("wc"===n.op?n.match===n.value.test(t)&&(a+=c):s.compareOp(t,n.op,n.value,Array.isArray(t),i)&&(a+=c))}))})),a},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=u.accept(t,i.ARRAY,void 0,!1,!0),e.forEach((e=>{if(e=u.accept(e,i.ARRAY,void 0,!1,!0),t[0].length!==e[0].length||t.length!==e.length)throw r.VALUE;for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)"number"!==typeof t[n][r]&&(t[n][r]=0),"number"!==typeof e[n][r]&&(e[n][r]=0),t[n][r]*=e[n][r]}));let n=0;return t.forEach((t=>{t.forEach((t=>{n+=t}))})),n},SUMSQ:(...t)=>{let e=0;return u.flattenParams(t,i.NUMBER,!0,((t,n)=>{(n.isLiteral||"number"===typeof t)&&(e+=t**2)})),e},SUMX2MY2:(t,e)=>{const n=[],o=[];let i=0;if(u.flattenParams([t],null,!1,((t,e)=>{n.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),n.length!==o.length)throw r.NA;for(let r=0;r<n.length;r++)"number"===typeof n[r]&&"number"===typeof o[r]&&(i+=n[r]**2-o[r]**2);return i},SUMX2PY2:(t,e)=>{const n=[],o=[];let i=0;if(u.flattenParams([t],null,!1,((t,e)=>{n.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),n.length!==o.length)throw r.NA;for(let r=0;r<n.length;r++)"number"===typeof n[r]&&"number"===typeof o[r]&&(i+=n[r]**2+o[r]**2);return i},SUMXMY2:(t,e)=>{const n=[],o=[];let i=0;if(u.flattenParams([t],null,!1,((t,e)=>{n.push(t)})),u.flattenParams([e],null,!1,((t,e)=>{o.push(t)})),n.length!==o.length)throw r.NA;for(let r=0;r<n.length;r++)"number"===typeof n[r]&&"number"===typeof o[r]&&(i+=(n[r]-o[r])**2);return i},TRUNC:t=>(t=u.accept(t,i.NUMBER),Math.trunc(t))};t.exports=d},95714:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i,WildCard:a,Address:c}=n(32272),s=n(21614),u=o,f={ADDRESS:(t,e,n,o,a)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER,1),o=u.accept(o,i.BOOLEAN,!0),a=u.accept(a,i.STRING,""),t<1||e<1||n<1||n>4)throw r.VALUE;let s="";return a.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(a)?s+=`'${a}'!`:s+=a+"!"),o?(s+=1===n||3===n?"$":"",s+=c.columnNumberToName(e),s+=1===n||2===n?"$":"",s+=t):(s+="R",s+=4===n||3===n?`[${t}]`:t,s+="C",s+=4===n||2===n?`[${e}]`:e),s},AREAS:t=>(t=u.accept(t),t instanceof s?t.length:1),CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(null==e){if(null!=t.position.col)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!==typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return e.ref.col;if(u.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(t,e)=>{if(null==e)throw Error("COLUMNS requires one argument");if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,n,o)=>{t=u.accept(t);try{e=u.accept(e,i.ARRAY,void 0,!1)}catch(s){if(s instanceof r)throw r.NA;throw s}if(n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN,!0),n<1)throw r.VALUE;if(void 0===e[n-1])throw r.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let i=1;i<e[0].length;i++){const a=e[0][i],s=typeof a;if(s===c){if(o>t&&a>t)throw r.NA;if(a===t)return e[n-1][i];if(null!=o&&a>t&&o<=t)return e[n-1][i-1];o=a}}if(null==o)throw r.NA;return o}{let o=-1;if(o=a.isWildCard(t)?e[0].findIndex((e=>a.toRegex(t,"i").test(e))):e[0].findIndex((e=>e===t)),-1===o)throw r.NA;return e[n-1][o]}},INDEX:(t,e,n,o,a)=>{n=t.utils.extractRefValue(n),n={value:n.val,isArray:n.isArray},n=u.accept(n,i.NUMBER),n=Math.trunc(n),null==o?o=1:(o=t.utils.extractRefValue(o),o={value:o.val,isArray:o.isArray},o=u.accept(o,i.NUMBER,1),o=Math.trunc(o)),null==a?a=1:(a=t.utils.extractRefValue(a),a={value:a.val,isArray:a.isArray},a=u.accept(a,i.NUMBER,1),a=Math.trunc(a));let c=e;if(e instanceof s)c=e.refs[a-1];else if(a>1)throw r.REF;if(0===n&&0===o)return c;if(0===n){if(u.isRangeRef(c)){if(c.ref.to.col-c.ref.from.col<o-1)throw r.REF;return c.ref.from.col+=o-1,c.ref.to.col=c.ref.from.col,c}if(Array.isArray(c)){const t=[];return c.forEach((e=>t.push([e[o-1]]))),t}}if(0===o){if(u.isRangeRef(c)){if(c.ref.to.row-c.ref.from.row<n-1)throw r.REF;return c.ref.from.row+=n-1,c.ref.to.row=c.ref.from.row,c}if(Array.isArray(c))return c[o-1]}if(0!==n&&0!==o){if(u.isRangeRef(c)){if(c=c.ref,c.to.row-c.from.row<n-1||c.to.col-c.from.col<o-1)throw r.REF;return{ref:{row:c.from.row+n-1,col:c.from.col+o-1}}}if(u.isCellRef(c)){if(c=c.ref,n>1||o>1)throw r.REF;return{ref:{row:c.row+n-1,col:c.col+o-1}}}if(Array.isArray(c)){if(c.length<n||c[0].length<o)throw r.REF;return c[n-1][o-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(null==e){if(null!=t.position.row)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!==typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return e.ref.row;if(u.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(t,e)=>{if(null==e)throw Error("ROWS requires one argument");if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=u.accept(t,i.ARRAY,void 0,!1);const e=[];for(let n=0;n<t[0].length;n++){e[n]=[];for(let r=0;r<t.length;r++)e[n][r]=t[r][n]}return e},VLOOKUP:(t,e,n,o)=>{t=u.accept(t);try{e=u.accept(e,i.ARRAY,void 0,!1)}catch(s){if(s instanceof r)throw r.NA;throw s}if(n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN,!0),n<1)throw r.VALUE;if(void 0===e[0][n-1])throw r.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let i=1;i<e.length;i++){const a=e[i],s=e[i][0],u=typeof s;if(u===c){if(o>t&&s>t)throw r.NA;if(s===t)return a[n-1];if(null!=o&&s>t&&o<=t)return e[i-1][n-1];o=s}}if(null==o)throw r.NA;return o}{let o=-1;if(o=a.isWildCard(t)?e.findIndex((e=>a.toRegex(t,"i").test(e[0]))):e.findIndex((e=>e[0]===t)),-1===o)throw r.NA;return e[o][n-1]}}};t.exports=f},76088:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i,Criteria:a,Address:c}=n(32272),{Infix:s}=n(33084),u=o,{DistributionFunctions:f}=n(82425),l={AVEDEV:(...t)=>{let e=0;const n=[];u.flattenParams(t,i.NUMBER,!0,((t,r)=>{"number"===typeof t&&(e+=t,n.push(t))}));const r=e/n.length;e=0;for(let o=0;o<n.length;o++)e+=Math.abs(n[o]-r);return e/n.length},AVERAGE:(...t)=>{let e=0,n=0;return u.flattenParams(t,i.NUMBER,!0,((t,r)=>{"number"===typeof t&&(e+=t,n++)})),e/n},AVERAGEA:(...t)=>{let e=0,n=0;return u.flattenParams(t,i.NUMBER,!0,((t,r)=>{const o=typeof t;"number"===o?(e+=t,n++):"string"===o&&n++})),e/n},AVERAGEIF:(t,e,n,o)=>{const i=u.retrieveRanges(t,e,o);e=i[0],o=i[1],n=u.retrieveArg(t,n);const c=n.isArray;n=a.parse(u.accept(n));let f=0,l=0;if(e.forEach(((t,e)=>{t.forEach(((t,r)=>{const i=o[e][r];"number"===typeof i&&("wc"===n.op?n.match===n.value.test(t)&&(f+=i,l++):s.compareOp(t,n.op,n.value,Array.isArray(t),c)&&(f+=i,l++))}))})),0===l)throw r.DIV0;return f/l},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return u.flattenParams(t,null,!0,((t,n)=>{(n.isLiteral&&!isNaN(t)||"number"===typeof t)&&e++})),e},COUNTIF:(t,e)=>{t=u.accept(t,i.ARRAY,void 0,!1,!0);const n=e.isArray;e=u.accept(e);let r=0;return e=a.parse(e),t.forEach((t=>{t.forEach((t=>{"wc"===e.op?e.match===e.value.test(t)&&r++:s.compareOp(t,e.op,e.value,Array.isArray(t),n)&&r++}))})),r},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};t.exports=Object.assign(l,f)},14632:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i,WildCard:a}=n(32272),c=o,s=n(89442),u=n(75473),f={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"¢£¬¯¦¥₩ |←↑→↓■°",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},l=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)],h=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)],p=(t,e)=>t[e+"RE"]||new RegExp("["+t[e]+"]","g"),d=Object.keys(f).map((t=>f[t])),m=t=>d.reduce(((t,e)=>t.replace(p(e,"half"),l(e))),t),g=t=>d.reduce(((t,e)=>t.replace(p(e,"full"),h(e))),t),E={ASC:t=>(t=c.accept(t,i.STRING),g(t)),BAHTTEXT:t=>{t=c.accept(t,i.NUMBER);try{return u(t)}catch(e){throw Error(`Error in https://github.com/jojoee/bahttext \n${e.toString()}`)}},CHAR:t=>{if(t=c.accept(t,i.NUMBER),t>255||t<1)throw r.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=c.accept(t,i.STRING),t.replace(/[\x00-\x1F]/g,"")),CODE:t=>{if(t=c.accept(t,i.STRING),0===t.length)throw r.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return c.flattenParams(t,i.STRING,!1,(t=>{t=c.accept(t,i.STRING),e+=t})),e},CONCATENATE:(...t)=>{let e="";if(0===t.length)throw Error("CONCATENATE need at least one argument.");return t.forEach((t=>{t=c.accept(t,i.STRING),e+=t})),e},DBCS:t=>(t=c.accept(t,i.STRING),m(t)),DOLLAR:(t,e)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,2);const n=Array(e).fill("0").join("");return s.format(`$#,##0.${n}_);($#,##0.${n})`,t).trim()},EXACT:(t,e)=>(t=c.accept(t,[i.STRING]),e=c.accept(e,[i.STRING]),t===e),FIND:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING),n=c.accept(n,i.NUMBER,1),n<1||n>e.length)throw r.VALUE;const o=e.indexOf(t,n-1);if(-1===o)throw r.VALUE;return o+1},FINDB:(...t)=>E.FIND(...t),FIXED:(t,e,n)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,2),n=c.accept(n,i.BOOLEAN,!1);const r=Array(e).fill("0").join(""),o=n?"":"#,";return s.format(`${o}##0.${r}_);(${o}##0.${r})`,t).trim()},LEFT:(t,e)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER,1),e<0)throw r.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>E.LEFT(...t),LEN:t=>(t=c.accept(t,i.STRING),t.length),LENB:(...t)=>E.LEN(...t),LOWER:t=>(t=c.accept(t,i.STRING),t.toLowerCase()),MID:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER),n=c.accept(n,i.NUMBER),e>t.length)return"";if(e<1||n<1)throw r.VALUE;return t.slice(e-1,e+n-1)},MIDB:(...t)=>E.MID(...t),NUMBERVALUE:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING,"."),n=c.accept(n,i.STRING,","),0===t.length)return 0;if(0===e.length||0===n.length)throw r.VALUE;if(e=e[0],n=n[0],e===n||t.indexOf(e)<t.lastIndexOf(n))throw r.VALUE;const o=t.replace(n,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!o)throw r.VALUE;const a=o[1].length,s=o[3].length,u=o[4].length;let f=Number(o[2]);if(a>1||a&&!s||!a&&s||isNaN(f))throw r.VALUE;return f/=100**u,a?-f:f},PHONETIC:()=>{},PROPER:t=>(t=c.accept(t,[i.STRING]),t=t.toLowerCase(),t=t.charAt(0).toUpperCase()+t.slice(1),t.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,(t=>t.toUpperCase()))),REPLACE:(t,e,n,r)=>{t=c.accept(t,[i.STRING]),e=c.accept(e,[i.NUMBER]),n=c.accept(n,[i.NUMBER]),r=c.accept(r,[i.STRING]);let o=t.split("");return o.splice(e-1,n,r),o.join("")},REPLACEB:(...t)=>E.REPLACE(...t),REPT:(t,e)=>{t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER);let n="";for(let r=0;r<e;r++)n+=t;return n},RIGHT:(t,e)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER,1),e<0)throw r.VALUE;const n=t.length;return e>n?t:t.slice(n-e)},RIGHTB:(...t)=>E.RIGHT(...t),SEARCH:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING),n=c.accept(n,i.NUMBER,1),n<1||n>e.length)throw r.VALUE;let o=a.isWildCard(t)?a.toRegex(t,"i"):t;const s=e.slice(n-1).search(o);if(-1===s)throw r.VALUE;return s+n},SEARCHB:(...t)=>E.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>(t=c.accept(t),"string"===typeof t?t:""),TEXT:(t,e)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.STRING);try{return s.format(e,t)}catch(n){throw console.error(n),r.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=c.accept(t,[i.STRING]),t.replace(/^\s+|\s+$/g,"")),UNICHAR:t=>{if(t=c.accept(t,[i.NUMBER]),t<=0)throw r.VALUE;return String.fromCharCode(t)},UNICODE:t=>E.CODE(t)};t.exports=E},97244:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o,c=2**27-1,s={ACOS:t=>{if(t=a.accept(t,i.NUMBER),t>1||t<-1)throw r.NUM;return Math.acos(t)},ACOSH:t=>{if(t=a.accept(t,i.NUMBER),t<1)throw r.NUM;return Math.acosh(t)},ACOT:t=>(t=a.accept(t,i.NUMBER),Math.PI/2-Math.atan(t)),ACOTH:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)<=1)throw r.NUM;return Math.atanh(1/t)},ASIN:t=>{if(t=a.accept(t,i.NUMBER),t>1||t<-1)throw r.NUM;return Math.asin(t)},ASINH:t=>(t=a.accept(t,i.NUMBER),Math.asinh(t)),ATAN:t=>(t=a.accept(t,i.NUMBER),Math.atan(t)),ATAN2:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),0===e&&0===t)throw r.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>1)throw r.NUM;return Math.atanh(t)},COS:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;return Math.cos(t)},COSH:t=>(t=a.accept(t,i.NUMBER),Math.cosh(t)),COT:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;if(0===t)throw r.DIV0;return 1/Math.tan(t)},COTH:t=>{if(t=a.accept(t,i.NUMBER),0===t)throw r.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;return 1/Math.sin(t)},CSCH:t=>{if(t=a.accept(t,i.NUMBER),0===t)throw r.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;return 1/Math.cos(t)},SECH:t=>(t=a.accept(t,i.NUMBER),1/Math.cosh(t)),SIN:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;return Math.sin(t)},SINH:t=>(t=a.accept(t,i.NUMBER),Math.sinh(t)),TAN:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>c)throw r.NUM;return Math.tan(t)},TANH:t=>(t=a.accept(t,i.NUMBER),Math.tanh(t))};t.exports=s},69845:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i}=n(32272),a=o,c={ENCODEURL:t=>encodeURIComponent(a.accept(t,i.STRING)),FILTERXML:()=>{},WEBSERVICE:(t,e)=>{throw r.ERROR("WEBSERVICE is not supported in sync mode.")}};t.exports=c},32272:function(t,e,n){const r=n(49743),o=n(21614),i={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},a=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],c={};Object.keys(i).forEach((t=>{c[i[t]]=t}));class s{constructor(){this.Types=i,this.type2Number={number:i.NUMBER,boolean:i.BOOLEAN,string:i.STRING,object:-1}}checkFunctionResult(t){const e=typeof t;if("number"===e){if(isNaN(t))return r.VALUE;if(!isFinite(t))return r.NUM}return void 0===t||null===t?r.NULL:t}flattenDeep(t){return t.reduce(((t,e)=>Array.isArray(e)?t.concat(this.flattenDeep(e)):t.concat(e)),[])}acceptNumber(t,e=!0,n=!0){if(t instanceof r)return t;let o;if("number"===typeof t)o=t;else if("boolean"===typeof t){if(!n)throw r.VALUE;o=Number(t)}else if("string"===typeof t){if(0===t.length)throw r.VALUE;if(o=Number(t),o!==o)throw r.VALUE}else{if(!Array.isArray(t))throw Error("Unknown type in FormulaHelpers.acceptNumber");if(e)o=this.acceptNumber(t[0][0]);else{if(1!==t[0].length)throw r.VALUE;o=this.acceptNumber(t[0][0])}}return o}flattenParams(t,e,n,a,c=null,s=1){if(t.length<s)throw r.ARG_MISSING([e]);null==c&&(c=e===i.NUMBER?0:null==e?null:""),t.forEach((t=>{const{isCellRef:i,isRangeRef:s,isArray:u}=t,f=t.value instanceof o,l=!i&&!s&&!u&&!f,h={isLiteral:l,isCellRef:i,isRangeRef:s,isArray:u,isUnion:f};if(l)t=t.omitted?c:this.accept(t,e,c),a(t,h);else if(i)a(t.value,h);else if(f){if(!n)throw r.VALUE;t=t.value.data,t=this.flattenDeep(t),t.forEach((t=>{a(t,h)}))}else(s||u)&&(t=this.flattenDeep(t.value),t.forEach((t=>{a(t,h)})))}))}accept(t,e=null,n,a=!0,c=!1){if(Array.isArray(e)&&(e=e[0]),null==t&&void 0===n)throw r.ARG_MISSING([e]);if(null==t)return n;if("object"!==typeof t||Array.isArray(t))return t;const s=t.isArray;if(null!=t.value&&(t=t.value),null==e)return t;if(t instanceof r)throw t;if(e===i.ARRAY){if(Array.isArray(t))return a?this.flattenDeep(t):t;if(t instanceof o)throw r.VALUE;if(c)return a?[t]:[[t]];throw r.VALUE}if(e===i.COLLECTIONS)return t;s&&(t=t[0][0]);const u=this.type(t);if(e===i.STRING)t=u===i.BOOLEAN?t?"TRUE":"FALSE":`${t}`;else if(e===i.BOOLEAN){if(u===i.STRING)throw r.VALUE;u===i.NUMBER&&(t=Boolean(t))}else if(e===i.NUMBER)t=this.acceptNumber(t,!1);else{if(e!==i.NUMBER_NO_BOOLEAN)throw r.VALUE;t=this.acceptNumber(t,!1,!1)}return t}type(t){let e=this.type2Number[typeof t];return-1===e&&(Array.isArray(t)?e=i.ARRAY:t.ref?e=t.ref.from?i.RANGE_REF:i.CELL_REF:t instanceof o&&(e=i.COLLECTIONS)),e}isRangeRef(t){return t.ref&&t.ref.from}isCellRef(t){return t.ref&&!t.ref.from}retrieveRanges(t,e,n){return n=h.extend(e,n),e=this.retrieveArg(t,e),e=u.accept(e,i.ARRAY,void 0,!1,!0),n!==e?(n=this.retrieveArg(t,n),n=u.accept(n,i.ARRAY,void 0,!1,!0)):n=e,[e,n]}retrieveArg(t,e){if(null===e)return{value:0,isArray:!1,omitted:!0};const n=t.utils.extractRefValue(e);return{value:n.val,isArray:n.isArray,ref:e.ref}}}const u=new s,f={isWildCard:t=>"string"===typeof t&&/[*?]/.test(t),toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},l={parse:t=>{const e=typeof t;if("string"===e){const e=t.toUpperCase();if("TRUE"===e||"FALSE"===e)return{op:"=",value:"TRUE"===e};const n=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(n){let t,e=n[1];if(isNaN(n[2])){const o=n[2].toUpperCase();if("TRUE"===o||"FALSE"===o)t="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(n[2]))t=new r(n[2]);else if(t=n[2],f.isWildCard(t))return{op:"wc",value:f.toRegex(t),match:"="===e}}else t=Number(n[2]);return{op:e,value:t}}return f.isWildCard(t)?{op:"wc",value:f.toRegex(t),match:!0}:{op:"=",value:t}}if("boolean"===e||"number"===e||Array.isArray(t)||t instanceof r)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}},h={columnNumberToName:t=>{let e=t,n="",r=0;while(e>0)r=(e-1)%26,n=String.fromCharCode("A".charCodeAt(0)+r)+n,e=Math.floor((e-r)/26);return n},columnNameToNumber:t=>{t=t.toUpperCase();const e=t.length;let n=0;for(let r=0;r<e;r++){const o=t.charCodeAt(r);isNaN(o)||(n+=(o-64)*26**(e-r-1))}return n},extend:(t,e)=>{if(null==e)return t;let n,r;if(u.isCellRef(t))n=0,r=0;else{if(!u.isRangeRef(t))throw Error("Address.extend should not reach here.");n=t.ref.to.row-t.ref.from.row,r=t.ref.to.col-t.ref.from.col}return u.isCellRef(e)?(n>0||r>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+n,col:e.ref.col+r}}}):(e.ref.to.row=e.ref.from.row+n,e.ref.to.col=e.ref.from.col+r),e}};t.exports={FormulaHelpers:u,Types:i,ReversedTypes:c,Factorials:a,WildCard:f,Criteria:l,Address:h}},33084:function(t,e,n){const r=n(49743),{FormulaHelpers:o}=n(32272),i={unaryOp:(t,e,n)=>{let i=1;if(t.forEach((t=>{if("+"===t);else{if("-"!==t)throw new Error(`Unrecognized prefix: ${t}`);i=-i}})),null==e&&(e=0),1===i)return e;try{e=o.acceptNumber(e,n)}catch(a){if(!(a instanceof r))throw a;Array.isArray(e)&&(e=e[0][0])}return"number"===typeof e&&isNaN(e)?r.VALUE:-e}},a={percentOp:(t,e,n)=>{try{t=o.acceptNumber(t,n)}catch(i){if(i instanceof r)return i;throw i}if("%"===e)return t/100;throw new Error(`Unrecognized postfix: ${e}`)}},c={boolean:3,string:2,number:1},s={compareOp:(t,e,n,r,o)=>{null==t&&(t=0),null==n&&(n=0),r&&(t=t[0][0]),o&&(n=n[0][0]);const i=typeof t,a=typeof n;if(i===a)switch(e){case"=":return t===n;case">":return t>n;case"<":return t<n;case"<>":return t!==n;case"<=":return t<=n;case">=":return t>=n}else switch(e){case"=":return!1;case">":return c[i]>c[a];case"<":return c[i]<c[a];case"<>":return!0;case"<=":return c[i]<=c[a];case">=":return c[i]>=c[a]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,n,r,o)=>{null==t&&(t=""),null==n&&(n=""),r&&(t=t[0][0]),o&&(n=n[0][0]);const i=typeof t,a=typeof n;return"boolean"===i&&(t=t?"TRUE":"FALSE"),"boolean"===a&&(n=n?"TRUE":"FALSE"),""+t+n},mathOp:(t,e,n,i,a)=>{null==t&&(t=0),null==n&&(n=0);try{t=o.acceptNumber(t,i),n=o.acceptNumber(n,a)}catch(c){if(c instanceof r)return c;throw c}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return 0===n?r.DIV0:t/n;case"^":return t**n}throw Error("Infix.mathOp: Should not reach here.")}};t.exports={Prefix:i,Postfix:a,Infix:s,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},91641:function(t,e,n){const r=n(49743),{FormulaHelpers:o}=n(32272),{Parser:i}=n(19915),a=n(43360),c=n(21784),{formatChevrotainError:s}=n(70242);class u{constructor(t){this.data=[],this.utils=new c(this),t=Object.assign({onVariable:()=>null},t),this.utils=new c(this),this.onVariable=t.onVariable,this.functions={},this.parser=new i(this,this.utils)}getCell(t){if(null!=t.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0);const e=this.data.findIndex((e=>e.from&&e.from.row<=t.row&&e.to.row>=t.row&&e.from.col<=t.col&&e.to.col>=t.col||e.row===t.row&&e.col===t.col&&e.sheet===t.sheet));-1===e&&this.data.push(t)}return 0}getRange(t){if(null!=t.from.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0);const e=this.data.findIndex((e=>e.from&&e.from.row===t.from.row&&e.from.col===t.from.col&&e.to.row===t.to.row&&e.to.col===t.to.col));-1===e&&this.data.push(t)}return[[0]]}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?r.NAME:(o.isCellRef(e)?this.getCell(e.ref):this.getRange(e.ref),0)}retrieveRef(t){return o.isRangeRef(t)?this.getRange(t.ref):o.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,e){return e.forEach((t=>{null!=t&&this.retrieveRef(t)})),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,e,n=!1){if(0===t.length)throw Error("Input must not be empty.");this.data=[],this.position=e;const o=a.lex(t);this.parser.input=o.tokens;try{const t=this.parser.formulaWithBinaryOp();this.checkFormulaResult(t)}catch(i){if(!n)throw r.ERROR(i.message,i)}if(this.parser.errors.length>0&&!n){const e=this.parser.errors[0];throw s(e,t)}return this.data}}t.exports={DepParser:u}},21784:function(t,e,n){const r=n(49743),{FormulaHelpers:o,Types:i,Address:a}=n(32272),{Prefix:c,Postfix:s,Infix:u,Operators:f}=n(33084),l=n(21614),h=1048576,p=16384;class d{constructor(t){this.context=t}columnNameToNumber(t){return a.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,e){return this.extractRefValue(e),0}applyPostfix(t,e){return this.extractRefValue(t),0}applyInfix(t,e,n){return this.extractRefValue(t),this.extractRefValue(n),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,n,o,i,a,c;const s=t.shift().ref;if(a=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),n=Math.max(s.from.col,s.to.col),i=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,n=i=s.col}let u;return t.forEach((t=>{if(this.isFormulaError(t))return t;if(t=t.ref,!t)throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),f=Math.max(t.from.col,t.to.col),l=Math.min(t.from.col,t.to.col);(s>e||c<o||l>n||f<i||a!==t.sheet)&&(u=r.NULL),e=Math.min(e,c),o=Math.max(o,s),n=Math.min(n,f),i=Math.max(i,l)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>n||t.col<i||a!==t.sheet)&&(u=r.NULL),e=o=t.row,n=i=t.col}})),u||(c=e===o&&n===i?{ref:{sheet:a,row:e,col:n}}:{ref:{sheet:a,from:{row:o,col:i},to:{row:e,col:n}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new l;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];e.add(this.extractRefValue(t[n]).val,t[n])}return e}applyRange(t){let e,n=-1,r=-1,o=h+1,i=p+1;return t.forEach((t=>{if(this.isFormulaError(t))return t;"number"===typeof t&&(t=this.parseRow(t)),t=t.ref,void 0===t.row&&(o=1,n=h),void 0===t.col&&(i=1,r=p),t.row>n&&(n=t.row),t.row<o&&(o=t.row),t.col>r&&(r=t.col),t.col<i&&(i=t.col)})),e=n===o&&r===i?{ref:{row:n,col:r}}:{ref:{from:{row:o,col:i},to:{row:n,col:r}}},e}extractRefValue(t){const e=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new r(t.toUpperCase())}isFormulaError(t){return t instanceof r}}t.exports=d},74127:function(t,e,n){const r=n(14632),o=n(30285),i=n(97244),a=n(40548),c=n(82868),s=n(95714),u=n(22013),f=n(76088),l=n(73375),h=n(69845),p=n(49743),{FormulaHelpers:d}=n(32272),{Parser:m,allTokens:g}=n(19915),E=n(43360),v=n(70242);class y{constructor(t,e=!1){this.logs=[],this.isTest=e,this.utils=new v(this),t=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},l,f,u,s,c,a,r,o,i,h,t.functions,t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(i)).concat(Object.keys(a)).concat(Object.keys(c)).concat(Object.keys(s)).concat(Object.keys(f)).concat(Object.keys(l)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(u),this.parser=new m(this,this.utils)}static get allTokens(){return g}getCell(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet,this.position)};return null==e.ref?p.NAME:e}retrieveRef(t){return d.isRangeRef(t)?this.getRange(t.ref):d.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,e){0===t.indexOf("_xlfn.")&&(t=t.slice(6)),t=t.toUpperCase();const n=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(e=e.map((e=>{if(null===e)return{value:n,isArray:!1,omitted:!0};const r=this.utils.extractRefValue(e);return this.funsPreserveRef.includes(t)?{value:r.val,isArray:r.isArray,ref:e.ref}:{value:r.val,isArray:r.isArray,isRangeRef:!!d.isRangeRef(e),isCellRef:!!d.isCellRef(e)}}))),this.functions[t]){let n;try{n=this.funsNeedContextAndNoDataRetrieve.includes(t)||this.funsNeedContext.includes(t)?this.functions[t](this,...e):this.functions[t](...e)}catch(r){if(r instanceof p)return r;throw r}if(void 0===n){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}return n}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,e){const n=[];for(const o of e)n.push(await o);const r=await this._callFunction(t,n);return d.checkFunctionResult(r)}callFunction(t,e){if(this.async)return this.callFunctionAsync(t,e);{const n=this._callFunction(t,e);return d.checkFunctionResult(n)}}supportedFunctions(){const t=[],e=Object.keys(this.functions);return e.forEach((e=>{try{const n=this.functions[e](0,0,0,0,0,0,0,0,0,0,0);if(void 0===n)return;t.push(e)}catch(n){n instanceof Error&&t.push(e)}})),t.sort()}checkFormulaResult(t,e=!1){const n=typeof t;if("number"===n){if(isNaN(t))return p.VALUE;if(!isFinite(t))return p.NUM;t+=0}else if("object"===n){if(t instanceof p)return t;if(e){if(t.ref&&(t=this.retrieveRef(t)),"object"===typeof t&&!Array.isArray(t)&&null!=t)return p.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else{if(!Array.isArray(t))return p.VALUE;t=t[0][0]}}return t}parse(t,e,n=!1){if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!1;const r=E.lex(t);let o;this.parser.input=r.tokens;try{if(o=this.parser.formulaWithBinaryOp(),o=this.checkFormulaResult(o,n),o instanceof p)return o}catch(i){throw p.ERROR(i.message,i)}if(this.parser.errors.length>0){const e=this.parser.errors[0];throw v.formatChevrotainError(e,t)}return o}async parseAsync(t,e,n=!1){if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!0;const r=E.lex(t);let o;this.parser.input=r.tokens;try{if(o=await this.parser.formulaWithBinaryOp(),o=this.checkFormulaResult(o,n),o instanceof p)return o}catch(i){throw p.ERROR(i.message,i)}if(this.parser.errors.length>0){const e=this.parser.errors[0];throw v.formatChevrotainError(e,t)}return o}}t.exports={FormulaParser:y,FormulaHelpers:d}},43360:function(t,e,n){const{createToken:r,Lexer:o}=n(91198),i=n(49743),a={},c=r({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),s=r({name:"String",pattern:/"(""|[^"])*"/}),u=r({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),f=r({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),l=r({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),h=r({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),p=r({name:"RefError",pattern:/#REF!/}),d=r({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),m=r({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),g=r({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:d}),E=r({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),v=r({name:"Boolean",pattern:/TRUE|FALSE/i}),y=r({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:d}),N=r({name:"At",pattern:/@/}),T=r({name:"Comma",pattern:/,/}),R=r({name:"Colon",pattern:/:/}),A=r({name:"Semicolon",pattern:/;/}),M=r({name:"OpenParen",pattern:/\(/}),O=r({name:"CloseParen",pattern:/\)/}),w=r({name:"OpenSquareParen",pattern:/\[/}),I=r({name:"CloseSquareParen",pattern:/]/}),S=(r({name:"exclamationMark",pattern:/!/}),r({name:"OpenCurlyParen",pattern:/{/})),C=r({name:"CloseCurlyParen",pattern:/}/}),b=r({name:"QuoteS",pattern:/'/}),U=r({name:"MulOp",pattern:/\*/}),L=r({name:"PlusOp",pattern:/\+/}),x=r({name:"DivOp",pattern:/\//}),_=r({name:"MinOp",pattern:/-/}),k=r({name:"ConcatOp",pattern:/&/}),P=r({name:"ExOp",pattern:/\^/}),B=r({name:"PercentOp",pattern:/%/}),F=r({name:"GtOp",pattern:/>/}),D=r({name:"EqOp",pattern:/=/}),j=r({name:"LtOp",pattern:/</}),V=r({name:"NeqOp",pattern:/<>/}),G=r({name:"GteOp",pattern:/>=/}),H=r({name:"LteOp",pattern:/<=/}),z=[c,s,f,u,l,h,p,m,g,v,y,d,E,N,T,R,A,M,O,w,I,S,C,b,U,L,x,_,k,P,U,B,V,G,H,F,D,j],Y=new o(z,{ensureOptimizations:!0});z.forEach((t=>{a[t.name]=t})),t.exports={tokenVocabulary:a,lex:function(t){const e=Y.tokenize(t);if(e.errors.length>0){const n=e.errors[0],r=n.line,o=n.column;let a="\n"+t.split("\n")[r-1]+"\n";throw a+=Array(o-1).fill(" ").join("")+"^\n",n.message=a+`Error at position ${r}:${o}\n`+n.message,n.errorLocation={line:r,column:o},i.ERROR(n.message,n)}return e}}},19915:function(t,e,n){const r=n(43360),{EmbeddedActionsParser:o}=n(91198),i=r.tokenVocabulary,{String:a,SheetQuoted:c,ExcelRefFunction:s,ExcelConditionalRefFunction:u,Function:f,FormulaErrorT:l,RefError:h,Cell:p,Sheet:d,Name:m,Number:g,Boolean:E,Column:v,Comma:y,Colon:N,Semicolon:T,OpenParen:R,CloseParen:A,OpenCurlyParen:M,CloseCurlyParen:O,MulOp:w,PlusOp:I,DivOp:S,MinOp:C,ConcatOp:b,ExOp:U,PercentOp:L,NeqOp:x,GteOp:_,LteOp:k,GtOp:P,EqOp:B,LtOp:F}=r.tokenVocabulary;class D extends o{constructor(t,e){super(i,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=e,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const n=this;n.RULE("formulaWithBinaryOp",(()=>{const t=[],e=[n.SUBRULE(n.formulaWithPercentOp)];return n.MANY((()=>{t.push(n.OR(n.c1||(n.c1=[{ALT:()=>n.CONSUME(P).image},{ALT:()=>n.CONSUME(B).image},{ALT:()=>n.CONSUME(F).image},{ALT:()=>n.CONSUME(x).image},{ALT:()=>n.CONSUME(_).image},{ALT:()=>n.CONSUME(k).image},{ALT:()=>n.CONSUME(b).image},{ALT:()=>n.CONSUME(I).image},{ALT:()=>n.CONSUME(C).image},{ALT:()=>n.CONSUME(w).image},{ALT:()=>n.CONSUME(S).image},{ALT:()=>n.CONSUME(U).image}]))),e.push(n.SUBRULE2(n.formulaWithPercentOp))})),n.ACTION((()=>{for(const n of this.binaryOperatorsPrecedence)for(let r=0,o=t.length;r<o;r++){const i=t[r];n.includes(i)&&(t.splice(r,1),e.splice(r,2,this.utils.applyInfix(e[r],i,e[r+1])),r--,o--)}})),e[0]})),n.RULE("plusMinusOp",(()=>n.OR([{ALT:()=>n.CONSUME(I).image},{ALT:()=>n.CONSUME(C).image}]))),n.RULE("formulaWithPercentOp",(()=>{let t=n.SUBRULE(n.formulaWithUnaryOp);return n.OPTION((()=>{const e=n.CONSUME(L).image;t=n.ACTION((()=>this.utils.applyPostfix(t,e)))})),t})),n.RULE("formulaWithUnaryOp",(()=>{const t=[];n.MANY((()=>{const e=n.OR([{ALT:()=>n.CONSUME(I).image},{ALT:()=>n.CONSUME(C).image}]);t.push(e)}));const e=n.SUBRULE(n.formulaWithIntersect);return t.length>0?n.ACTION((()=>this.utils.applyPrefix(t,e))):e})),n.RULE("formulaWithIntersect",(()=>{let t=n.SUBRULE(n.formulaWithRange);const e=[t];return n.MANY({GATE:()=>{const t=n.LA(0),e=n.LA(1);return e.startOffset>t.endOffset+1},DEF:()=>{e.push(n.SUBRULE3(n.formulaWithRange))}}),e.length>1?n.ACTION((()=>n.ACTION((()=>this.utils.applyIntersect(e))))):t})),n.RULE("formulaWithRange",(()=>{const t=n.SUBRULE(n.formula),e=[t];return n.MANY((()=>{n.CONSUME(N),e.push(n.SUBRULE2(n.formula))})),e.length>1?n.ACTION((()=>n.ACTION((()=>this.utils.applyRange(e))))):t})),n.RULE("formula",(()=>n.OR9([{ALT:()=>n.SUBRULE(n.referenceWithoutInfix)},{ALT:()=>n.SUBRULE(n.paren)},{ALT:()=>n.SUBRULE(n.constant)},{ALT:()=>n.SUBRULE(n.functionCall)},{ALT:()=>n.SUBRULE(n.constantArray)}]))),n.RULE("paren",(()=>{let t;n.CONSUME(R);const e=[];return e.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY((()=>{n.CONSUME(y),e.push(n.SUBRULE2(n.formulaWithBinaryOp))})),t=e.length>1?n.ACTION((()=>this.utils.applyUnion(e))):e[0],n.CONSUME(A),t})),n.RULE("constantArray",(()=>{const t=[[]];let e=0;return n.CONSUME(M),t[e].push(n.SUBRULE(n.constantForArray)),n.MANY((()=>{const r=n.OR([{ALT:()=>n.CONSUME(y).image},{ALT:()=>n.CONSUME(T).image}]),o=n.SUBRULE2(n.constantForArray);","===r||(e++,t[e]=[]),t[e].push(o)})),n.CONSUME(O),n.ACTION((()=>this.utils.toArray(t)))})),n.RULE("constantForArray",(()=>n.OR([{ALT:()=>{const t=n.OPTION((()=>n.SUBRULE(n.plusMinusOp))),e=n.CONSUME(g).image,r=n.ACTION((()=>this.utils.toNumber(e)));return t?n.ACTION((()=>this.utils.applyPrefix([t],r))):r}},{ALT:()=>{const t=n.CONSUME(a).image;return n.ACTION((()=>this.utils.toString(t)))}},{ALT:()=>{const t=n.CONSUME(E).image;return n.ACTION((()=>this.utils.toBoolean(t)))}},{ALT:()=>{const t=n.CONSUME(l).image;return n.ACTION((()=>this.utils.toError(t)))}},{ALT:()=>{const t=n.CONSUME(h).image;return n.ACTION((()=>this.utils.toError(t)))}}]))),n.RULE("constant",(()=>n.OR([{ALT:()=>{const t=n.CONSUME(g).image;return n.ACTION((()=>this.utils.toNumber(t)))}},{ALT:()=>{const t=n.CONSUME(a).image;return n.ACTION((()=>this.utils.toString(t)))}},{ALT:()=>{const t=n.CONSUME(E).image;return n.ACTION((()=>this.utils.toBoolean(t)))}},{ALT:()=>{const t=n.CONSUME(l).image;return n.ACTION((()=>this.utils.toError(t)))}}]))),n.RULE("functionCall",(()=>{const e=n.CONSUME(f).image.slice(0,-1),r=n.SUBRULE(n.arguments);return n.CONSUME(A),n.ACTION((()=>t.callFunction(e,r)))})),n.RULE("arguments",(()=>{n.MANY2((()=>{n.CONSUME2(y)}));const t=[];return n.OPTION((()=>{t.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY((()=>{n.CONSUME1(y),t.push(null),n.OPTION3((()=>{t.pop(),t.push(n.SUBRULE2(n.formulaWithBinaryOp))}))}))})),t})),n.RULE("referenceWithoutInfix",(()=>n.OR([{ALT:()=>n.SUBRULE(n.referenceItem)},{ALT:()=>{const t=n.SUBRULE(n.prefixName),e=n.SUBRULE2(n.formulaWithRange);return n.ACTION((()=>{if(this.utils.isFormulaError(e))return e;e.ref.sheet=t})),e}}]))),n.RULE("referenceItem",(()=>n.OR([{ALT:()=>{const t=n.CONSUME(p).image;return n.ACTION((()=>this.utils.parseCellAddress(t)))}},{ALT:()=>{const e=n.CONSUME(m).image;return n.ACTION((()=>t.getVariable(e)))}},{ALT:()=>{const t=n.CONSUME(v).image;return n.ACTION((()=>this.utils.parseCol(t)))}},{ALT:()=>{const t=n.CONSUME(h).image;return n.ACTION((()=>this.utils.toError(t)))}}]))),n.RULE("prefixName",(()=>n.OR([{ALT:()=>n.CONSUME(d).image.slice(0,-1)},{ALT:()=>n.CONSUME(c).image.slice(1,-2).replace(/''/g,"'")}]))),this.performSelfAnalysis()}}t.exports={Parser:D}},21614:function(t){class e{constructor(t,e){if(null==t&&null==e)this._data=[],this._refs=[];else{if(t.length!==e.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=e}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,e){this._data.push(t),this._refs.push(e)}}t.exports=e},70242:function(t,e,n){const r=n(49743),{Address:o}=n(32272),{Prefix:i,Postfix:a,Infix:c,Operators:s}=n(33084),u=n(21614),f=1048576,l=16384,{NotAllInputParsedException:h}=n(91198);class p{constructor(t){this.context=t}columnNameToNumber(t){return o.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,e){return t=this.columnNameToNumber(t),e=this.columnNameToNumber(e),{ref:{from:{col:Math.min(t,e),row:null},to:{col:Math.max(t,e),row:null}}}}parseRowRange(t,e){return{ref:{from:{col:null,row:Math.min(t,e)},to:{col:null,row:Math.max(t,e)}}}}_applyPrefix(t,e,n){return this.isFormulaError(e)?e:i.unaryOp(t,e,n)}async applyPrefixAsync(t,e){const{val:n,isArray:r}=this.extractRefValue(await e);return this._applyPrefix(t,n,r)}applyPrefix(t,e){if(this.context.async)return this.applyPrefixAsync(t,e);{const{val:n,isArray:r}=this.extractRefValue(e);return this._applyPrefix(t,n,r)}}_applyPostfix(t,e,n){return this.isFormulaError(t)?t:a.percentOp(t,n,e)}async applyPostfixAsync(t,e){const{val:n,isArray:r}=this.extractRefValue(await t);return this._applyPostfix(n,r,e)}applyPostfix(t,e){if(this.context.async)return this.applyPostfixAsync(t,e);{const{val:n,isArray:r}=this.extractRefValue(t);return this._applyPostfix(n,r,e)}}_applyInfix(t,e,n){const r=t.val,o=t.isArray,i=n.val,a=n.isArray;if(this.isFormulaError(r))return r;if(this.isFormulaError(i))return i;if(s.compareOp.includes(e))return c.compareOp(r,e,i,o,a);if(s.concatOp.includes(e))return c.concatOp(r,e,i,o,a);if(s.mathOp.includes(e))return c.mathOp(r,e,i,o,a);throw new Error(`Unrecognized infix: ${e}`)}async applyInfixAsync(t,e,n){const r=this.extractRefValue(await t),o=this.extractRefValue(await n);return this._applyInfix(r,e,o)}applyInfix(t,e,n){if(this.context.async)return this.applyInfixAsync(t,e,n);{const r=this.extractRefValue(t),o=this.extractRefValue(n);return this._applyInfix(r,e,o)}}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,n,o,i,a,c;const s=t.shift().ref;if(a=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),n=Math.max(s.from.col,s.to.col),i=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,n=i=s.col}let u;return t.forEach((t=>{if(this.isFormulaError(t))return t;if(t=t.ref,!t)throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),f=Math.max(t.from.col,t.to.col),l=Math.min(t.from.col,t.to.col);(s>e||c<o||l>n||f<i||a!==t.sheet)&&(u=r.NULL),e=Math.min(e,c),o=Math.max(o,s),n=Math.min(n,f),i=Math.max(i,l)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>n||t.col<i||a!==t.sheet)&&(u=r.NULL),e=o=t.row,n=i=t.col}})),u||(c=e===o&&n===i?{ref:{sheet:a,row:e,col:n}}:{ref:{sheet:a,from:{row:o,col:i},to:{row:e,col:n}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new u;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];e.add(this.extractRefValue(t[n]).val,t[n])}return e}applyRange(t){let e,n=-1,r=-1,o=f+1,i=l+1;return t.forEach((t=>{if(this.isFormulaError(t))return t;"number"===typeof t&&(t=this.parseRow(t)),t=t.ref,void 0===t.row&&(o=1,n=f),void 0===t.col&&(i=1,r=l),t.row>n&&(n=t.row),t.row<o&&(o=t.row),t.col>r&&(r=t.col),t.col<i&&(i=t.col)})),e=n===o&&r===i?{ref:{row:n,col:r}}:{ref:{from:{row:o,col:i},to:{row:n,col:r}}},e}extractRefValue(t){let e=t,n=!1;return Array.isArray(e)&&(n=!0),t.ref?{val:this.context.retrieveRef(t),isArray:n}:{val:e,isArray:n}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new r(t.toUpperCase())}isFormulaError(t){return t instanceof r}static formatChevrotainError(t,e){let n,o,i="";return t instanceof h?(n=t.token.startLine,o=t.token.startColumn):(n=t.previousToken.startLine,o=t.previousToken.startColumn+1),i+="\n"+e.split("\n")[n-1]+"\n",i+=Array(o-1).fill(" ").join("")+"^\n",i+=`Error at position ${n}:${o}\n`+t.message,t.errorLocation={line:n,column:o},r.ERROR(i,t)}}t.exports=p},59833:function(t,e,n){const{FormulaParser:r}=n(74127),{DepParser:o}=n(91641),i=n(89442),a=n(49743);Object.assign(r,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:i,DepParser:o,FormulaError:a,...n(32272)}),t.exports=r},91198:function(t,e,n){"use strict";n.r(e),n.d(e,{Alternation:function(){return Jt},Alternative:function(){return Yt},CstParser:function(){return Dr},EMPTY_ALT:function(){return Br},EOF:function(){return Ft},EarlyExitException:function(){return Pn},EmbeddedActionsParser:function(){return jr},GAstVisitor:function(){return re},Lexer:function(){return At},LexerDefinitionErrorType:function(){return Nt},MismatchedTokenException:function(){return xn},NoViableAltException:function(){return _n},NonTerminal:function(){return Ht},NotAllInputParsedException:function(){return kn},Option:function(){return Wt},Parser:function(){return ao},ParserDefinitionErrorType:function(){return _r},Repetition:function(){return Kt},RepetitionMandatory:function(){return $t},RepetitionMandatoryWithSeparator:function(){return qt},RepetitionWithSeparator:function(){return Xt},Rule:function(){return zt},Terminal:function(){return Qt},VERSION:function(){return r},assignOccurrenceIndices:function(){return Mn},clearCache:function(){return io},createSyntaxDiagramsCode:function(){return Vr},createToken:function(){return Pt},createTokenInstance:function(){return Dt},defaultGrammarResolverErrorProvider:function(){return Re},defaultGrammarValidatorErrorProvider:function(){return Ae},defaultLexerErrorProvider:function(){return Tt},defaultParserErrorProvider:function(){return Te},generateParserFactory:function(){return ro},generateParserModule:function(){return oo},isRecognitionException:function(){return Un},resolveGrammar:function(){return Rn},serializeGrammar:function(){return Zt},serializeProduction:function(){return te},tokenLabel:function(){return Mt},tokenMatcher:function(){return jt},tokenName:function(){return Ot},validateGrammar:function(){return An}});var r="7.1.2",o=n(58340),i=n(60738),a={},c=new i.RegExpParser;function s(t){var e=t.toString();if(a.hasOwnProperty(e))return a[e];var n=c.pattern(e);return a[e]=n,n}function u(){a={}}var f=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l="Complement Sets are not supported for first char optimization",h='Unable to use "first char" lexer optimizations:\n';function p(t,e){void 0===e&&(e=!1);try{var n=s(t),r=d(n.value,{},n.flags.ignoreCase);return r}catch(c){if(c.message===l)e&&(0,o.x5)(h+"\tUnable to optimize: < "+t.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var a="";e&&(a="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,o.Zi)(h+"\n\tFailed parsing: < "+t.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+a)}}return[]}function d(t,e,n){switch(t.type){case"Disjunction":for(var r=0;r<t.value.length;r++)d(t.value[r],e,n);break;case"Alternative":var i=t.value;for(r=0;r<i.length;r++){var a=i[r];switch(a.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var c=a;switch(c.type){case"Character":m(c.value,e,n);break;case"Set":if(!0===c.complement)throw Error(l);(0,o.jJ)(c.value,(function(t){if("number"===typeof t)m(t,e,n);else{var r=t;if(!0===n)for(var o=r.from;o<=r.to;o++)m(o,e,n);else{for(o=r.from;o<=r.to&&o<et;o++)m(o,e,n);if(r.to>=et)for(var i=r.from>=et?r.from:et,a=r.to,c=nt(i),s=nt(a),u=c;u<=s;u++)e[u]=u}}}));break;case"Group":d(c.value,e,n);break;default:throw Error("Non Exhaustive Match")}var s=void 0!==c.quantifier&&0===c.quantifier.atLeast;if("Group"===c.type&&!1===v(c)||"Group"!==c.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return(0,o.zu)(e)}function m(t,e,n){var r=nt(t);e[r]=r,!0===n&&g(t,e)}function g(t,e){var n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){var o=nt(r.charCodeAt(0));e[o]=o}else{var i=n.toLowerCase();if(i!==n){o=nt(i.charCodeAt(0));e[o]=o}}}function E(t,e){return(0,o.I6)(t.value,(function(t){if("number"===typeof t)return(0,o.gR)(e,t);var n=t;return void 0!==(0,o.I6)(e,(function(t){return n.from<=t&&t<=n.to}))}))}function v(t){return!(!t.quantifier||0!==t.quantifier.atLeast)||!!t.value&&((0,o.cy)(t.value)?(0,o.Si)(t.value,v):v(t.value))}var y=function(t){function e(e){var n=t.call(this)||this;return n.targetCharCodes=e,n.found=!1,n}return f(e,t),e.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}t.prototype.visitChildren.call(this,e)}},e.prototype.visitCharacter=function(t){(0,o.gR)(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?void 0===E(t,this.targetCharCodes)&&(this.found=!0):void 0!==E(t,this.targetCharCodes)&&(this.found=!0)},e}(i.BaseRegExpVisitor);function N(t,e){if(e instanceof RegExp){var n=s(e),r=new y(t);return r.visit(n),r.found}return void 0!==(0,o.I6)(e,(function(e){return(0,o.gR)(t,e.charCodeAt(0))}))}var T=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R="PATTERN",A="defaultMode",M="modes",O="boolean"===typeof new RegExp("(?:)").sticky;function w(t,e){e=(0,o.NT)(e,{useSticky:O,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(t,e){return e()}});var n,r=e.tracer;r("initCharCodeToOptimizedIndexMap",(function(){ot()})),r("Reject Lexer.NA",(function(){n=(0,o.ku)(t,(function(t){return t[R]===At.NA}))}));var i,a,c,s,u,f,l,d,m,g,E,v=!1;r("Transform Patterns",(function(){v=!1,i=(0,o.Tj)(n,(function(t){var n=t[R];if((0,o.gd)(n)){var r=n.source;return 1!==r.length||"^"===r||"$"===r||"."===r||n.ignoreCase?2!==r.length||"\\"!==r[0]||(0,o.gR)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?e.useSticky?z(n):H(n):r[1]:r}if((0,o.Tn)(n))return v=!0,{exec:n};if((0,o.zy)(n,"exec"))return v=!0,n;if("string"===typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(i);return e.useSticky?z(a):H(a)}throw Error("non exhaustive match")}))})),r("misc mapping",(function(){a=(0,o.Tj)(n,(function(t){return t.tokenTypeIdx})),c=(0,o.Tj)(n,(function(t){var e=t.GROUP;if(e!==At.SKIPPED){if((0,o.Kg)(e))return e;if((0,o.b0)(e))return!1;throw Error("non exhaustive match")}})),s=(0,o.Tj)(n,(function(t){var e=t.LONGER_ALT;if(e){var r=(0,o.qh)(n,e);return r}})),u=(0,o.Tj)(n,(function(t){return t.PUSH_MODE})),f=(0,o.Tj)(n,(function(t){return(0,o.zy)(t,"POP_MODE")}))})),r("Line Terminator Handling",(function(){var t=Z(e.lineTerminatorCharacters);l=(0,o.Tj)(n,(function(t){return!1})),"onlyOffset"!==e.positionTracking&&(l=(0,o.Tj)(n,(function(e){return(0,o.zy)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===J(e,t)?N(t,e.PATTERN):void 0})))})),r("Misc Mapping #2",(function(){d=(0,o.Tj)(n,q),m=(0,o.Tj)(i,K),g=(0,o.TS)(n,(function(t,e){var n=e.GROUP;return(0,o.Kg)(n)&&n!==At.SKIPPED&&(t[n]=[]),t}),{}),E=(0,o.Tj)(i,(function(t,e){return{pattern:i[e],longerAlt:s[e],canLineTerminator:l[e],isCustom:d[e],short:m[e],group:c[e],push:u[e],pop:f[e],tokenTypeIdx:a[e],tokenType:n[e]}}))}));var y=!0,T=[];return e.safeMode||r("First Char Optimization",(function(){T=(0,o.TS)(n,(function(t,n,r){if("string"===typeof n.PATTERN){var i=n.PATTERN.charCodeAt(0),a=nt(i);tt(t,a,E[r])}else if((0,o.cy)(n.START_CHARS_HINT)){var c;(0,o.jJ)(n.START_CHARS_HINT,(function(e){var n="string"===typeof e?e.charCodeAt(0):e,o=nt(n);c!==o&&(c=o,tt(t,o,E[r]))}))}else if((0,o.gd)(n.PATTERN))if(n.PATTERN.unicode)y=!1,e.ensureOptimizations&&(0,o.Zi)(h+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=p(n.PATTERN,e.ensureOptimizations);(0,o.Im)(s)&&(y=!1),(0,o.jJ)(s,(function(e){tt(t,e,E[r])}))}else e.ensureOptimizations&&(0,o.Zi)(h+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),y=!1;return t}),[])})),r("ArrayPacking",(function(){T=(0,o.VS)(T)})),{emptyGroups:g,patternIdxToConfig:E,charCodeToPatternIdxToConfig:T,hasCustom:v,canBeOptimized:y}}function I(t,e){var n=[],r=C(t);n=n.concat(r.errors);var o=b(r.valid),i=o.valid;return n=n.concat(o.errors),n=n.concat(S(i)),n=n.concat(F(i)),n=n.concat(D(i,e)),n=n.concat(j(i)),n}function S(t){var e=[],n=(0,o.pb)(t,(function(t){return(0,o.gd)(t[R])}));return e=e.concat(L(n)),e=e.concat(k(n)),e=e.concat(P(n)),e=e.concat(B(n)),e=e.concat(x(n)),e}function C(t){var e=(0,o.pb)(t,(function(t){return!(0,o.zy)(t,R)})),n=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:Nt.MISSING_PATTERN,tokenTypes:[t]}})),r=(0,o.iv)(t,e);return{errors:n,valid:r}}function b(t){var e=(0,o.pb)(t,(function(t){var e=t[R];return!(0,o.gd)(e)&&!(0,o.Tn)(e)&&!(0,o.zy)(e,"exec")&&!(0,o.Kg)(e)})),n=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Nt.INVALID_PATTERN,tokenTypes:[t]}})),r=(0,o.iv)(t,e);return{errors:n,valid:r}}var U=/[^\\][\$]/;function L(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return T(e,t),e.prototype.visitEndAnchor=function(t){this.found=!0},e}(i.BaseRegExpVisitor),n=(0,o.pb)(t,(function(t){var n=t[R];try{var r=s(n),o=new e;return o.visit(r),o.found}catch(i){return U.test(n.source)}})),r=(0,o.Tj)(n,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Nt.EOI_ANCHOR_FOUND,tokenTypes:[t]}}));return r}function x(t){var e=(0,o.pb)(t,(function(t){var e=t[R];return e.test("")})),n=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:Nt.EMPTY_MATCH_PATTERN,tokenTypes:[t]}}));return n}var _=/[^\\[][\^]|^\^/;function k(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return T(e,t),e.prototype.visitStartAnchor=function(t){this.found=!0},e}(i.BaseRegExpVisitor),n=(0,o.pb)(t,(function(t){var n=t[R];try{var r=s(n),o=new e;return o.visit(r),o.found}catch(i){return _.test(n.source)}})),r=(0,o.Tj)(n,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Nt.SOI_ANCHOR_FOUND,tokenTypes:[t]}}));return r}function P(t){var e=(0,o.pb)(t,(function(t){var e=t[R];return e instanceof RegExp&&(e.multiline||e.global)})),n=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Nt.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}}));return n}function B(t){var e=[],n=(0,o.Tj)(t,(function(n){return(0,o.TS)(t,(function(t,r){return n.PATTERN.source!==r.PATTERN.source||(0,o.gR)(e,r)||r.PATTERN===At.NA||(e.push(r),t.push(r)),t}),[])}));n=(0,o.oE)(n);var r=(0,o.pb)(n,(function(t){return t.length>1})),i=(0,o.Tj)(r,(function(t){var e=(0,o.Tj)(t,(function(t){return t.name})),n=(0,o.$1)(t).PATTERN;return{message:"The same RegExp pattern ->"+n+"<-has been used in all of the following Token Types: "+e.join(", ")+" <-",type:Nt.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}}));return i}function F(t){var e=(0,o.pb)(t,(function(t){if(!(0,o.zy)(t,"GROUP"))return!1;var e=t.GROUP;return e!==At.SKIPPED&&e!==At.NA&&!(0,o.Kg)(e)})),n=(0,o.Tj)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Nt.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}}));return n}function D(t,e){var n=(0,o.pb)(t,(function(t){return void 0!==t.PUSH_MODE&&!(0,o.gR)(e,t.PUSH_MODE)})),r=(0,o.Tj)(n,(function(t){var e="Token Type: ->"+t.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist";return{message:e,type:Nt.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]}}));return r}function j(t){var e=[],n=(0,o.TS)(t,(function(t,e,n){var r=e.PATTERN;return r===At.NA||((0,o.Kg)(r)?t.push({str:r,idx:n,tokenType:e}):(0,o.gd)(r)&&G(r)&&t.push({str:r.source,idx:n,tokenType:e})),t}),[]);return(0,o.jJ)(t,(function(t,r){(0,o.jJ)(n,(function(n){var o=n.str,i=n.idx,a=n.tokenType;if(r<i&&V(o,t.PATTERN)){var c="Token: ->"+a.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+t.name+"<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE";e.push({message:c,type:Nt.UNREACHABLE_PATTERN,tokenTypes:[t,a]})}}))})),e}function V(t,e){if((0,o.gd)(e)){var n=e.exec(t);return null!==n&&0===n.index}if((0,o.Tn)(e))return e(t,0,[],{});if((0,o.zy)(e,"exec"))return e.exec(t,0,[],{});if("string"===typeof e)return e===t;throw Error("non exhaustive match")}function G(t){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return void 0===(0,o.I6)(e,(function(e){return-1!==t.source.indexOf(e)}))}function H(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function z(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function Y(t,e,n){var r=[];return(0,o.zy)(t,A)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+A+"> property in its definition\n",type:Nt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,o.zy)(t,M)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+M+"> property in its definition\n",type:Nt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,o.zy)(t,M)&&(0,o.zy)(t,A)&&!(0,o.zy)(t.modes,t.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+A+": <"+t.defaultMode+">which does not exist\n",type:Nt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,o.zy)(t,M)&&(0,o.jJ)(t.modes,(function(t,e){(0,o.jJ)(t,(function(t,n){(0,o.b0)(t)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+e+"> at index: <"+n+">\n",type:Nt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),r}function W(t,e,n){var r=[],i=!1,a=(0,o.oE)((0,o.Bq)((0,o.LG)(t.modes,(function(t){return t})))),c=(0,o.ku)(a,(function(t){return t[R]===At.NA})),s=Z(n);return e&&(0,o.jJ)(c,(function(t){var e=J(t,s);if(!1!==e){var n=Q(t,e),a={message:n,type:e.issue,tokenType:t};r.push(a)}else(0,o.zy)(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(i=!0):N(s,t.PATTERN)&&(i=!0)})),e&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:Nt.NO_LINE_BREAKS_FLAGS}),r}function $(t){var e={},n=(0,o.HP)(t);return(0,o.jJ)(n,(function(n){var r=t[n];if(!(0,o.cy)(r))throw Error("non exhaustive match");e[n]=[]})),e}function q(t){var e=t.PATTERN;if((0,o.gd)(e))return!1;if((0,o.Tn)(e))return!0;if((0,o.zy)(e,"exec"))return!0;if((0,o.Kg)(e))return!1;throw Error("non exhaustive match")}function K(t){return!(!(0,o.Kg)(t)||1!==t.length)&&t.charCodeAt(0)}var X={test:function(t){for(var e=t.length,n=this.lastIndex;n<e;n++){var r=t.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===t.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function J(t,e){if((0,o.zy)(t,"LINE_BREAKS"))return!1;if((0,o.gd)(t.PATTERN)){try{N(e,t.PATTERN)}catch(n){return{issue:Nt.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}if((0,o.Kg)(t.PATTERN))return!1;if(q(t))return{issue:Nt.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function Q(t,e){if(e.issue===Nt.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+t.name+"> Token Type\n\t Root cause: "+e.errMsg+".\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===Nt.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+t.name+"> Token Type\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function Z(t){var e=(0,o.Tj)(t,(function(t){return(0,o.Kg)(t)&&t.length>0?t.charCodeAt(0):t}));return e}function tt(t,e,n){void 0===t[e]?t[e]=[n]:t[e].push(n)}var et=256;function nt(t){return t<et?t:rt[t]}var rt=[];function ot(){if((0,o.Im)(rt)){rt=new Array(65536);for(var t=0;t<65536;t++)rt[t]=t>255?255+~~(t/255):t}}function it(t,e){var n=t.tokenTypeIdx;return n===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[n]}function at(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var ct=1,st={};function ut(t){var e=ft(t);lt(e),pt(e),ht(e),(0,o.jJ)(e,(function(t){t.isParent=t.categoryMatches.length>0}))}function ft(t){var e=(0,o.T9)(t),n=t,r=!0;while(r){n=(0,o.oE)((0,o.Bq)((0,o.Tj)(n,(function(t){return t.CATEGORIES}))));var i=(0,o.iv)(n,e);e=e.concat(i),(0,o.Im)(i)?r=!1:n=i}return e}function lt(t){(0,o.jJ)(t,(function(t){mt(t)||(st[ct]=t,t.tokenTypeIdx=ct++),gt(t)&&!(0,o.cy)(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),gt(t)||(t.CATEGORIES=[]),Et(t)||(t.categoryMatches=[]),vt(t)||(t.categoryMatchesMap={})}))}function ht(t){(0,o.jJ)(t,(function(t){t.categoryMatches=[],(0,o.jJ)(t.categoryMatchesMap,(function(e,n){t.categoryMatches.push(st[n].tokenTypeIdx)}))}))}function pt(t){(0,o.jJ)(t,(function(t){dt([],t)}))}function dt(t,e){(0,o.jJ)(t,(function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0})),(0,o.jJ)(e.CATEGORIES,(function(n){var r=t.concat(e);(0,o.gR)(r,n)||dt(r,n)}))}function mt(t){return(0,o.zy)(t,"tokenTypeIdx")}function gt(t){return(0,o.zy)(t,"CATEGORIES")}function Et(t){return(0,o.zy)(t,"categoryMatches")}function vt(t){return(0,o.zy)(t,"categoryMatchesMap")}function yt(t){return(0,o.zy)(t,"tokenTypeIdx")}var Nt,Tt={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,n,r,o){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+", skipped "+n+" characters."}};(function(t){t[t["MISSING_PATTERN"]=0]="MISSING_PATTERN",t[t["INVALID_PATTERN"]=1]="INVALID_PATTERN",t[t["EOI_ANCHOR_FOUND"]=2]="EOI_ANCHOR_FOUND",t[t["UNSUPPORTED_FLAGS_FOUND"]=3]="UNSUPPORTED_FLAGS_FOUND",t[t["DUPLICATE_PATTERNS_FOUND"]=4]="DUPLICATE_PATTERNS_FOUND",t[t["INVALID_GROUP_TYPE_FOUND"]=5]="INVALID_GROUP_TYPE_FOUND",t[t["PUSH_MODE_DOES_NOT_EXIST"]=6]="PUSH_MODE_DOES_NOT_EXIST",t[t["MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE"]=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t["MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY"]=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t["MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST"]=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t["LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED"]=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t["SOI_ANCHOR_FOUND"]=11]="SOI_ANCHOR_FOUND",t[t["EMPTY_MATCH_PATTERN"]=12]="EMPTY_MATCH_PATTERN",t[t["NO_LINE_BREAKS_FLAGS"]=13]="NO_LINE_BREAKS_FLAGS",t[t["UNREACHABLE_PATTERN"]=14]="UNREACHABLE_PATTERN",t[t["IDENTIFY_TERMINATOR"]=15]="IDENTIFY_TERMINATOR",t[t["CUSTOM_LINE_BREAK"]=16]="CUSTOM_LINE_BREAK"})(Nt||(Nt={}));var Rt={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Tt,traceInitPerf:!1,skipValidations:!1};Object.freeze(Rt);var At=function(){function t(t,e){var n=this;if(void 0===e&&(e=Rt),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"===typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,o.h1)(Rt,e);var r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"===typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var r,i=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===Rt.lineTerminatorsPattern)n.config.lineTerminatorsPattern=X;else if(n.config.lineTerminatorCharacters===Rt.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),(0,o.cy)(t)?(r={modes:{}},r.modes[A]=(0,o.T9)(t),r[A]=A):(i=!1,r=(0,o.lR)(t))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Y(r,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(W(r,n.trackStartLines,n.config.lineTerminatorCharacters))}))),r.modes=r.modes?r.modes:{},(0,o.jJ)(r.modes,(function(t,e){r.modes[e]=(0,o.ku)(t,(function(t){return(0,o.b0)(t)}))}));var a=(0,o.HP)(r.modes);if((0,o.jJ)(r.modes,(function(t,r){n.TRACE_INIT("Mode: <"+r+"> processing",(function(){var i;(n.modes.push(r),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(I(t,a))})),(0,o.Im)(n.lexerDefinitionErrors))&&(ut(t),n.TRACE_INIT("analyzeTokenTypes",(function(){i=w(t,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[r]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[r]=i.charCodeToPatternIdxToConfig,n.emptyGroups=(0,o.h1)(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[r]=i.canBeOptimized)}))})),n.defaultMode=r.defaultMode,!(0,o.Im)(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var c=(0,o.Tj)(n.lexerDefinitionErrors,(function(t){return t.message})),s=c.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+s)}(0,o.jJ)(n.lexerDefinitionWarning,(function(t){(0,o.x5)(t.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(O?(n.chopInput=o.zK,n.match=n.matchWithTest):(n.updateLastIndex=o.tE,n.match=n.matchWithExec),i&&(n.handleModes=o.tE),!1===n.trackStartLines&&(n.computeNewColumn=o.zK),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=o.tE),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var t=(0,o.TS)(n.canModeBeOptimized,(function(t,e,n){return!1===e&&t.push(n),t}),[]);if(e.ensureOptimizations&&!(0,o.Im)(t))throw Error("Lexer Modes: < "+t.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){u()})),n.TRACE_INIT("toFastProperties",(function(){(0,o.Bl)(n)}))}))}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!(0,o.Im)(this.lexerDefinitionErrors)){var n=(0,o.Tj)(this.lexerDefinitionErrors,(function(t){return t.message})),r=n.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}var i=this.tokenizeInternal(t,e);return i},t.prototype.tokenizeInternal=function(t,e){var n,r,i,a,c,s,u,f,l,h,p,d,m,g,E=this,v=t,y=v.length,N=0,T=0,R=this.hasCustom?0:Math.floor(t.length/10),A=new Array(R),M=[],O=this.trackStartLines?1:void 0,w=this.trackStartLines?1:void 0,I=$(this.emptyGroups),S=this.trackStartLines,C=this.config.lineTerminatorsPattern,b=0,U=[],L=[],x=[],_=[];Object.freeze(_);var k=void 0;function P(){return U}function B(t){var e=nt(t),n=L[e];return void 0===n?_:n}var F,D=function(t){if(1===x.length&&void 0===t.tokenType.PUSH_MODE){var e=E.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);M.push({offset:t.startOffset,line:void 0!==t.startLine?t.startLine:void 0,column:void 0!==t.startColumn?t.startColumn:void 0,length:t.image.length,message:e})}else{x.pop();var n=(0,o.HV)(x);U=E.patternIdxToConfig[n],L=E.charCodeToPatternIdxToConfig[n],b=U.length;var r=E.canModeBeOptimized[n]&&!1===E.config.safeMode;k=L&&r?B:P}};function j(t){x.push(t),L=this.charCodeToPatternIdxToConfig[t],U=this.patternIdxToConfig[t],b=U.length,b=U.length;var e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;k=L&&e?B:P}j.call(this,e);while(N<y){c=null;var V=v.charCodeAt(N),G=k(V),H=G.length;for(n=0;n<H;n++){F=G[n];var z=F.pattern;s=null;var Y=F.short;if(!1!==Y?V===Y&&(c=z):!0===F.isCustom?(g=z.exec(v,N,A,I),null!==g?(c=g[0],void 0!==g.payload&&(s=g.payload)):c=null):(this.updateLastIndex(z,N),c=this.match(z,t,N)),null!==c){if(a=F.longerAlt,void 0!==a){var W=U[a],q=W.pattern;u=null,!0===W.isCustom?(g=q.exec(v,N,A,I),null!==g?(i=g[0],void 0!==g.payload&&(u=g.payload)):i=null):(this.updateLastIndex(q,N),i=this.match(q,t,N)),i&&i.length>c.length&&(c=i,s=u,F=W)}break}}if(null!==c){if(f=c.length,l=F.group,void 0!==l&&(h=F.tokenTypeIdx,p=this.createTokenInstance(c,N,h,F.tokenType,O,w,f),this.handlePayload(p,s),!1===l?T=this.addToken(A,T,p):I[l].push(p)),t=this.chopInput(t,f),N+=f,w=this.computeNewColumn(w,f),!0===S&&!0===F.canLineTerminator){var K=0,X=void 0,J=void 0;C.lastIndex=0;do{X=C.test(c),!0===X&&(J=C.lastIndex-1,K++)}while(!0===X);0!==K&&(O+=K,w=f-J,this.updateTokenEndLineColumnLocation(p,l,J,K,O,w,f))}this.handleModes(F,D,j,p)}else{var Q=N,Z=O,tt=w,et=!1;while(!et&&N<y)for(v.charCodeAt(N),t=this.chopInput(t,1),N++,r=0;r<b;r++){var rt=U[r];z=rt.pattern,Y=rt.short;if(!1!==Y?v.charCodeAt(N)===Y&&(et=!0):!0===rt.isCustom?et=null!==z.exec(v,N,A,I):(this.updateLastIndex(z,N),et=null!==z.exec(t)),!0===et)break}d=N-Q,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(v,Q,d,Z,tt),M.push({offset:Q,line:Z,column:tt,length:d,message:m})}}return this.hasCustom||(A.length=T),{tokens:A,groups:I,errors:M}},t.prototype.handleModes=function(t,e,n,r){if(!0===t.pop){var o=t.push;e(r),void 0!==o&&n.call(this,o)}else void 0!==t.push&&n.call(this,t.push)},t.prototype.chopInput=function(t,e){return t.substring(e)},t.prototype.updateLastIndex=function(t,e){t.lastIndex=e},t.prototype.updateTokenEndLineColumnLocation=function(t,e,n,r,o,i,a){var c,s;void 0!==e&&(c=n===a-1,s=c?-1:0,1===r&&!0===c||(t.endLine=o+s,t.endColumn=i-1-s))},t.prototype.computeNewColumn=function(t,e){return t+e},t.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.prototype.createOffsetOnlyToken=function(t,e,n,r){return{image:t,startOffset:e,tokenTypeIdx:n,tokenType:r}},t.prototype.createStartOnlyToken=function(t,e,n,r,o,i){return{image:t,startOffset:e,startLine:o,startColumn:i,tokenTypeIdx:n,tokenType:r}},t.prototype.createFullToken=function(t,e,n,r,o,i,a){return{image:t,startOffset:e,endOffset:e+a-1,startLine:o,endLine:o,startColumn:i,endColumn:i+a-1,tokenTypeIdx:n,tokenType:r}},t.prototype.addToken=function(t,e,n){return 666},t.prototype.addTokenUsingPush=function(t,e,n){return t.push(n),e},t.prototype.addTokenUsingMemberAccess=function(t,e,n){return t[e]=n,e++,e},t.prototype.handlePayload=function(t,e){},t.prototype.handlePayloadNoCustom=function(t,e){},t.prototype.handlePayloadWithCustom=function(t,e){null!==e&&(t.payload=e)},t.prototype.match=function(t,e,n){return null},t.prototype.matchWithTest=function(t,e,n){var r=t.test(e);return!0===r?e.substring(n,t.lastIndex):null},t.prototype.matchWithExec=function(t,e){var n=t.exec(e);return null!==n?n[0]:n},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+t+">");var r=(0,o.O1)(e),i=r.time,a=r.value,c=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,a}return e()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function Mt(t){return wt(t)?t.LABEL:t.name}function Ot(t){return t.name}function wt(t){return(0,o.Kg)(t.LABEL)&&""!==t.LABEL}var It="parent",St="categories",Ct="label",bt="group",Ut="push_mode",Lt="pop_mode",xt="longer_alt",_t="line_breaks",kt="start_chars_hint";function Pt(t){return Bt(t)}function Bt(t){var e=t.pattern,n={};if(n.name=t.name,(0,o.b0)(e)||(n.PATTERN=e),(0,o.zy)(t,It))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,o.zy)(t,St)&&(n.CATEGORIES=t[St]),ut([n]),(0,o.zy)(t,Ct)&&(n.LABEL=t[Ct]),(0,o.zy)(t,bt)&&(n.GROUP=t[bt]),(0,o.zy)(t,Lt)&&(n.POP_MODE=t[Lt]),(0,o.zy)(t,Ut)&&(n.PUSH_MODE=t[Ut]),(0,o.zy)(t,xt)&&(n.LONGER_ALT=t[xt]),(0,o.zy)(t,_t)&&(n.LINE_BREAKS=t[_t]),(0,o.zy)(t,kt)&&(n.START_CHARS_HINT=t[kt]),n}var Ft=Pt({name:"EOF",pattern:At.NA});function Dt(t,e,n,r,o,i,a,c){return{image:e,startOffset:n,endOffset:r,startLine:o,endLine:i,startColumn:a,endColumn:c,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function jt(t,e){return it(t,e)}ut([Ft]);var Vt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(){function t(t){this._definition=t}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),t.prototype.accept=function(t){t.visit(this),(0,o.jJ)(this.definition,(function(e){e.accept(t)}))},t}(),Ht=function(t){function e(e){var n=t.call(this,[])||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(Gt),zt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.orgText="",(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),Yt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.ignoreAmbiguities=!1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),Wt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),$t=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),qt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),Kt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),Xt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),e}(Gt),Jt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,(0,o.kp)(n,(0,o.Up)(e,(function(t){return void 0!==t}))),n}return Vt(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e}(Gt),Qt=function(){function t(t){this.idx=1,(0,o.kp)(this,(0,o.Up)(t,(function(t){return void 0!==t})))}return t.prototype.accept=function(t){t.visit(this)},t}();function Zt(t){return(0,o.Tj)(t,te)}function te(t){function e(t){return(0,o.Tj)(t,te)}if(t instanceof Ht)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof Yt)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Wt)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof $t)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof qt)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:te(new Qt({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Xt)return{type:"RepetitionWithSeparator",idx:t.idx,separator:te(new Qt({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Kt)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Jt)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Qt){var n={type:"Terminal",name:t.terminalType.name,label:Mt(t.terminalType),idx:t.idx},r=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=(0,o.gd)(r)?r.source:r),n}if(t instanceof zt)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}var ee=function(){function t(){}return t.prototype.walk=function(t,e){var n=this;void 0===e&&(e=[]),(0,o.jJ)(t.definition,(function(r,i){var a=(0,o.gv)(t.definition,i+1);if(r instanceof Ht)n.walkProdRef(r,a,e);else if(r instanceof Qt)n.walkTerminal(r,a,e);else if(r instanceof Yt)n.walkFlat(r,a,e);else if(r instanceof Wt)n.walkOption(r,a,e);else if(r instanceof $t)n.walkAtLeastOne(r,a,e);else if(r instanceof qt)n.walkAtLeastOneSep(r,a,e);else if(r instanceof Xt)n.walkManySep(r,a,e);else if(r instanceof Kt)n.walkMany(r,a,e);else{if(!(r instanceof Jt))throw Error("non exhaustive match");n.walkOr(r,a,e)}}))},t.prototype.walkTerminal=function(t,e,n){},t.prototype.walkProdRef=function(t,e,n){},t.prototype.walkFlat=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkOption=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkAtLeastOne=function(t,e,n){var r=[new Wt({definition:t.definition})].concat(e,n);this.walk(t,r)},t.prototype.walkAtLeastOneSep=function(t,e,n){var r=ne(t,e,n);this.walk(t,r)},t.prototype.walkMany=function(t,e,n){var r=[new Wt({definition:t.definition})].concat(e,n);this.walk(t,r)},t.prototype.walkManySep=function(t,e,n){var r=ne(t,e,n);this.walk(t,r)},t.prototype.walkOr=function(t,e,n){var r=this,i=e.concat(n);(0,o.jJ)(t.definition,(function(t){var e=new Yt({definition:[t]});r.walk(e,i)}))},t}();function ne(t,e,n){var r=[new Wt({definition:[new Qt({terminalType:t.separator})].concat(t.definition)})],o=r.concat(e,n);return o}var re=function(){function t(){}return t.prototype.visit=function(t){var e=t;switch(e.constructor){case Ht:return this.visitNonTerminal(e);case Yt:return this.visitAlternative(e);case Wt:return this.visitOption(e);case $t:return this.visitRepetitionMandatory(e);case qt:return this.visitRepetitionMandatoryWithSeparator(e);case Xt:return this.visitRepetitionWithSeparator(e);case Kt:return this.visitRepetition(e);case Jt:return this.visitAlternation(e);case Qt:return this.visitTerminal(e);case zt:return this.visitRule(e);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(t){},t.prototype.visitAlternative=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}(),oe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function ie(t){return t instanceof Yt||t instanceof Wt||t instanceof Kt||t instanceof $t||t instanceof qt||t instanceof Xt||t instanceof Qt||t instanceof zt}function ae(t,e){void 0===e&&(e=[]);var n=t instanceof Wt||t instanceof Kt||t instanceof Xt;return!!n||(t instanceof Jt?(0,o.zN)(t.definition,(function(t){return ae(t,e)})):!(t instanceof Ht&&(0,o.gR)(e,t))&&(t instanceof Gt&&(t instanceof Ht&&e.push(t),(0,o.Si)(t.definition,(function(t){return ae(t,e)})))))}function ce(t){return t instanceof Jt}function se(t){if(t instanceof Ht)return"SUBRULE";if(t instanceof Wt)return"OPTION";if(t instanceof Jt)return"OR";if(t instanceof $t)return"AT_LEAST_ONE";if(t instanceof qt)return"AT_LEAST_ONE_SEP";if(t instanceof Xt)return"MANY_SEP";if(t instanceof Kt)return"MANY";if(t instanceof Qt)return"CONSUME";throw Error("non exhaustive match")}var ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return oe(e,t),e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var e=t.terminalType.name+this.separator+"Terminal";(0,o.zy)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitNonTerminal=function(t){var e=t.nonTerminalName+this.separator+"Terminal";(0,o.zy)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(re),fe=new ue;function le(t){fe.reset(),t.accept(fe);var e=fe.dslMethods;return fe.reset(),e}function he(t){if(t instanceof Ht)return he(t.referencedRule);if(t instanceof Qt)return me(t);if(ie(t))return pe(t);if(ce(t))return de(t);throw Error("non exhaustive match")}function pe(t){var e,n=[],r=t.definition,i=0,a=r.length>i,c=!0;while(a&&c)e=r[i],c=ae(e),n=n.concat(he(e)),i+=1,a=r.length>i;return(0,o.sb)(n)}function de(t){var e=(0,o.Tj)(t.definition,(function(t){return he(t)}));return(0,o.sb)((0,o.Bq)(e))}function me(t){return[t.terminalType]}var ge="_~IN~_",Ee=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ve=function(t){function e(e){var n=t.call(this)||this;return n.topProd=e,n.follows={},n}return Ee(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,n){},e.prototype.walkProdRef=function(t,e,n){var r=Ne(t.referencedRule,t.idx)+this.topProd.name,o=e.concat(n),i=new Yt({definition:o}),a=he(i);this.follows[r]=a},e}(ee);function ye(t){var e={};return(0,o.jJ)(t,(function(t){var n=new ve(t).startWalking();(0,o.kp)(e,n)})),e}function Ne(t,e){return t.name+e+ge}var Te={buildMismatchTokenMessage:function(t){var e=t.expected,n=t.actual,r=(t.previous,t.ruleName,wt(e)),o=r?"--\x3e "+Mt(e)+" <--":"token of type --\x3e "+e.name+" <--",i="Expecting "+o+" but found --\x3e '"+n.image+"' <--";return i},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;t.ruleName;return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,n=t.actual,r=(t.previous,t.customUserDescription),i=(t.ruleName,"Expecting: "),a=(0,o.$1)(n).image,c="\nbut found: '"+a+"'";if(r)return i+r+c;var s=(0,o.TS)(e,(function(t,e){return t.concat(e)}),[]),u=(0,o.Tj)(s,(function(t){return"["+(0,o.Tj)(t,(function(t){return Mt(t)})).join(", ")+"]"})),f=(0,o.Tj)(u,(function(t,e){return"  "+(e+1)+". "+t})),l="one of these possible Token sequences:\n"+f.join("\n");return i+l+c},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,n=t.actual,r=t.customUserDescription,i=(t.ruleName,"Expecting: "),a=(0,o.$1)(n).image,c="\nbut found: '"+a+"'";if(r)return i+r+c;var s=(0,o.Tj)(e,(function(t){return"["+(0,o.Tj)(t,(function(t){return Mt(t)})).join(",")+"]"})),u="expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+s.join(" ,")+">";return i+u+c}};Object.freeze(Te);var Re={buildRuleNotFoundError:function(t,e){var n="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-";return n}},Ae={buildDuplicateFoundError:function(t,e){function n(t){return t instanceof Qt?t.terminalType.name:t instanceof Ht?t.nonTerminalName:""}var r=t.name,i=(0,o.$1)(e),a=i.idx,c=se(i),s=n(i),u=a>0,f="->"+c+(u?a:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+"\n                  appears more than once ("+e.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return f=f.replace(/[ \t]+/g," "),f=f.replace(/\s\s+/g,"\n"),f},buildNamespaceConflictError:function(t){var e="Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter.";return e},buildAlternationPrefixAmbiguityError:function(t){var e=(0,o.Tj)(t.prefixPath,(function(t){return Mt(t)})).join(", "),n=0===t.alternation.idx?"":t.alternation.idx,r="Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details.";return r},buildAlternationAmbiguityError:function(t){var e=(0,o.Tj)(t.prefixPath,(function(t){return Mt(t)})).join(", "),n=0===t.alternation.idx?"":t.alternation.idx,r="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\n";return r+="See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details.",r},buildEmptyRepetitionError:function(t){var e=se(t.repetition);0!==t.repetition.idx&&(e+=t.repetition.idx);var n="The repetition <"+e+"> within Rule <"+t.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop.";return n},buildTokenNameError:function(t){return"deprecated"},buildEmptyAlternationError:function(t){var e="Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+"> in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(t){var e="An Alternation cannot have more than 256 alternatives:\n<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\n has "+(t.alternation.definition.length+1)+" alternatives.";return e},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,n=o.Tj(t.leftRecursionPath,(function(t){return t.name})),r=e+" --\x3e "+n.concat([e]).join(" --\x3e "),i="Left Recursion found in grammar.\nrule: <"+e+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+r+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.";return i},buildInvalidRuleNameError:function(t){return"deprecated"},buildDuplicateRuleNameError:function(t){var e;e=t.topLevelRule instanceof zt?t.topLevelRule.name:t.topLevelRule;var n="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+t.grammarName+"<-";return n}},Me=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function Oe(t,e){var n=new we(t,e);return n.resolveRefs(),n.errors}var we=function(t){function e(e,n){var r=t.call(this)||this;return r.nameToTopRule=e,r.errMsgProvider=n,r.errors=[],r}return Me(e,t),e.prototype.resolveRefs=function(){var t=this;(0,o.jJ)((0,o.zu)(this.nameToTopRule),(function(e){t.currTopLevel=e,e.accept(t)}))},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:n,type:_r.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(re),Ie=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(t){function e(e,n){var r=t.call(this)||this;return r.topProd=e,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return Ie(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,o.T9)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,o.T9)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,n){void 0===n&&(n=[]),this.found||t.prototype.walk.call(this,e,n)},e.prototype.walkProdRef=function(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}},e.prototype.updateExpectedNext=function(){(0,o.Im)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(ee),Ce=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return Ie(e,t),e.prototype.walkTerminal=function(t,e,n){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var r=e.concat(n),o=new Yt({definition:r});this.possibleTokTypes=he(o),this.found=!0}},e}(Se),be=function(t){function e(e,n){var r=t.call(this)||this;return r.topRule=e,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return Ie(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(ee),Ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.prototype.walkMany=function(e,n,r){if(e.idx===this.occurrence){var i=(0,o.$1)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof Qt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkMany.call(this,e,n,r)},e}(be),Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.prototype.walkManySep=function(e,n,r){if(e.idx===this.occurrence){var i=(0,o.$1)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof Qt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkManySep.call(this,e,n,r)},e}(be),xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.prototype.walkAtLeastOne=function(e,n,r){if(e.idx===this.occurrence){var i=(0,o.$1)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof Qt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkAtLeastOne.call(this,e,n,r)},e}(be),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.prototype.walkAtLeastOneSep=function(e,n,r){if(e.idx===this.occurrence){var i=(0,o.$1)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof Qt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkAtLeastOneSep.call(this,e,n,r)},e}(be);function ke(t,e,n){void 0===n&&(n=[]),n=(0,o.T9)(n);var r=[],i=0;function a(e){return e.concat((0,o.gv)(t,i+1))}function c(t){var o=ke(a(t),e,n);return r.concat(o)}while(n.length<e&&i<t.length){var s=t[i];if(s instanceof Yt)return c(s.definition);if(s instanceof Ht)return c(s.definition);if(s instanceof Wt)r=c(s.definition);else{if(s instanceof $t){var u=s.definition.concat([new Kt({definition:s.definition})]);return c(u)}if(s instanceof qt){u=[new Yt({definition:s.definition}),new Kt({definition:[new Qt({terminalType:s.separator})].concat(s.definition)})];return c(u)}if(s instanceof Xt){u=s.definition.concat([new Kt({definition:[new Qt({terminalType:s.separator})].concat(s.definition)})]);r=c(u)}else if(s instanceof Kt){u=s.definition.concat([new Kt({definition:s.definition})]);r=c(u)}else{if(s instanceof Jt)return(0,o.jJ)(s.definition,(function(t){!1===(0,o.Im)(t.definition)&&(r=c(t.definition))})),r;if(!(s instanceof Qt))throw Error("non exhaustive match");n.push(s.terminalType)}}i++}return r.push({partialPath:n,suffixDef:(0,o.gv)(t,i)}),r}function Pe(t,e,n,r){var i="EXIT_NONE_TERMINAL",a=[i],c="EXIT_ALTERNATIVE",s=!1,u=e.length,f=u-r-1,l=[],h=[];h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});while(!(0,o.Im)(h)){var p=h.pop();if(p!==c){var d=p.def,m=p.idx,g=p.ruleStack,E=p.occurrenceStack;if(!(0,o.Im)(d)){var v=d[0];if(v===i){var y={idx:m,def:(0,o.gv)(d),ruleStack:(0,o.gc)(g),occurrenceStack:(0,o.gc)(E)};h.push(y)}else if(v instanceof Qt)if(m<u-1){var N=m+1,T=e[N];if(n(T,v.terminalType)){y={idx:N,def:(0,o.gv)(d),ruleStack:g,occurrenceStack:E};h.push(y)}}else{if(m!==u-1)throw Error("non exhaustive match");l.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:E}),s=!0}else if(v instanceof Ht){var R=(0,o.T9)(g);R.push(v.nonTerminalName);var A=(0,o.T9)(E);A.push(v.idx);y={idx:m,def:v.definition.concat(a,(0,o.gv)(d)),ruleStack:R,occurrenceStack:A};h.push(y)}else if(v instanceof Wt){var M={idx:m,def:(0,o.gv)(d),ruleStack:g,occurrenceStack:E};h.push(M),h.push(c);var O={idx:m,def:v.definition.concat((0,o.gv)(d)),ruleStack:g,occurrenceStack:E};h.push(O)}else if(v instanceof $t){var w=new Kt({definition:v.definition,idx:v.idx}),I=v.definition.concat([w],(0,o.gv)(d));y={idx:m,def:I,ruleStack:g,occurrenceStack:E};h.push(y)}else if(v instanceof qt){var S=new Qt({terminalType:v.separator});w=new Kt({definition:[S].concat(v.definition),idx:v.idx}),I=v.definition.concat([w],(0,o.gv)(d)),y={idx:m,def:I,ruleStack:g,occurrenceStack:E};h.push(y)}else if(v instanceof Xt){M={idx:m,def:(0,o.gv)(d),ruleStack:g,occurrenceStack:E};h.push(M),h.push(c);S=new Qt({terminalType:v.separator});var C=new Kt({definition:[S].concat(v.definition),idx:v.idx});I=v.definition.concat([C],(0,o.gv)(d)),O={idx:m,def:I,ruleStack:g,occurrenceStack:E};h.push(O)}else if(v instanceof Kt){M={idx:m,def:(0,o.gv)(d),ruleStack:g,occurrenceStack:E};h.push(M),h.push(c);C=new Kt({definition:v.definition,idx:v.idx}),I=v.definition.concat([C],(0,o.gv)(d)),O={idx:m,def:I,ruleStack:g,occurrenceStack:E};h.push(O)}else if(v instanceof Jt)for(var b=v.definition.length-1;b>=0;b--){var U=v.definition[b],L={idx:m,def:U.definition.concat((0,o.gv)(d)),ruleStack:g,occurrenceStack:E};h.push(L),h.push(c)}else if(v instanceof Yt)h.push({idx:m,def:v.definition.concat((0,o.gv)(d)),ruleStack:g,occurrenceStack:E});else{if(!(v instanceof zt))throw Error("non exhaustive match");h.push(Be(v,m,g,E))}}}else s&&(0,o.HV)(h).idx<=f&&h.pop()}return l}function Be(t,e,n,r){var i=(0,o.T9)(n);i.push(t.name);var a=(0,o.T9)(r);return a.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:a}}var Fe,De=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function je(t){if(t instanceof Wt)return Fe.OPTION;if(t instanceof Kt)return Fe.REPETITION;if(t instanceof $t)return Fe.REPETITION_MANDATORY;if(t instanceof qt)return Fe.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Xt)return Fe.REPETITION_WITH_SEPARATOR;if(t instanceof Jt)return Fe.ALTERNATION;throw Error("non exhaustive match")}function Ve(t,e,n,r,o,i){var a=Je(t,e,n),c=en(a)?at:it;return i(a,r,c,o)}function Ge(t,e,n,r,o,i){var a=Qe(t,e,o,n),c=en(a)?at:it;return i(a[0],c,r)}function He(t,e,n,r){var i=t.length,a=(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return 1===t.length}))}));if(e)return function(e){for(var r=(0,o.Tj)(e,(function(t){return t.GATE})),a=0;a<i;a++){var c=t[a],s=c.length,u=r[a];if(void 0===u||!1!==u.call(this))t:for(var f=0;f<s;f++){for(var l=c[f],h=l.length,p=0;p<h;p++){var d=this.LA(p+1);if(!1===n(d,l[p]))continue t}return a}}};if(a&&!r){var c=(0,o.Tj)(t,(function(t){return(0,o.Bq)(t)})),s=(0,o.TS)(c,(function(t,e,n){return(0,o.jJ)(e,(function(e){(0,o.zy)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=n),(0,o.jJ)(e.categoryMatches,(function(e){(0,o.zy)(t,e)||(t[e]=n)}))})),t}),[]);return function(){var t=this.LA(1);return s[t.tokenTypeIdx]}}return function(){for(var e=0;e<i;e++){var r=t[e],o=r.length;t:for(var a=0;a<o;a++){for(var c=r[a],s=c.length,u=0;u<s;u++){var f=this.LA(u+1);if(!1===n(f,c[u]))continue t}return e}}}}function ze(t,e,n){var r=(0,o.Si)(t,(function(t){return 1===t.length})),i=t.length;if(r&&!n){var a=(0,o.Bq)(t);if(1===a.length&&(0,o.Im)(a[0].categoryMatches)){var c=a[0],s=c.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var u=(0,o.TS)(a,(function(t,e,n){return t[e.tokenTypeIdx]=!0,(0,o.jJ)(e.categoryMatches,(function(e){t[e]=!0})),t}),[]);return function(){var t=this.LA(1);return!0===u[t.tokenTypeIdx]}}return function(){t:for(var n=0;n<i;n++){for(var r=t[n],o=r.length,a=0;a<o;a++){var c=this.LA(a+1);if(!1===e(c,r[a]))continue t}return!0}return!1}}(function(t){t[t["OPTION"]=0]="OPTION",t[t["REPETITION"]=1]="REPETITION",t[t["REPETITION_MANDATORY"]=2]="REPETITION_MANDATORY",t[t["REPETITION_MANDATORY_WITH_SEPARATOR"]=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t["REPETITION_WITH_SEPARATOR"]=4]="REPETITION_WITH_SEPARATOR",t[t["ALTERNATION"]=5]="ALTERNATION"})(Fe||(Fe={}));var Ye=function(t){function e(e,n,r){var o=t.call(this)||this;return o.topProd=e,o.targetOccurrence=n,o.targetProdType=r,o}return De(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,n,r){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=n.concat(r),!0)},e.prototype.walkOption=function(e,n,r){this.checkIsTarget(e,Fe.OPTION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOne=function(e,n,r){this.checkIsTarget(e,Fe.REPETITION_MANDATORY,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOneSep=function(e,n,r){this.checkIsTarget(e,Fe.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkMany=function(e,n,r){this.checkIsTarget(e,Fe.REPETITION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkManySep=function(e,n,r){this.checkIsTarget(e,Fe.REPETITION_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e}(ee),We=function(t){function e(e,n,r){var o=t.call(this)||this;return o.targetOccurrence=e,o.targetProdType=n,o.targetRef=r,o.result=[],o}return De(e,t),e.prototype.checkIsTarget=function(t,e){t.idx!==this.targetOccurrence||this.targetProdType!==e||void 0!==this.targetRef&&t!==this.targetRef||(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,Fe.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,Fe.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,Fe.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,Fe.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,Fe.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,Fe.ALTERNATION)},e}(re);function $e(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=[];return e}function qe(t){for(var e=[""],n=0;n<t.length;n++){for(var r=t[n],o=[],i=0;i<e.length;i++){var a=e[i];o.push(a+"_"+r.tokenTypeIdx);for(var c=0;c<r.categoryMatches.length;c++){var s="_"+r.categoryMatches[c];o.push(a+s)}}e=o}return e}function Ke(t,e,n){for(var r=0;r<t.length;r++)if(r!==n)for(var o=t[r],i=0;i<e.length;i++){var a=e[i];if(!0===o[a])return!1}return!0}function Xe(t,e){for(var n=(0,o.Tj)(t,(function(t){return ke([t],1)})),r=$e(n.length),i=(0,o.Tj)(n,(function(t){var e={};return(0,o.jJ)(t,(function(t){var n=qe(t.partialPath);(0,o.jJ)(n,(function(t){e[t]=!0}))})),e})),a=n,c=1;c<=e;c++){var s=a;a=$e(s.length);for(var u=function(t){for(var n=s[t],u=0;u<n.length;u++){var f=n[u].partialPath,l=n[u].suffixDef,h=qe(f),p=Ke(i,h,t);if(p||(0,o.Im)(l)||f.length===e){var d=r[t];if(!1===Ze(d,f)){d.push(f);for(var m=0;m<h.length;m++){var g=h[m];i[t][g]=!0}}}else{var E=ke(l,c+1,f);a[t]=a[t].concat(E),(0,o.jJ)(E,(function(e){var n=qe(e.partialPath);(0,o.jJ)(n,(function(e){i[t][e]=!0}))}))}}},f=0;f<s.length;f++)u(f)}return r}function Je(t,e,n,r){var o=new We(t,Fe.ALTERNATION,r);return e.accept(o),Xe(o.result,n)}function Qe(t,e,n,r){var o=new We(t,n);e.accept(o);var i=o.result,a=new Ye(e,t,n),c=a.startWalking(),s=new Yt({definition:i}),u=new Yt({definition:c});return Xe([s,u],r)}function Ze(t,e){t:for(var n=0;n<t.length;n++){var r=t[n];if(r.length===e.length){for(var o=0;o<r.length;o++){var i=e[o],a=r[o],c=i===a||void 0!==a.categoryMatchesMap[i.tokenTypeIdx];if(!1===c)continue t}return!0}}return!1}function tn(t,e){return t.length<e.length&&(0,o.Si)(t,(function(t,n){var r=e[n];return t===r||r.categoryMatchesMap[t.tokenTypeIdx]}))}function en(t){return(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return(0,o.Si)(t,(function(t){return(0,o.Im)(t.categoryMatches)}))}))}))}var nn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function rn(t,e,n,r,i){var a=o.Tj(t,(function(t){return on(t,r)})),c=o.Tj(t,(function(t){return ln(t,t,r)})),s=[],u=[],f=[];(0,o.Si)(c,o.Im)&&(s=(0,o.Tj)(t,(function(t){return dn(t,r)})),u=(0,o.Tj)(t,(function(t){return mn(t,e,r)})),f=vn(t,e,r));var l=Tn(t,n,r),h=(0,o.Tj)(t,(function(t){return En(t,r)})),p=(0,o.Tj)(t,(function(e){return un(e,t,i,r)}));return o.Bq(a.concat(f,c,s,u,l,h,p))}function on(t,e){var n=new sn;t.accept(n);var r=n.allProductions,i=o.$z(r,an),a=o.Up(i,(function(t){return t.length>1})),c=o.Tj(o.zu(a),(function(n){var r=o.$1(n),i=e.buildDuplicateFoundError(t,n),a=se(r),c={message:i,type:_r.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:r.idx},s=cn(r);return s&&(c.parameter=s),c}));return c}function an(t){return se(t)+"_#_"+t.idx+"_#_"+cn(t)}function cn(t){return t instanceof Qt?t.terminalType.name:t instanceof Ht?t.nonTerminalName:""}var sn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return nn(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(re);function un(t,e,n,r){var i=[],a=(0,o.TS)(e,(function(e,n){return n.name===t.name?e+1:e}),0);if(a>1){var c=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:c,type:_r.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function fn(t,e,n){var r,i=[];return o.gR(e,t)||(r="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",i.push({message:r,type:_r.INVALID_RULE_OVERRIDE,ruleName:t})),i}function ln(t,e,n,r){void 0===r&&(r=[]);var i=[],a=hn(e.definition);if(o.Im(a))return[];var c=t.name,s=o.gR(a,t);s&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:_r.LEFT_RECURSION,ruleName:c});var u=o.iv(a,r.concat([t])),f=o.Tj(u,(function(e){var i=o.T9(r);return i.push(e),ln(t,e,n,i)}));return i.concat(o.Bq(f))}function hn(t){var e=[];if(o.Im(t))return e;var n=o.$1(t);if(n instanceof Ht)e.push(n.referencedRule);else if(n instanceof Yt||n instanceof Wt||n instanceof $t||n instanceof qt||n instanceof Xt||n instanceof Kt)e=e.concat(hn(n.definition));else if(n instanceof Jt)e=o.Bq(o.Tj(n.definition,(function(t){return hn(t.definition)})));else if(!(n instanceof Qt))throw Error("non exhaustive match");var r=ae(n),i=t.length>1;if(r&&i){var a=o.gv(t);return e.concat(hn(a))}return e}var pn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alternations=[],e}return nn(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(re);function dn(t,e){var n=new pn;t.accept(n);var r=n.alternations,i=o.TS(r,(function(n,r){var i=o.gc(r.definition),a=o.Tj(i,(function(n,i){var a=Pe([n],[],null,1);return o.Im(a)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:r,emptyChoiceIdx:i}),type:_r.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:r.idx,alternative:i+1}:null}));return n.concat(o.oE(a))}),[]);return i}function mn(t,e,n){var r=new pn;t.accept(r);var i=r.alternations;i=(0,o.ku)(i,(function(t){return!0===t.ignoreAmbiguities}));var a=o.TS(i,(function(r,o){var i=o.idx,a=o.maxLookahead||e,c=Je(i,t,a,o),s=yn(c,o,t,n),u=Nn(c,o,t,n);return r.concat(s,u)}),[]);return a}var gn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return nn(e,t),e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(re);function En(t,e){var n=new pn;t.accept(n);var r=n.alternations,i=o.TS(r,(function(n,r){return r.definition.length>255&&n.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:r}),type:_r.TOO_MANY_ALTS,ruleName:t.name,occurrence:r.idx}),n}),[]);return i}function vn(t,e,n){var r=[];return(0,o.jJ)(t,(function(t){var i=new gn;t.accept(i);var a=i.allProductions;(0,o.jJ)(a,(function(i){var a=je(i),c=i.maxLookahead||e,s=i.idx,u=Qe(s,t,a,c),f=u[0];if((0,o.Im)((0,o.Bq)(f))){var l=n.buildEmptyRepetitionError({topLevelRule:t,repetition:i});r.push({message:l,type:_r.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}}))})),r}function yn(t,e,n,r){var i=[],a=(0,o.TS)(t,(function(n,r,a){return!0===e.definition[a].ignoreAmbiguities||(0,o.jJ)(r,(function(r){var c=[a];(0,o.jJ)(t,(function(t,n){a!==n&&Ze(t,r)&&!0!==e.definition[n].ignoreAmbiguities&&c.push(n)})),c.length>1&&!Ze(i,r)&&(i.push(r),n.push({alts:c,path:r}))})),n}),[]),c=o.Tj(a,(function(t){var i=(0,o.Tj)(t.alts,(function(t){return t+1})),a=r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:i,prefixPath:t.path});return{message:a,type:_r.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:[t.alts]}}));return c}function Nn(t,e,n,r){var i=[],a=(0,o.TS)(t,(function(t,e,n){var r=(0,o.Tj)(e,(function(t){return{idx:n,path:t}}));return t.concat(r)}),[]);return(0,o.jJ)(a,(function(t){var c=e.definition[t.idx];if(!0!==c.ignoreAmbiguities){var s=t.idx,u=t.path,f=(0,o.JW)(a,(function(t){return!0!==e.definition[t.idx].ignoreAmbiguities&&t.idx<s&&tn(t.path,u)})),l=(0,o.Tj)(f,(function(t){var o=[t.idx+1,s+1],i=0===e.idx?"":e.idx,a=r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:o,prefixPath:t.path});return{message:a,type:_r.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:i,alternatives:o}}));i=i.concat(l)}})),i}function Tn(t,e,n){var r=[],i=(0,o.Tj)(e,(function(t){return t.name}));return(0,o.jJ)(t,(function(t){var e=t.name;if((0,o.gR)(i,e)){var a=n.buildNamespaceConflictError(t);r.push({message:a,type:_r.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}})),r}function Rn(t){t=(0,o.NT)(t,{errMsgProvider:Re});var e={};return(0,o.jJ)(t.rules,(function(t){e[t.name]=t})),Oe(e,t.errMsgProvider)}function An(t){return t=(0,o.NT)(t,{errMsgProvider:Ae}),rn(t.rules,t.maxLookahead,t.tokenTypes,t.errMsgProvider,t.grammarName)}function Mn(t){(0,o.jJ)(t.rules,(function(t){var e=new ue;t.accept(e),(0,o.jJ)(e.dslMethods,(function(t){(0,o.jJ)(t,(function(t,e){t.idx=e+1}))}))}))}var On=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wn="MismatchedTokenException",In="NoViableAltException",Sn="EarlyExitException",Cn="NotAllInputParsedException",bn=[wn,In,Sn,Cn];function Un(t){return(0,o.gR)(bn,t.name)}Object.freeze(bn);var Ln=function(t){function e(e,n){var r=this.constructor,o=t.call(this,e)||this;return o.token=n,o.resyncedTokens=[],Object.setPrototypeOf(o,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return On(e,t),e}(Error),xn=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return o.previousToken=r,o.name=wn,o}return On(e,t),e}(Ln),_n=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return o.previousToken=r,o.name=In,o}return On(e,t),e}(Ln),kn=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.name=Cn,r}return On(e,t),e}(Ln),Pn=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return o.previousToken=r,o.name=Sn,o}return On(e,t),e}(Ln),Bn={},Fn="InRuleRecoveryException";function Dn(t){this.name=Fn,this.message=t}Dn.prototype=Error.prototype;var jn=function(){function t(){}return t.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,o.zy)(t,"recoveryEnabled")?t.recoveryEnabled:kr.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Vn)},t.prototype.getTokenToInsert=function(t){var e=Dt(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.tryInRepetitionRecovery=function(t,e,n,r){var i=this,a=this.findReSyncTokenType(),c=this.exportLexerState(),s=[],u=!1,f=this.LA(1),l=this.LA(1),h=function(){var t=i.LA(0),e=i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:f,previous:t,ruleName:i.getCurrRuleFullName()}),n=new xn(e,f,i.LA(0));n.resyncedTokens=(0,o.gc)(s),i.SAVE_ERROR(n)};while(!u){if(this.tokenMatcher(l,r))return void h();if(n.call(this))return h(),void t.apply(this,e);this.tokenMatcher(l,a)?u=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,s))}this.importLexerState(c)},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,n){return!1!==n&&(void 0!==t&&void 0!==e&&(!this.tokenMatcher(this.LA(1),t)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var n=this.getCurrentGrammarPath(t,e),r=this.getNextPossibleTokenTypes(n);return r},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var n=this.getTokenToInsert(t);return n}if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new Dn("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if((0,o.Im)(e))return!1;var r=this.LA(1),i=void 0!==(0,o.I6)(e,(function(t){return n.tokenMatcher(r,t)}));return i},t.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.tokenMatcher(this.LA(2),t);return e},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return(0,o.gR)(n,t)},t.prototype.findReSyncTokenType=function(){var t=this.flattenFollowSet(),e=this.LA(1),n=2;while(1){var r=e.tokenType;if((0,o.gR)(t,r))return r;e=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return Bn;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return(0,o.Tj)(e,(function(r,o){return 0===o?Bn:{ruleName:t.shortRuleNameToFullName(r),idxInCallingRule:n[o],inRule:t.shortRuleNameToFullName(e[o-1])}}))},t.prototype.flattenFollowSet=function(){var t=this,e=(0,o.Tj)(this.buildFullFollowKeyStack(),(function(e){return t.getFollowSetFromFollowKey(e)}));return(0,o.Bq)(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===Bn)return[Ft];var e=t.ruleName+t.idxInCallingRule+ge+t.inRule;return this.resyncFollows[e]},t.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,Ft)||e.push(t),e},t.prototype.reSyncTo=function(t){var e=[],n=this.LA(1);while(!1===this.tokenMatcher(n,t))n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return(0,o.gc)(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,n,r,o,i,a){},t.prototype.getCurrentGrammarPath=function(t,e){var n=this.getHumanReadableRuleStack(),r=(0,o.T9)(this.RULE_OCCURRENCE_STACK),i={ruleStack:n,occurrenceStack:r,lastTok:t,lastTokOccurrence:e};return i},t.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,o.Tj)(this.RULE_STACK,(function(e){return t.shortRuleNameToFullName(e)}))},t}();function Vn(t,e,n,r,o,i,a){var c=this.getKeyForAutomaticLookahead(r,o),s=this.firstAfterRepMap[c];if(void 0===s){var u=this.getCurrRuleFullName(),f=this.getGAstProductions()[u],l=new i(f,o);s=l.startWalking(),this.firstAfterRepMap[c]=s}var h=s.token,p=s.occurrence,d=s.isEndOfRule;1===this.RULE_STACK.length&&d&&void 0===h&&(h=Ft,p=1),this.shouldInRepetitionRecoveryBeTried(h,p,a)&&this.tryInRepetitionRecovery(t,e,n,h)}var Gn=4,Hn=8,zn=1<<Hn,Yn=2<<Hn,Wn=3<<Hn,$n=4<<Hn,qn=5<<Hn,Kn=6<<Hn;function Xn(t,e,n){return n|e|t}var Jn=function(){function t(){}return t.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,o.zy)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:kr.dynamicTokensEnabled,this.maxLookahead=(0,o.zy)(t,"maxLookahead")?t.maxLookahead:kr.maxLookahead,this.lookAheadFuncsCache=(0,o.rF)()?new Map:[],(0,o.rF)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(t){var e=this;(0,o.jJ)(t,(function(t){e.TRACE_INIT(t.name+" Rule Lookahead",(function(){var n=le(t),r=n.alternation,i=n.repetition,a=n.option,c=n.repetitionMandatory,s=n.repetitionMandatoryWithSeparator,u=n.repetitionWithSeparator;(0,o.jJ)(r,(function(n){var r=0===n.idx?"":n.idx;e.TRACE_INIT(""+se(n)+r,(function(){var r=Ve(n.idx,t,n.maxLookahead||e.maxLookahead,n.hasPredicates,e.dynamicTokensEnabled,e.lookAheadBuilderForAlternatives),o=Xn(e.fullRuleNameToShort[t.name],zn,n.idx);e.setLaFuncCache(o,r)}))})),(0,o.jJ)(i,(function(n){e.computeLookaheadFunc(t,n.idx,Wn,Fe.REPETITION,n.maxLookahead,se(n))})),(0,o.jJ)(a,(function(n){e.computeLookaheadFunc(t,n.idx,Yn,Fe.OPTION,n.maxLookahead,se(n))})),(0,o.jJ)(c,(function(n){e.computeLookaheadFunc(t,n.idx,$n,Fe.REPETITION_MANDATORY,n.maxLookahead,se(n))})),(0,o.jJ)(s,(function(n){e.computeLookaheadFunc(t,n.idx,Kn,Fe.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,se(n))})),(0,o.jJ)(u,(function(n){e.computeLookaheadFunc(t,n.idx,qn,Fe.REPETITION_WITH_SEPARATOR,n.maxLookahead,se(n))}))}))}))},t.prototype.computeLookaheadFunc=function(t,e,n,r,o,i){var a=this;this.TRACE_INIT(""+i+(0===e?"":e),(function(){var i=Ge(e,t,o||a.maxLookahead,a.dynamicTokensEnabled,r,a.lookAheadBuilderForOptional),c=Xn(a.fullRuleNameToShort[t.name],n,e);a.setLaFuncCache(c,i)}))},t.prototype.lookAheadBuilderForOptional=function(t,e,n){return ze(t,e,n)},t.prototype.lookAheadBuilderForAlternatives=function(t,e,n,r){return He(t,e,n,r)},t.prototype.getKeyForAutomaticLookahead=function(t,e){var n=this.getLastExplicitRuleShortName();return Xn(n,t,e)},t.prototype.getLaFuncFromCache=function(t){},t.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},t.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},t.prototype.setLaFuncCache=function(t,e){},t.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},t.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},t}();function Qn(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset===!0&&(t.endOffset=e.endOffset)}function Zn(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset===!0&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function tr(t,e,n){void 0===t.children[n]?t.children[n]=[e]:t.children[n].push(e)}function er(t,e,n){void 0===t.children[e]?t.children[e]=[n]:t.children[e].push(n)}function nr(t){return ir(t.constructor)}var rr,or="name";function ir(t){var e=t.name;return e||"anonymous"}function ar(t,e){var n=Object.getOwnPropertyDescriptor(t,or);return!(!(0,o.b0)(n)&&!n.configurable)&&(Object.defineProperty(t,or,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}function cr(t,e){for(var n=(0,o.HP)(t),r=n.length,i=0;i<r;i++)for(var a=n[i],c=t[a],s=c.length,u=0;u<s;u++){var f=c[u];void 0===f.tokenTypeIdx&&this[f.name](f.children,e)}}function sr(t,e){var n=function(){};ar(n,t+"BaseSemantics");var r={visit:function(t,e){if((0,o.cy)(t)&&(t=t[0]),!(0,o.b0)(t))return this[t.name](t.children,e)},validateVisitor:function(){var t=fr(this,e);if(!(0,o.Im)(t)){var n=(0,o.Tj)(t,(function(t){return t.msg}));throw Error("Errors Detected in CST Visitor <"+ir(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=e,n}function ur(t,e,n){var r=function(){};ar(r,t+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return(0,o.jJ)(e,(function(t){i[t]=cr})),r.prototype=i,r.prototype.constructor=r,r}function fr(t,e){var n=lr(t,e),r=pr(t,e);return n.concat(r)}function lr(t,e){var n=(0,o.Tj)(e,(function(e){if(!(0,o.Tn)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+ir(t.constructor)+" CST Visitor.",type:rr.MISSING_METHOD,methodName:e}}));return(0,o.oE)(n)}(function(t){t[t["REDUNDANT_METHOD"]=0]="REDUNDANT_METHOD",t[t["MISSING_METHOD"]=1]="MISSING_METHOD"})(rr||(rr={}));var hr=["constructor","visit","validateVisitor"];function pr(t,e){var n=[];for(var r in t)!(0,o.Tn)(t[r])||(0,o.gR)(hr,r)||(0,o.gR)(e,r)||n.push({msg:"Redundant visitor method: <"+r+"> on "+ir(t.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\n",type:rr.REDUNDANT_METHOD,methodName:r});return n}var dr=function(){function t(){}return t.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,o.zy)(t,"nodeLocationTracking")?t.nodeLocationTracking:kr.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Zn,this.setNodeLocationFromNode=Zn,this.cstPostRule=o.tE,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Qn,this.setNodeLocationFromNode=Qn,this.cstPostRule=o.tE,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.tE,this.setNodeLocationFromNode=o.tE,this.cstPostRule=o.tE,this.setInitialNodeLocation=o.tE}else this.cstInvocationStateUpdate=o.tE,this.cstFinallyStateUpdate=o.tE,this.cstPostTerminal=o.tE,this.cstPostNonTerminal=o.tE,this.cstPostRule=o.tE},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstInvocationStateUpdate=function(t,e){var n={name:t,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},t.prototype.cstPostRuleFull=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset===!0?(n.endOffset=e.endOffset,n.endLine=e.endLine,n.endColumn=e.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset===!0?n.endOffset=e.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(t,e){var n=this.CST_STACK[this.CST_STACK.length-1];tr(n,e,t),this.setNodeLocationFromToken(n.location,e)},t.prototype.cstPostNonTerminal=function(t,e){var n=this.CST_STACK[this.CST_STACK.length-1];er(n,e,t),this.setNodeLocationFromNode(n.location,t.location)},t.prototype.getBaseCstVisitorConstructor=function(){if((0,o.b0)(this.baseCstVisitorConstructor)){var t=sr(this.className,(0,o.HP)(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,o.b0)(this.baseCstVisitorWithDefaultsConstructor)){var t=ur(this.className,(0,o.HP)(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},t}(),mr=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):xr},t.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?xr:this.tokVector[e]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(t){this.currIdx=t},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),gr=function(){function t(){}return t.prototype.ACTION=function(t){return t.call(this)},t.prototype.consume=function(t,e,n){return this.consumeInternal(e,t,n)},t.prototype.subrule=function(t,e,n){return this.subruleInternal(e,t,n)},t.prototype.option=function(t,e){return this.optionInternal(e,t)},t.prototype.or=function(t,e){return this.orInternal(e,t)},t.prototype.many=function(t,e){return this.manyInternal(t,e)},t.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},t.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},t.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},t.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},t.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},t.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},t.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},t.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},t.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},t.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},t.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},t.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},t.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},t.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},t.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},t.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},t.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},t.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},t.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},t.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},t.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},t.prototype.OPTION=function(t){return this.optionInternal(t,0)},t.prototype.OPTION1=function(t){return this.optionInternal(t,1)},t.prototype.OPTION2=function(t){return this.optionInternal(t,2)},t.prototype.OPTION3=function(t){return this.optionInternal(t,3)},t.prototype.OPTION4=function(t){return this.optionInternal(t,4)},t.prototype.OPTION5=function(t){return this.optionInternal(t,5)},t.prototype.OPTION6=function(t){return this.optionInternal(t,6)},t.prototype.OPTION7=function(t){return this.optionInternal(t,7)},t.prototype.OPTION8=function(t){return this.optionInternal(t,8)},t.prototype.OPTION9=function(t){return this.optionInternal(t,9)},t.prototype.OR=function(t){return this.orInternal(t,0)},t.prototype.OR1=function(t){return this.orInternal(t,1)},t.prototype.OR2=function(t){return this.orInternal(t,2)},t.prototype.OR3=function(t){return this.orInternal(t,3)},t.prototype.OR4=function(t){return this.orInternal(t,4)},t.prototype.OR5=function(t){return this.orInternal(t,5)},t.prototype.OR6=function(t){return this.orInternal(t,6)},t.prototype.OR7=function(t){return this.orInternal(t,7)},t.prototype.OR8=function(t){return this.orInternal(t,8)},t.prototype.OR9=function(t){return this.orInternal(t,9)},t.prototype.MANY=function(t){this.manyInternal(0,t)},t.prototype.MANY1=function(t){this.manyInternal(1,t)},t.prototype.MANY2=function(t){this.manyInternal(2,t)},t.prototype.MANY3=function(t){this.manyInternal(3,t)},t.prototype.MANY4=function(t){this.manyInternal(4,t)},t.prototype.MANY5=function(t){this.manyInternal(5,t)},t.prototype.MANY6=function(t){this.manyInternal(6,t)},t.prototype.MANY7=function(t){this.manyInternal(7,t)},t.prototype.MANY8=function(t){this.manyInternal(8,t)},t.prototype.MANY9=function(t){this.manyInternal(9,t)},t.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},t.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},t.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},t.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},t.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},t.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},t.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},t.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},t.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},t.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},t.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},t.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},t.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},t.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},t.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},t.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},t.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},t.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},t.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},t.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},t.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},t.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},t.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},t.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},t.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},t.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},t.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},t.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},t.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},t.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},t.prototype.RULE=function(t,e,n){if(void 0===n&&(n=Pr),(0,o.gR)(this.definedRulesNames,t)){var r=Ae.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:r,type:_r.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var a=this.defineRule(t,e,n);return this[t]=a,a},t.prototype.OVERRIDE_RULE=function(t,e,n){void 0===n&&(n=Pr);var r=[];r=r.concat(fn(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,r);var o=this.defineRule(t,e,n);return this[t]=o,o},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return t.apply(this,e),!0}catch(r){if(Un(r))return!1;throw r}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return Zt((0,o.zu)(this.gastProductionsCache))},t}(),Er=function(){function t(){}return t.prototype.initRecognizerEngine=function(t,e){if(this.className=nr(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=at,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,o.zy)(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,o.cy)(t)){if((0,o.Im)(t))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"===typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,o.cy)(t))this.tokensMap=(0,o.TS)(t,(function(t,e){return t[e.name]=e,t}),{});else if((0,o.zy)(t,"modes")&&(0,o.Si)((0,o.Bq)((0,o.zu)(t.modes)),yt)){var n=(0,o.Bq)((0,o.zu)(t.modes)),r=(0,o.sb)(n);this.tokensMap=(0,o.TS)(r,(function(t,e){return t[e.name]=e,t}),{})}else{if(!(0,o.Gv)(t))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,o.lR)(t)}this.tokensMap["EOF"]=Ft;var i=(0,o.Si)((0,o.zu)(t),(function(t){return(0,o.Im)(t.categoryMatches)}));this.tokenMatcher=i?at:it,ut((0,o.zu)(this.tokensMap))},t.prototype.defineRule=function(t,e,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var r,i=(0,o.zy)(n,"resyncEnabled")?n.resyncEnabled:Pr.resyncEnabled,a=(0,o.zy)(n,"recoveryValueFunc")?n.recoveryValueFunc:Pr.recoveryValueFunc,c=this.ruleShortNameIdx<<Gn+Hn;function s(t){try{if(!0===this.outputCst){e.apply(this,t);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return e.apply(this,t)}catch(r){return this.invokeRuleCatch(r,i,a)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=t,this.fullRuleNameToShort[t]=c,r=function(e,n){return void 0===e&&(e=0),this.ruleInvocationStateUpdate(c,t,e),s.call(this,n)};var u="ruleName";return r[u]=t,r["originalGrammarAction"]=e,r},t.prototype.invokeRuleCatch=function(t,e,n){var r=1===this.RULE_STACK.length,o=e&&!this.isBackTracking()&&this.recoveryEnabled;if(Un(t)){var i=t;if(o){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a)){if(i.resyncedTokens=this.reSyncTo(a),this.outputCst){var c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}return n()}if(this.outputCst){c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,i.partialCstResult=c}throw i}if(r)return this.moveToTerminatedState(),n();throw i}throw t},t.prototype.optionInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Yn,e);return this.optionInternalLogic(t,e,n)},t.prototype.optionInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,o=t.GATE,void 0!==o){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=t;if(!0===a.call(this))return r.call(this)},t.prototype.atLeastOneInternal=function(t,e){var n=this.getKeyForAutomaticLookahead($n,t);return this.atLeastOneInternalLogic(t,e,n)},t.prototype.atLeastOneInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,o=e.GATE,void 0!==o){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=e;if(!0!==a.call(this))throw this.raiseEarlyExitException(t,Fe.REPETITION_MANDATORY,e.ERR_MSG);var s=this.doSingleRepetition(r);while(!0===a.call(this)&&!0===s)s=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],a,$n,t,xe)},t.prototype.atLeastOneSepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Kn,t);this.atLeastOneSepFirstInternalLogic(t,e,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(t,e,n){var r=this,o=e.DEF,i=e.SEP,a=this.getLaFuncFromCache(n);if(!0!==a.call(this))throw this.raiseEarlyExitException(t,Fe.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG);o.call(this);var c=function(){return r.tokenMatcher(r.LA(1),i)};while(!0===this.tokenMatcher(this.LA(1),i))this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,c,o,_e],c,Kn,t,_e)},t.prototype.manyInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(Wn,t);return this.manyInternalLogic(t,e,n)},t.prototype.manyInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,o=e.GATE,void 0!==o){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=e;var s=!0;while(!0===a.call(this)&&!0===s)s=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],a,Wn,t,Ue,s)},t.prototype.manySepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(qn,t);this.manySepFirstInternalLogic(t,e,n)},t.prototype.manySepFirstInternalLogic=function(t,e,n){var r=this,o=e.DEF,i=e.SEP,a=this.getLaFuncFromCache(n);if(!0===a.call(this)){o.call(this);var c=function(){return r.tokenMatcher(r.LA(1),i)};while(!0===this.tokenMatcher(this.LA(1),i))this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,c,o,Le],c,qn,t,Le)}},t.prototype.repetitionSepSecondInternal=function(t,e,n,r,o){while(n())this.CONSUME(e),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,o],n,Kn,t,o)},t.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();t.call(this);var n=this.getLexerPosition();return n>e},t.prototype.orInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(zn,e),r=(0,o.cy)(t)?t:t.DEF,i=this.getLaFuncFromCache(n),a=i.call(this,r);if(void 0!==a){var c=r[a];return c.ALT.call(this)}this.raiseNoAltException(e,t.ERR_MSG)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new kn(e,t))}},t.prototype.subruleInternal=function(t,e,n){var r;try{var o=void 0!==n?n.ARGS:void 0;return r=t.call(this,e,o),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:t.ruleName),r}catch(i){this.subruleInternalError(i,n,t.ruleName)}},t.prototype.subruleInternalError=function(t,e,n){throw Un(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:n),delete t.partialCstResult),t},t.prototype.consumeInternal=function(t,e,n){var r;try{var o=this.LA(1);!0===this.tokenMatcher(o,t)?(this.consumeToken(),r=o):this.consumeInternalError(t,o,n)}catch(i){r=this.consumeInternalRecovery(t,e,i)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:t.name,r),r},t.prototype.consumeInternalError=function(t,e,n){var r,o=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new xn(r,e,o))},t.prototype.consumeInternalRecovery=function(t,e,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(o){throw o.name===Fn?n:o}},t.prototype.saveRecogState=function(){var t=this.errors,e=(0,o.T9)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(t,e,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},t.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},t.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Ft)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),vr=function(){function t(){}return t.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,o.zy)(t,"errorMessageProvider")?t.errorMessageProvider:kr.errorMessageProvider},t.prototype.SAVE_ERROR=function(t){if(Un(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,o.T9)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return(0,o.T9)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),t.prototype.raiseEarlyExitException=function(t,e,n){for(var r=this.getCurrRuleFullName(),o=this.getGAstProductions()[r],i=Qe(t,o,e,this.maxLookahead),a=i[0],c=[],s=1;s<=this.maxLookahead;s++)c.push(this.LA(s));var u=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:c,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Pn(u,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(t,e){for(var n=this.getCurrRuleFullName(),r=this.getGAstProductions()[n],o=Je(t,r,this.maxLookahead),i=[],a=1;a<=this.maxLookahead;a++)i.push(this.LA(a));var c=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:i,previous:c,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new _n(s,this.LA(1),c))},t}(),yr=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(t,e){var n=this.gastProductionsCache[t];if((0,o.b0)(n))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return Pe([n],e,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(t){var e=(0,o.$1)(t.ruleStack),n=this.getGAstProductions(),r=n[e],i=new Ce(r,t).startWalking();return i},t}(),Nr={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Nr);var Tr=!0,Rr=Math.pow(2,Hn)-1,Ar=Pt({name:"RECORDING_PHASE_TOKEN",pattern:At.NA});ut([Ar]);var Mr=Dt(Ar,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(Mr);var Or={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}},wr=function(){function t(){}return t.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var e=function(e){var n=e>0?e:"";t["CONSUME"+n]=function(t,n){return this.consumeInternalRecord(t,e,n)},t["SUBRULE"+n]=function(t,n){return this.subruleInternalRecord(t,e,n)},t["OPTION"+n]=function(t){return this.optionInternalRecord(t,e)},t["OR"+n]=function(t){return this.orInternalRecord(t,e)},t["MANY"+n]=function(t){this.manyInternalRecord(e,t)},t["MANY_SEP"+n]=function(t){this.manySepFirstInternalRecord(e,t)},t["AT_LEAST_ONE"+n]=function(t){this.atLeastOneInternalRecord(e,t)},t["AT_LEAST_ONE_SEP"+n]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}},n=0;n<10;n++)e(n);t["consume"]=function(t,e,n){return this.consumeInternalRecord(e,t,n)},t["subrule"]=function(t,e,n){return this.subruleInternalRecord(e,t,n)},t["option"]=function(t,e){return this.optionInternalRecord(e,t)},t["or"]=function(t,e){return this.orInternalRecord(e,t)},t["many"]=function(t,e){this.manyInternalRecord(t,e)},t["atLeastOne"]=function(t,e){this.atLeastOneInternalRecord(t,e)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD}))},t.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var e=0;e<10;e++){var n=e>0?e:"";delete t["CONSUME"+n],delete t["SUBRULE"+n],delete t["OPTION"+n],delete t["OR"+n],delete t["MANY"+n],delete t["MANY_SEP"+n],delete t["AT_LEAST_ONE"+n],delete t["AT_LEAST_ONE_SEP"+n]}delete t["consume"],delete t["subrule"],delete t["option"],delete t["or"],delete t["many"],delete t["atLeastOne"],delete t.ACTION,delete t.BACKTRACK,delete t.LA}))},t.prototype.ACTION_RECORD=function(t){},t.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},t.prototype.LA_RECORD=function(t){return xr},t.prototype.topLevelRuleRecord=function(t,e){try{var n=new zt({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),e.call(this),this.recordingProdStack.pop(),n}catch(r){if(!0!==r.KNOWN_RECORDER_ERROR)try{r.message=r.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(o){throw r}throw r}},t.prototype.optionInternalRecord=function(t,e){return Ir.call(this,Wt,t,e)},t.prototype.atLeastOneInternalRecord=function(t,e){Ir.call(this,$t,e,t)},t.prototype.atLeastOneSepFirstInternalRecord=function(t,e){Ir.call(this,qt,e,t,Tr)},t.prototype.manyInternalRecord=function(t,e){Ir.call(this,Kt,e,t)},t.prototype.manySepFirstInternalRecord=function(t,e){Ir.call(this,Xt,e,t,Tr)},t.prototype.orInternalRecord=function(t,e){return Sr.call(this,t,e)},t.prototype.subruleInternalRecord=function(t,e,n){if(br(e),!t||!1===(0,o.zy)(t,"ruleName")){var r=new Error("<SUBRULE"+Cr(e)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=(0,o.se)(this.recordingProdStack),a=t["ruleName"],c=new Ht({idx:e,nonTerminalName:a,referencedRule:void 0});return i.definition.push(c),this.outputCst?Or:Nr},t.prototype.consumeInternalRecord=function(t,e,n){if(br(e),!mt(t)){var r=new Error("<CONSUME"+Cr(e)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=(0,o.se)(this.recordingProdStack),a=new Qt({idx:e,terminalType:t});return i.definition.push(a),Mr},t}();function Ir(t,e,n,r){void 0===r&&(r=!1),br(n);var i=(0,o.se)(this.recordingProdStack),a=(0,o.Tn)(e)?e:e.DEF,c=new t({definition:[],idx:n});return r&&(c.separator=e.SEP),(0,o.zy)(e,"MAX_LOOKAHEAD")&&(c.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(c),a.call(this),i.definition.push(c),this.recordingProdStack.pop(),Nr}function Sr(t,e){var n=this;br(e);var r=(0,o.se)(this.recordingProdStack),i=!1===(0,o.cy)(t),a=!1===i?t:t.DEF,c=new Jt({definition:[],idx:e,ignoreAmbiguities:i&&!0===t.IGNORE_AMBIGUITIES});(0,o.zy)(t,"MAX_LOOKAHEAD")&&(c.maxLookahead=t.MAX_LOOKAHEAD);var s=(0,o.zN)(a,(function(t){return(0,o.Tn)(t.GATE)}));return c.hasPredicates=s,r.definition.push(c),(0,o.jJ)(a,(function(t){var e=new Yt({definition:[]});c.definition.push(e),(0,o.zy)(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:(0,o.zy)(t,"GATE")&&(e.ignoreAmbiguities=!0),n.recordingProdStack.push(e),t.ALT.call(n),n.recordingProdStack.pop()})),Nr}function Cr(t){return 0===t?"":""+t}function br(t){if(t<0||t>Rr){var e=new Error("Invalid DSL Method idx value: <"+t+">\n\tIdx value must be a none negative value smaller than "+(Rr+1));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Ur=function(){function t(){}return t.prototype.initPerformanceTracer=function(t){if((0,o.zy)(t,"traceInitPerf")){var e=t.traceInitPerf,n="number"===typeof e;this.traceInitMaxIdent=n?e:1/0,this.traceInitPerf=n?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=kr.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+t+">");var r=(0,o.O1)(e),i=r.time,a=r.value,c=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,a}return e()},t}(),Lr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xr=Dt(Ft,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(xr);var _r,kr=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Te,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Pr=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function Br(t){return void 0===t&&(t=void 0),function(){return t}}(function(t){t[t["INVALID_RULE_NAME"]=0]="INVALID_RULE_NAME",t[t["DUPLICATE_RULE_NAME"]=1]="DUPLICATE_RULE_NAME",t[t["INVALID_RULE_OVERRIDE"]=2]="INVALID_RULE_OVERRIDE",t[t["DUPLICATE_PRODUCTIONS"]=3]="DUPLICATE_PRODUCTIONS",t[t["UNRESOLVED_SUBRULE_REF"]=4]="UNRESOLVED_SUBRULE_REF",t[t["LEFT_RECURSION"]=5]="LEFT_RECURSION",t[t["NONE_LAST_EMPTY_ALT"]=6]="NONE_LAST_EMPTY_ALT",t[t["AMBIGUOUS_ALTS"]=7]="AMBIGUOUS_ALTS",t[t["CONFLICT_TOKENS_RULES_NAMESPACE"]=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t["INVALID_TOKEN_NAME"]=9]="INVALID_TOKEN_NAME",t[t["NO_NON_EMPTY_LOOKAHEAD"]=10]="NO_NON_EMPTY_LOOKAHEAD",t[t["AMBIGUOUS_PREFIX_ALTS"]=11]="AMBIGUOUS_PREFIX_ALTS",t[t["TOO_MANY_ALTS"]=12]="TOO_MANY_ALTS"})(_r||(_r={}));var Fr=function(){function t(t,e){this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;if(n.initErrorHandler(e),n.initLexerAdapter(),n.initLooksAhead(e),n.initRecognizerEngine(t,e),n.initRecoverable(e),n.initTreeBuilder(e),n.initContentAssist(),n.initGastRecorder(e),n.initPerformanceTracer(e),(0,o.zy)(e,"ignoredIssues"))throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\tSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\tFor further details.");this.skipValidations=(0,o.zy)(e,"skipValidations")?e.skipValidations:kr.skipValidations}return t.performSelfAnalysis=function(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.\t\nUse the **instance** method with the same name instead.")},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",(function(){(0,o.Bl)(e)})),e.TRACE_INIT("Grammar Recording",(function(){try{e.enableRecording(),(0,o.jJ)(e.definedRulesNames,(function(t){var n=e[t],r=n["originalGrammarAction"],o=void 0;e.TRACE_INIT(t+" Rule",(function(){o=e.topLevelRuleRecord(t,r)})),e.gastProductionsCache[t]=o}))}finally{e.disableRecording()}}));var i=[];if(e.TRACE_INIT("Grammar Resolving",(function(){i=Rn({rules:(0,o.zu)(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)})),e.TRACE_INIT("Grammar Validations",(function(){if((0,o.Im)(i)&&!1===e.skipValidations){var t=An({rules:(0,o.zu)(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:(0,o.zu)(e.tokensMap),errMsgProvider:Ae,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,t)}})),(0,o.Im)(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",(function(){var t=ye((0,o.zu)(e.gastProductionsCache));e.resyncFollows=t})),e.TRACE_INIT("ComputeLookaheadFunctions",(function(){e.preComputeLookaheadFunctions((0,o.zu)(e.gastProductionsCache))}))),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,o.Im)(e.definitionErrors))throw n=(0,o.Tj)(e.definitionErrors,(function(t){return t.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();(0,o.XJ)(Fr,[jn,Jn,dr,mr,Er,gr,vr,yr,wr,Ur]);var Dr=function(t){function e(e,n){void 0===n&&(n=kr);var r=this,i=(0,o.lR)(n);return i.outputCst=!0,r=t.call(this,e,i)||this,r}return Lr(e,t),e}(Fr),jr=function(t){function e(e,n){void 0===n&&(n=kr);var r=this,i=(0,o.lR)(n);return i.outputCst=!1,r=t.call(this,e,i)||this,r}return Lr(e,t),e}(Fr);function Vr(t,e){var n=void 0===e?{}:e,o=n.resourceBase,i=void 0===o?"https://unpkg.com/chevrotain@"+r+"/diagrams/":o,a=n.css,c=void 0===a?"https://unpkg.com/chevrotain@"+r+"/diagrams/diagrams.css":a,s='\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n',u="\n<link rel='stylesheet' href='"+c+"'>\n",f="\n<script src='"+i+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+i+"src/diagrams_builder.js'><\/script>\n<script src='"+i+"src/diagrams_behavior.js'><\/script>\n<script src='"+i+"src/main.js'><\/script>\n",l='\n<div id="diagrams" align="center"></div>    \n',h="\n<script>\n    window.serializedGrammar = "+JSON.stringify(t,null,"  ")+";\n<\/script>\n",p='\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n';return s+u+f+l+h+p}var Gr="\n";function Hr(t){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+Yr(t)+"\n    \nreturn {\n    "+t.name+": "+t.name+" \n}\n}));\n"}function zr(t){return"    \n"+Yr(t)+"\nreturn new "+t.name+"(tokenVocabulary, config)    \n"}function Yr(t){var e="\nfunction "+t.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+Wr(t.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+t.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+t.name+".prototype.constructor = "+t.name+"    \n    ";return e}function Wr(t){var e=(0,o.Tj)(t,(function(t){return $r(t,1)}));return e.join("\n")}function $r(t,e){var n=no(e,'$.RULE("'+t.name+'", function() {')+Gr;return n+=eo(t.definition,e+1),n+=no(e+1,"})")+Gr,n}function qr(t,e){var n=t.terminalType.name;return no(e,"$.CONSUME"+t.idx+"(this.tokensMap."+n+")"+Gr)}function Kr(t,e){return no(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")"+Gr)}function Xr(t,e){var n=no(e,"$.OR"+t.idx+"([")+Gr,r=(0,o.Tj)(t.definition,(function(t){return Jr(t,e+1)}));return n+=r.join(","+Gr),n+=Gr+no(e,"])"+Gr),n}function Jr(t,e){var n=no(e,"{")+Gr;return n+=no(e+1,"ALT: function() {")+Gr,n+=eo(t.definition,e+1),n+=no(e+1,"}")+Gr,n+=no(e,"}"),n}function Qr(t,e){if(t instanceof Ht)return Kr(t,e);if(t instanceof Wt)return Zr("OPTION",t,e);if(t instanceof $t)return Zr("AT_LEAST_ONE",t,e);if(t instanceof qt)return Zr("AT_LEAST_ONE_SEP",t,e);if(t instanceof Xt)return Zr("MANY_SEP",t,e);if(t instanceof Kt)return Zr("MANY",t,e);if(t instanceof Jt)return Xr(t,e);if(t instanceof Qt)return qr(t,e);if(t instanceof Yt)return eo(t.definition,e);throw Error("non exhaustive match")}function Zr(t,e,n){var r=no(n,"$."+(t+e.idx)+"(");return e.separator?(r+="{"+Gr,r+=no(n+1,"SEP: this.tokensMap."+e.separator.name)+","+Gr,r+="DEF: "+to(e.definition,n+2)+Gr,r+=no(n,"}")+Gr):r+=to(e.definition,n+1),r+=no(n,")")+Gr,r}function to(t,e){var n="function() {"+Gr;return n+=eo(t,e),n+=no(e,"}")+Gr,n}function eo(t,e){var n="";return(0,o.jJ)(t,(function(t){n+=Qr(t,e+1)})),n}function no(t,e){var n=Array(4*t+1).join(" ");return n+e}function ro(t){var e=zr({name:t.name,rules:t.rules}),r=new Function("tokenVocabulary","config","chevrotain",e);return function(e){return r(t.tokenVocabulary,e,n(91198))}}function oo(t){return Hr({name:t.name,rules:t.rules})}function io(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}var ao=function(){function t(){throw new Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.\t\nSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}return t}()},58340:function(t,e,n){"use strict";function r(t){return t&&0===t.length}function o(t){return void 0===t||null===t?[]:Object.keys(t)}function i(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}function a(t,e){for(var n=[],r=o(t),i=0;i<r.length;i++){var a=r[i];n.push(e.call(null,t[a],a))}return n}function c(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e.call(null,t[r],r));return n}function s(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?e=e.concat(s(r)):e.push(r)}return e}function u(t){return r(t)?void 0:t[0]}function f(t){var e=t&&t.length;return e?t[e-1]:void 0}function l(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.call(null,t[n],n);else{if(!L(t))throw Error("non exhaustive match");var r=o(t);for(n=0;n<r.length;n++){var i=r[n],a=t[i];e.call(null,a,i)}}}function h(t){return"string"===typeof t}function p(t){return void 0===t}function d(t){return t instanceof Function}function m(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function g(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function E(t,e){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function v(t,e){return E(t,(function(t){return!e(t)}))}function y(t,e){for(var n=Object.keys(t),r={},o=0;o<n.length;o++){var i=n[o],a=t[i];e(a)&&(r[i]=a)}return r}function N(t,e){return!!L(t)&&t.hasOwnProperty(e)}function T(t,e){return void 0!==M(t,(function(t){return t===e}))}function R(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}function A(t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function M(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e.call(null,r))return r}}function O(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function w(t,e,n){for(var r=Array.isArray(t),a=r?t:i(t),c=r?[]:o(t),s=n,u=0;u<a.length;u++)s=e.call(null,s,a[u],r?u:c[u]);return s}function I(t){return v(t,(function(t){return null===t||void 0===t}))}function S(t,e){void 0===e&&(e=function(t){return t});var n=[];return w(t,(function(t,r){var o=e(r);return T(n,o)?t:(n.push(o),t.concat(r))}),[])}function C(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[null],o=r.concat(e);return Function.bind.apply(t,o)}function b(t){return Array.isArray(t)}function U(t){return t instanceof RegExp}function L(t){return t instanceof Object}function x(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n))return!1;return!0}function _(t,e){return v(t,(function(t){return T(e,t)}))}function k(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function P(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function B(t,e){var n=R(t);return n.sort((function(t,n){return e(t)-e(n)})),n}function F(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<t.length;r++)n[t[r]]=e[r];return n}function D(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=o(i),c=0;c<a.length;c++){var s=a[c];t[s]=i[s]}return t}function j(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=o(i),c=0;c<a.length;c++){var s=a[c];N(t,s)||(t[s]=i[s])}return t}function V(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return j.apply(null,[{}].concat(t))}function G(t,e){var n={};return l(t,(function(t){var r=e(t),o=n[r];o?o.push(t):n[r]=[t]})),n}function H(t,e){for(var n=A(t),r=o(e),i=0;i<r.length;i++){var a=r[i],c=e[a];n[a]=c}return n}function z(){}function Y(t){return t}function W(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(void 0!==r?r:void 0)}return e}function $(t){console&&console.error&&console.error("Error: "+t)}function q(t){console&&console.warn&&console.warn("Warning: "+t)}function K(){return"function"===typeof Map}function X(t,e){e.forEach((function(e){var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(r){if("constructor"!==r){var o=Object.getOwnPropertyDescriptor(n,r);o&&(o.get||o.set)?Object.defineProperty(t.prototype,r,o):t.prototype[r]=e.prototype[r]}}))}))}function J(t){function e(){}e.prototype=t;var n=new e;function r(){return typeof n.bar}return r(),r(),t}function Q(t){return t[t.length-1]}function Z(t){var e=(new Date).getTime(),n=t(),r=(new Date).getTime(),o=r-e;return{time:o,value:n}}n.d(e,{$1:function(){return u},$z:function(){return G},Bl:function(){return J},Bq:function(){return s},Gv:function(){return L},HP:function(){return o},HV:function(){return f},I6:function(){return M},Im:function(){return r},JW:function(){return O},Kg:function(){return h},LG:function(){return a},NT:function(){return V},O1:function(){return Z},Si:function(){return x},T9:function(){return R},TS:function(){return w},Tj:function(){return c},Tn:function(){return d},Up:function(){return y},VS:function(){return W},XJ:function(){return X},Zi:function(){return $},b0:function(){return p},cy:function(){return b},gR:function(){return T},gc:function(){return g},gd:function(){return U},gv:function(){return m},h1:function(){return H},iv:function(){return _},jJ:function(){return l},kp:function(){return D},ku:function(){return v},lR:function(){return A},oE:function(){return I},pb:function(){return E},qh:function(){return P},rF:function(){return K},sb:function(){return S},se:function(){return Q},tE:function(){return z},x5:function(){return q},zK:function(){return Y},zN:function(){return k},zu:function(){return i},zy:function(){return N}})},89442:function(t){class e{}function n(t){let e="",n=t.length-1;while(n>=0)e+=t.charAt(n--);return e}function r(t,e){let n="";while(n.length<e)n+=t;return n}function o(t,e){let n=""+t;return n.length>=e?n:r("0",e-n.length)+n}function i(t,e){let n=""+t;return n.length>=e?n:r(" ",e-n.length)+n}function a(t,e){let n=""+t;return n.length>=e?n:n+r(" ",e-n.length)}function c(t,e){let n=""+Math.round(t);return n.length>=e?n:r("0",e-n.length)+n}function s(t,e){let n=""+t;return n.length>=e?n:r("0",e-n.length)+n}e.version="0.10.3";const u=Math.pow(2,32);function f(t,e){if(t>u||t<-u)return c(t,e);const n=Math.round(t);return s(n,e)}function l(t,e){return e=e||0,t.length>=7+e&&103===(32|t.charCodeAt(e))&&101===(32|t.charCodeAt(e+1))&&110===(32|t.charCodeAt(e+2))&&101===(32|t.charCodeAt(e+3))&&114===(32|t.charCodeAt(e+4))&&97===(32|t.charCodeAt(e+5))&&108===(32|t.charCodeAt(e+6))}const h=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t[65535]="General"}const m={};function g(t,e,n){const r=t<0?-1:1;let o=t*r,i=0,a=1,c=0,s=1,u=0,f=0,l=Math.floor(o);while(u<e){if(l=Math.floor(o),c=l*a+i,f=l*u+s,o-l<5e-8)break;o=1/(o-l),i=a,a=c,s=u,u=f}if(f>e&&(u>e?(f=s,c=i):(f=u,c=a)),!n)return[0,r*c,f];const h=Math.floor(r*c/f);return[h,r*c-h*f,f]}function E(t,e,n){if(t>2958465||t<0)return null;let r=0|t,o=Math.floor(86400*(t-r)),i=0,a=[];const c={D:r,T:o,u:86400*(t-r)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,86400===++o&&(c.T=o=0,++r,++c.D)),60===r)a=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)a=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;const t=new Date(1900,0,1);t.setDate(t.getDate()+r-1),a=[t.getFullYear(),t.getMonth()+1,t.getDate()],i=t.getDay(),r<60&&(i=(i+6)%7),n&&(i=O(t,a))}return c.y=a[0],c.m=a[1],c.d=a[2],c.S=o%60,o=Math.floor(o/60),c.M=o%60,o=Math.floor(o/60),c.H=o,c.q=i,c}d(m),e.parse_date_code=E;const v=new Date(1899,11,31,0,0,0),y=v.getTime(),N=new Date(1900,2,1,0,0,0);function T(t,e){let n=t.getTime();return e?n-=1262304e5:t>=N&&(n+=864e5),(n-(y+6e4*(t.getTimezoneOffset()-v.getTimezoneOffset())))/864e5}function R(t){return t.toString(10)}e._general_int=R;const A=function(){const t=/\.(\d*[1-9])0+$/,e=/\.0*$/,n=/\.(\d*[1-9])0+/,r=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function i(t){const e=t<0?12:11;let n=s(t.toFixed(12));return n.length<=e?n:(n=t.toPrecision(10),n.length<=e?n:t.toExponential(5))}function a(e){let n=e.toFixed(11).replace(t,".$1");return n.length>(e<0?12:11)&&(n=e.toPrecision(6)),n}function c(t){for(let e=0;e!==t.length;++e)if(101===(32|t.charCodeAt(e)))return t.replace(n,".$1").replace(r,"E").replace("e","E").replace(o,"$10$2");return t}function s(n){return n.indexOf(".")>-1?n.replace(e,"").replace(t,".$1"):n}return function(t){let e,n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return e=n>=-4&&n<=-1?t.toPrecision(10+n):Math.abs(n)<=9?i(t):10===n?t.toFixed(10).substr(0,12):a(t),s(c(e))}}();function M(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?R(t):A(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return B(14,T(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function O(){return 0}function w(t,e,n,r){let i,a="",c=0,s=0,u=n.y,f=0;switch(t){case 98:u=n.y+543;case 121:switch(e.length){case 1:case 2:i=u%100,f=2;break;default:i=u%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:i=n.m,f=e.length;break;case 3:return p[n.m-1][1];case 5:return p[n.m-1][0];default:return p[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:i=n.d,f=e.length;break;case 3:return h[n.q][0];default:return h[n.q][1]}break;case 104:switch(e.length){case 1:case 2:i=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:i=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:i=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!==e&&"ss"!==e&&".0"!==e&&".00"!==e&&".000"!==e)throw"bad second format: "+e;return 0!==n.u||"s"!==e&&"ss"!==e?(s=r>=2?3===r?1e3:100:1===r?10:1,c=Math.round(s*(n.S+n.u)),c>=60*s&&(c=0),"s"===e?0===c?"0":""+c/s:(a=o(c,2+r),"ss"===e?a.substr(0,2):"."+a.substr(2,e.length-1))):o(n.S,e.length);case 90:switch(e){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=3===e.length?1:2;break;case 101:i=u,f=1}return f>0?o(i,f):""}function I(t){const e=3;if(t.length<=e)return t;let n=t.length%e,r=t.substr(0,n);for(;n!==t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}e._general_num=A,e._general=M;const S=function(){const t=/%/g;function e(e,n,o){const i=n.replace(t,""),a=n.length-i.length;return S(e,i,o*Math.pow(10,2*a))+r("%",a)}function c(t,e,n){let r=e.length-1;while(44===e.charCodeAt(r-1))--r;return S(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function s(t,e){let n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===e)return"0.0E+0";if(e<0)return"-"+s(t,-e);let o=t.indexOf(".");-1===o&&(o=t.indexOf("E"));let i=Math.floor(Math.log(e)*Math.LOG10E)%o;if(i<0&&(i+=o),n=(e/Math.pow(10,i)).toPrecision(r+1+(o+i)%o),-1===n.indexOf("e")){const t=Math.floor(Math.log(e)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i);while("0."===n.substr(0,2))n=n.charAt(0)+n.substr(2,o)+"."+n.substr(2+o),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,n,r){return e+n+r.substr(0,(o+i)%o)+"."+r.substr(i)+"E"}))}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}const u=/# (\?+)( ?)\/( ?)(\d+)/;function l(t,e,n){const a=parseInt(t[4],10),c=Math.round(e*a),s=Math.floor(c/a);let u=c-s*a,f=a;return n+(0===s?"":""+s)+" "+(0===u?r(" ",t[1].length+1+t[4].length):i(u,t[1].length)+t[2]+"/"+t[3]+o(f,t[4].length))}function h(t,e,n){return n+(0===e?"":""+e)+r(" ",t[1].length+2+t[4].length)}const p=/^#*0*\.([0#]+)/,d=/\).*[0#]/,m=/\(###\) ###\\?-####/;function E(t){let e,n="";for(let r=0;r!==t.length;++r)switch(e=t.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function v(t,e){const n=Math.pow(10,e);return""+Math.round(t*n)/n}function y(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}function N(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function T(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}function R(t,h,A){if(40===t.charCodeAt(0)&&!h.match(d)){const t=h.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return A>=0?R("n",t,A):"("+R("n",t,-A)+")"}if(44===h.charCodeAt(h.length-1))return c(t,h,A);if(-1!==h.indexOf("%"))return e(t,h,A);if(-1!==h.indexOf("E"))return s(h,A);if(36===h.charCodeAt(0))return"$"+R(t,h.substr(" "==h.charAt(1)?2:1),A);let M,O,w,C,b=Math.abs(A),U=A<0?"-":"";if(h.match(/^00+$/))return U+f(b,h.length);if(h.match(/^[#?]+$/))return M=f(A,0),"0"===M&&(M=""),M.length>h.length?M:E(h.substr(0,h.length-M.length))+M;if(O=h.match(u))return l(O,b,U);if(h.match(/^#+0+$/))return U+f(b,h.length-h.indexOf("0"));if(O=h.match(p))return M=v(A,O[1].length).replace(/^([^\.]+)$/,"$1."+E(O[1])).replace(/\.$/,"."+E(O[1])).replace(/\.(\d*)$/,(function(t,e){return"."+e+r("0",E(O[1]).length-e.length)})),-1!==h.indexOf("0.")?M:M.replace(/^0\./,".");if(h=h.replace(/^#+([0.])/,"$1"),O=h.match(/^(0*)\.(#*)$/))return U+v(b,O[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,O[1].length?"0.":".");if(O=h.match(/^#{1,3},##0(\.?)$/))return U+I(f(b,0));if(O=h.match(/^#,##0\.([#0]*0)$/))return A<0?"-"+R(t,h,-A):I(""+(Math.floor(A)+N(A,O[1].length)))+"."+o(y(A,O[1].length),O[1].length);if(O=h.match(/^#,#*,#0/))return R(t,h.replace(/^#,#*,/,""),A);if(O=h.match(/^([0#]+)(\\?-([0#]+))+$/))return M=n(R(t,h.replace(/[\\-]/g,""),A)),w=0,n(n(h.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return w<M.length?M.charAt(w++):"0"===t?"0":""})));if(h.match(m))return M=R(t,"##########",A),"("+M.substr(0,3)+") "+M.substr(3,3)+"-"+M.substr(6);let L="";if(O=h.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return w=Math.min(O[4].length,7),C=g(b,Math.pow(10,w)-1,!1),M=""+U,L=S("n",O[1],C[1])," "===L.charAt(L.length-1)&&(L=L.substr(0,L.length-1)+"0"),M+=L+O[2]+"/"+O[3],L=a(C[2],w),L.length<O[4].length&&(L=E(O[4].substr(O[4].length-L.length))+L),M+=L,M;if(O=h.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return w=Math.min(Math.max(O[1].length,O[4].length),7),C=g(b,Math.pow(10,w)-1,!0),U+(C[0]||(C[1]?"":"0"))+" "+(C[1]?i(C[1],w)+O[2]+"/"+O[3]+a(C[2],w):r(" ",2*w+1+O[2].length+O[3].length));if(O=h.match(/^[#0?]+$/))return M=f(A,0),h.length<=M.length?M:E(h.substr(0,h.length-M.length))+M;if(O=h.match(/^([#0?]+)\.([#0]+)$/)){M=""+A.toFixed(Math.min(O[2].length,10)).replace(/([^0])0+$/,"$1"),w=M.indexOf(".");const t=h.indexOf(".")-w,e=h.length-M.length-t;return E(h.substr(0,t)+M+h.substr(h.length-e))}if(O=h.match(/^00,000\.([#0]*0)$/))return w=y(A,O[1].length),A<0?"-"+R(t,h,-A):I(T(A)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t}))+"."+o(w,O[1].length);switch(h){case"###,##0.00":return R(t,"#,##0.00",A);case"###,###":case"##,###":case"#,###":const e=I(f(b,0));return"0"!==e?U+e:"";case"###,###.00":return R(t,"###,##0.00",A).replace(/^0\./,".");case"#,###.00":return R(t,"#,##0.00",A).replace(/^0\./,".");default:}throw new Error("unsupported format |"+h+"|")}function A(t,e,n){let r=e.length-1;while(44===e.charCodeAt(r-1))--r;return S(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function M(e,n,o){const i=n.replace(t,""),a=n.length-i.length;return S(e,i,o*Math.pow(10,2*a))+r("%",a)}function O(t,e){let n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===e)return"0.0E+0";if(e<0)return"-"+O(t,-e);let o=t.indexOf(".");-1===o&&(o=t.indexOf("E"));let i=Math.floor(Math.log(e)*Math.LOG10E)%o;if(i<0&&(i+=o),n=(e/Math.pow(10,i)).toPrecision(r+1+(o+i)%o),!n.match(/[Ee]/)){const t=Math.floor(Math.log(e)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,n,r){return e+n+r.substr(0,(o+i)%o)+"."+r.substr(i)+"E"}))}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function w(t,e,c){if(40===t.charCodeAt(0)&&!e.match(d)){const t=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return c>=0?w("n",t,c):"("+w("n",t,-c)+")"}if(44===e.charCodeAt(e.length-1))return A(t,e,c);if(-1!==e.indexOf("%"))return M(t,e,c);if(-1!==e.indexOf("E"))return O(e,c);if(36===e.charCodeAt(0))return"$"+w(t,e.substr(" "==e.charAt(1)?2:1),c);let s,f,l,v,y=Math.abs(c),N=c<0?"-":"";if(e.match(/^00+$/))return N+o(y,e.length);if(e.match(/^[#?]+$/))return s=""+c,0===c&&(s=""),s.length>e.length?s:E(e.substr(0,e.length-s.length))+s;if(f=e.match(u))return h(f,y,N);if(e.match(/^#+0+$/))return N+o(y,e.length-e.indexOf("0"));if(f=e.match(p))return s=(""+c).replace(/^([^\.]+)$/,"$1."+E(f[1])).replace(/\.$/,"."+E(f[1])),s=s.replace(/\.(\d*)$/,(function(t,e){return"."+e+r("0",E(f[1]).length-e.length)})),-1!==e.indexOf("0.")?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),f=e.match(/^(0*)\.(#*)$/))return N+(""+y).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=e.match(/^#{1,3},##0(\.?)$/))return N+I(""+y);if(f=e.match(/^#,##0\.([#0]*0)$/))return c<0?"-"+w(t,e,-c):I(""+c)+"."+r("0",f[1].length);if(f=e.match(/^#,#*,#0/))return w(t,e.replace(/^#,#*,/,""),c);if(f=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=n(w(t,e.replace(/[\\-]/g,""),c)),l=0,n(n(e.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return l<s.length?s.charAt(l++):"0"===t?"0":""})));if(e.match(m))return s=w(t,"##########",c),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);let T="";if(f=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(f[4].length,7),v=g(y,Math.pow(10,l)-1,!1),s=""+N,T=S("n",f[1],v[1])," "==T.charAt(T.length-1)&&(T=T.substr(0,T.length-1)+"0"),s+=T+f[2]+"/"+f[3],T=a(v[2],l),T.length<f[4].length&&(T=E(f[4].substr(f[4].length-T.length))+T),s+=T,s;if(f=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(f[1].length,f[4].length),7),v=g(y,Math.pow(10,l)-1,!0),N+(v[0]||(v[1]?"":"0"))+" "+(v[1]?i(v[1],l)+f[2]+"/"+f[3]+a(v[2],l):r(" ",2*l+1+f[2].length+f[3].length));if(f=e.match(/^[#0?]+$/))return s=""+c,e.length<=s.length?s:E(e.substr(0,e.length-s.length))+s;if(f=e.match(/^([#0]+)\.([#0]+)$/)){s=""+c.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");let t=e.indexOf(".")-l,n=e.length-s.length-t;return E(e.substr(0,t)+s+e.substr(e.length-n))}if(f=e.match(/^00,000\.([#0]*0)$/))return c<0?"-"+w(t,e,-c):I(""+c).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t}))+"."+o(0,f[1].length);switch(e){case"###,###":case"##,###":case"#,###":const n=I(""+y);return"0"!==n?N+n:"";default:if(e.match(/\.[0#?]*$/))return w(t,e.slice(0,e.lastIndexOf(".")),c)+E(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}return function(t,e,n){return(0|n)===n?w(t,e,n):R(t,e,n)}}();function C(t){const e=[];let n=!1,r=0;for(let o=0;o<t.length;++o)switch(t.charCodeAt(o)){case 34:n=!n;break;case 95:case 42:case 92:++o;break;case 59:e[e.length]=t.substr(r,o-r),r=o+1}if(e[e.length]=t.substr(r),!0===n)throw new Error("Format |"+t+"| unterminated string ");return e}e._split=C;const b=/\[[HhMmSs]*\]/;function U(t){let e=0,n="",r="";while(e<t.length)switch(n=t.charAt(e)){case"G":l(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase())return!0;if("AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":r=n;while("]"!==t.charAt(e++)&&e<t.length)r+=t.charAt(e);if(r.match(b))return!0;break;case".":case"0":case"#":while(e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||"\\"==n&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1));break;case"?":while(t.charAt(++e)===n);break;case"*":++e," "!==t.charAt(e)&&"*"!==t.charAt(e)||++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":while(e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1);break;case" ":++e;break;default:++e;break}return!1}function L(t,e,n,r){let o,i,a,c=[],s="",u=0,f="",h="t",p="H";while(u<t.length)switch(f=t.charAt(u)){case"G":if(!l(t,u))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"G",v:"General"},u+=7;break;case'"':for(s="";34!==(a=t.charCodeAt(++u))&&u<t.length;)s+=String.fromCharCode(a);c[c.length]={t:"t",v:s},++u;break;case"\\":const i=t.charAt(++u),d="("===i||")"===i?i:"t";c[c.length]={t:d,v:i},++u;break;case"_":c[c.length]={t:"t",v:" "},u+=2;break;case"@":c[c.length]={t:"T",v:e},++u;break;case"B":case"b":if("1"===t.charAt(u+1)||"2"===t.charAt(u+1)){if(null==o&&(o=E(e,n,"2"===t.charAt(u+1)),null==o))return"";c[c.length]={t:"X",v:t.substr(u,2)},h=f,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0)return"";if(null==o&&(o=E(e,n),null==o))return"";s=f;while(++u<t.length&&t.charAt(u).toLowerCase()===f)s+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=p),c[c.length]={t:f,v:s},h=f;break;case"A":case"a":const m={t:f,v:f};if(null==o&&(o=E(e,n)),"A/P"===t.substr(u,3).toUpperCase()?(null!=o&&(m.v=o.H>=12?"P":"A"),m.t="T",p="h",u+=3):"AM/PM"===t.substr(u,5).toUpperCase()?(null!=o&&(m.v=o.H>=12?"PM":"AM"),m.t="T",u+=5,p="h"):(m.t="t",++u),null==o&&"T"===m.t)return"";c[c.length]=m,h=f;break;case"[":s=f;while("]"!==t.charAt(u++)&&u<t.length)s+=t.charAt(u);if("]"!==s.slice(-1))throw'unterminated "[" block: |'+s+"|";if(s.match(b)){if(null==o&&(o=E(e,n),null==o))return"";c[c.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",U(t)||(c[c.length]={t:"t",v:s}));break;case".":if(null!=o){s=f;while(++u<t.length&&"0"===(f=t.charAt(u)))s+=f;c[c.length]={t:"s",v:s};break}case"0":case"#":s=f;while(++u<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(u))>-1||"\\"==f&&"-"==t.charAt(u+1)&&u<t.length-2&&"0#".indexOf(t.charAt(u+2))>-1)s+=f;c[c.length]={t:"n",v:s};break;case"?":s=f;while(t.charAt(++u)===f)s+=f;c[c.length]={t:f,v:s},h=f;break;case"*":++u," "!==t.charAt(u)&&"*"!==t.charAt(u)||++u;break;case"(":case")":c[c.length]={t:1===r||"number"===typeof e&&e<0?"t":f,v:f},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":s=f;while(u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1)s+=t.charAt(u);c[c.length]={t:"D",v:s};break;case" ":c[c.length]={t:f,v:f},++u;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"t",v:f},++u;break}let d,m=0,g=0;for(u=c.length-1,h="t";u>=0;--u)switch(c[u].t){case"h":case"H":c[u].t=p,h="h",m<1&&(m=1);break;case"s":(d=c[u].v.match(/\.0+$/))&&(g=Math.max(g,d[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":h=c[u].t;break;case"m":"s"===h&&(c[u].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&c[u].v.match(/[Hh]/)&&(m=1),m<2&&c[u].v.match(/[Mm]/)&&(m=2),m<3&&c[u].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M);break}let v,y="";for(u=0;u<c.length;++u)switch(c[u].t){case"t":case"T":case" ":case"D":break;case"X":c[u].v="",c[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[u].v=w(c[u].t.charCodeAt(0),c[u].v,o,g),c[u].t="t";break;case"n":case"(":case"?":v=u+1;while(null!=c[v]&&("?"===(f=c[v].t)||"D"===f||(" "===f||"t"===f)&&null!=c[v+1]&&("?"===c[v+1].t||"t"===c[v+1].t&&"/"===c[v+1].v)||"("===c[u].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===c[v].v||" "===c[v].v&&null!=c[v+1]&&"?"===c[v+1].t)))c[u].v+=c[v].v,c[v]={v:"",t:";"},++v;y+=c[u].v,u=v-1;break;case"G":c[u].t="t",c[u].v=M(e,n);break}let N,T,R="";if(y.length>0){40===y.charCodeAt(0)?(N=e<0&&45===y.charCodeAt(0)?-e:e,T=S("(",y,N)):(N=e<0&&r>1?-e:e,T=S("n",y,N),N<0&&c[0]&&"t"===c[0].t&&(T=T.substr(1),c[0].v="-"+c[0].v)),v=T.length-1;let t=c.length;for(u=0;u<c.length;++u)if(null!=c[u]&&"t"!==c[u].t&&c[u].v.indexOf(".")>-1){t=u;break}let n=c.length;if(t===c.length&&-1===T.indexOf("E")){for(u=c.length-1;u>=0;--u)null!=c[u]&&-1!=="n?(".indexOf(c[u].t)&&(v>=c[u].v.length-1?(v-=c[u].v.length,c[u].v=T.substr(v+1,c[u].v.length)):v<0?c[u].v="":(c[u].v=T.substr(0,v+1),v=-1),c[u].t="t",n=u);v>=0&&n<c.length&&(c[n].v=T.substr(0,v+1)+c[n].v)}else if(t!==c.length&&-1===T.indexOf("E")){for(v=T.indexOf(".")-1,u=t;u>=0;--u)if(null!=c[u]&&-1!=="n?(".indexOf(c[u].t)){for(i=c[u].v.indexOf(".")>-1&&u===t?c[u].v.indexOf(".")-1:c[u].v.length-1,R=c[u].v.substr(i+1);i>=0;--i)v>=0&&("0"===c[u].v.charAt(i)||"#"===c[u].v.charAt(i))&&(R=T.charAt(v--)+R);c[u].v=R,c[u].t="t",n=u}for(v>=0&&n<c.length&&(c[n].v=T.substr(0,v+1)+c[n].v),v=T.indexOf(".")+1,u=t;u<c.length;++u)if(null!=c[u]&&(-1!=="n?(".indexOf(c[u].t)||u===t)){for(i=c[u].v.indexOf(".")>-1&&u===t?c[u].v.indexOf(".")+1:0,R=c[u].v.substr(0,i);i<c[u].v.length;++i)v<T.length&&(R+=T.charAt(v++));c[u].v=R,c[u].t="t",n=u}}}for(u=0;u<c.length;++u)null!=c[u]&&"n(?".indexOf(c[u].t)>-1&&(N=r>1&&e<0&&u>0&&"-"===c[u-1].v?-e:e,c[u].v=S(c[u].t,c[u].v,N),c[u].t="t");let A="";for(u=0;u!==c.length;++u)null!=c[u]&&(A+=c[u].v);return A}e.is_date=U,e._eval=L;const x=/\[[=<>]/,_=/\[([=<>]*)(-?\d+\.?\d*)\]/;function k(t,e){if(null==e)return!1;const n=parseFloat(e[2]);switch(e[1]){case"=":if(t===n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!==n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function P(t,e){let n=C(t),r=n.length,o=n[r-1].indexOf("@");if(r<4&&o>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof e)return[4,4===n.length||o>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=o>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=o>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=o>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break;case 4:break}const i=e>0?n[0]:e<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(x)||null!=n[1].match(x)){const t=n[0].match(_),o=n[1].match(_);return k(e,t)?[r,n[0]]:k(e,o)?[r,n[1]]:[r,n[null!=t&&null!=o?2:1]]}return[r,i]}function B(t,e,n){null==n&&(n={});let r="";switch(typeof t){case"string":r="m/d/yy"===t&&n.dateNF?n.dateNF:t;break;case"number":r=14===t&&n.dateNF?n.dateNF:(null!=n.table?n.table:m)[t];break}if(l(r,0))return M(e,n);e instanceof Date&&(e=T(e,n.date1904));const o=P(r,e);if(l(o[1]))return M(e,n);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return L(o[1],e,n,o[0])}function F(t,e){if("number"!==typeof e){e=+e||-1;for(let n=0;n<392;++n)if(void 0!==m[n]){if(m[n]===t){e=n;break}}else e<0&&(e=n);e<0&&(e=391)}return m[e]=t,e}e.load=F,e._table=m,e.get_table=function(){return m},e.load_table=function(t){for(let e=0;392!==e;++e)void 0!==t[e]&&F(t[e],e)},e.init_table=d,e.format=B,t.exports=e},47747:function(t){(function(e,n){t.exports=n()})(0,(function(){var t=function(t,e){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function i(e,n){var r=e>n?e:n;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var a=Array.isArray||function(t){return"[object Array]"===o.call(t)};function c(t){return"[object Function]"===o.call(t)}function s(t){return"number"===typeof t&&t-t===0}function u(t){return n.apply([],t)}function f(){return new f._init(arguments)}function l(){return 0}function h(){return 1}function p(t,e){return t===e?1:0}f.fn=f.prototype,f._init=function(t){if(a(t[0]))if(a(t[0][0])){c(t[1])&&(t[0]=f.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=c(t[1])?f.map(t[0],t[1]):t[0],this.length=1;else if(s(t[0]))this[0]=f.seq.apply(null,t),this.length=1;else{if(t[0]instanceof f)return f(t[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:i,isArray:a,isFunction:c,isNumber:s,toVector:u},f._random_fn=t.random,f.setRandom=function(t){if("function"!==typeof t)throw new TypeError("fn is not a function");f._random_fn=t},f.extend=function(t){var e,n;if(1===arguments.length){for(n in t)f[n]=t[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])t[n]=arguments[e][n];return t},f.rows=function(t){return t.length||1},f.cols=function(t){return t[0].length||1},f.dimensions=function(t){return{rows:f.rows(t),cols:f.cols(t)}},f.row=function(t,e){return a(e)?e.map((function(e){return f.row(t,e)})):t[e]},f.rowa=function(t,e){return f.row(t,e)},f.col=function(t,e){if(a(e)){var n=f.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,r){f.arange(t.length).forEach((function(o){n[o][r]=t[o][e]}))})),n}for(var r=new Array(t.length),o=0;o<t.length;o++)r[o]=[t[o][e]];return r},f.cola=function(t,e){return f.col(t,e).map((function(t){return t[0]}))},f.diag=function(t){for(var e=f.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},f.antidiag=function(t){for(var e=f.rows(t)-1,n=new Array(e),r=0;e>=0;e--,r++)n[r]=[t[r][e]];return n},f.transpose=function(t){var e,n,r,o,i,c=[];for(a(t[0])||(t=[t]),n=t.length,r=t[0].length,i=0;i<r;i++){for(e=new Array(n),o=0;o<n;o++)e[o]=t[o][i];c.push(e)}return 1===c.length?c[0]:c},f.map=function(t,e,n){var r,o,i,c,s;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,c=n?t:new Array(o),r=0;r<o;r++)for(c[r]||(c[r]=new Array(i)),s=0;s<i;s++)c[r][s]=e(t[r][s],r,s);return 1===c.length?c[0]:c},f.cumreduce=function(t,e,n){var r,o,i,c,s;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,c=n?t:new Array(o),r=0;r<o;r++)for(c[r]||(c[r]=new Array(i)),i>0&&(c[r][0]=t[r][0]),s=1;s<i;s++)c[r][s]=e(c[r][s-1],t[r][s]);return 1===c.length?c[0]:c},f.alter=function(t,e){return f.map(t,e,!0)},f.create=function(t,e,n){var r,o,i=new Array(t);for(c(e)&&(n=e,e=t),r=0;r<t;r++)for(i[r]=new Array(e),o=0;o<e;o++)i[r][o]=n(r,o);return i},f.zeros=function(t,e){return s(e)||(e=t),f.create(t,e,l)},f.ones=function(t,e){return s(e)||(e=t),f.create(t,e,h)},f.rand=function(t,e){return s(e)||(e=t),f.create(t,e,f._random_fn)},f.identity=function(t,e){return s(e)||(e=t),f.create(t,e,p)},f.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},f.clear=function(t){return f.alter(t,l)},f.seq=function(t,e,n,r){c(r)||(r=!1);var o,a=[],s=i(t,e),u=(e*s-t*s)/((n-1)*s),f=t;for(o=0;f<=e&&o<n;o++,f=(t*s+u*s*o)/s)a.push(r?r(f,o):f);return a},f.arange=function(t,n,r){var o,i=[];if(r=r||1,n===e&&(n=t,t=0),t===n||0===r)return[];if(t<n&&r<0)return[];if(t>n&&r>0)return[];if(r>0)for(o=t;o<n;o+=r)i.push(o);else for(o=t;o>n;o+=r)i.push(o);return i},f.slice=function(){function t(t,n,r,o){var i,a=[],c=t.length;if(n===e&&r===e&&o===e)return f.copy(t);if(n=n||0,r=r||t.length,n=n>=0?n:c+n,r=r>=0?r:c+r,o=o||1,n===r||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)a.push(t[i]);else for(i=n;i>r;i+=o)a.push(t[i]);return a}function n(e,n){var r,o;if(n=n||{},s(n.row)){if(s(n.col))return e[n.row][n.col];var i=f.rowa(e,n.row);return r=n.col||{},t(i,r.start,r.end,r.step)}if(s(n.col)){var a=f.cola(e,n.col);return o=n.row||{},t(a,o.start,o.end,o.step)}o=n.row||{},r=n.col||{};var c=t(e,o.start,o.end,o.step);return c.map((function(e){return t(e,r.start,r.end,r.step)}))}return n}(),f.sliceAssign=function(n,r,o){var i,a;if(s(r.row)){if(s(r.col))return n[r.row][r.col]=o;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,i=f.arange(r.col.start,t.min(n.length,r.col.end),r.col.step);var c=r.row;return i.forEach((function(t,e){n[c][t]=o[e]})),n}if(s(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,a=f.arange(r.row.start,t.min(n[0].length,r.row.end),r.row.step);var u=r.col;return a.forEach((function(t,e){n[t][u]=o[e]})),n}return o[0].length===e&&(o=[o]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,a=f.arange(r.row.start,t.min(n.length,r.row.end),r.row.step),i=f.arange(r.col.start,t.min(n[0].length,r.col.end),r.col.step),a.forEach((function(t,e){i.forEach((function(r,i){n[t][r]=o[e][i]}))})),n},f.diagonal=function(t){var e=f.zeros(t.length,t.length);return t.forEach((function(t,n){e[n][n]=t})),e},f.copy=function(t){return t.map((function(t){return s(t)?t:t.map((function(t){return t}))}))};var d=f.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},d.map=function(t,e){return f(f.map(this,t,e))},d.cumreduce=function(t,e){return f(f.cumreduce(this,t,e))},d.alter=function(t){return f.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)(function(t){d[t]=function(e){var n,r=this;return e?(setTimeout((function(){e.call(r,d[t].call(r))})),this):(n=f[t](this),a(n)?f(n):n)}})(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)(function(t){d[t]=function(e,n){var r=this;return n?(setTimeout((function(){n.call(r,d[t].call(r,e))})),this):f(f[t](this,e))}})(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)(function(t){d[t]=function(){return f(f[t].apply(null,arguments))}})(t[e])}("create zeros ones rand identity".split(" ")),f}(Math);return function(t,e){var n=t.utils.isFunction;function r(t,e){return t-e}function o(t,n,r){return e.max(n,e.min(t,r))}t.sum=function(t){var e=0,n=t.length;while(--n>=0)e+=t[n];return e},t.sumsqrd=function(t){var e=0,n=t.length;while(--n>=0)e+=t[n]*t[n];return e},t.sumsqerr=function(e){var n,r=t.mean(e),o=0,i=e.length;while(--i>=0)n=e[i]-r,o+=n*n;return o},t.sumrow=function(t){var e=0,n=t.length;while(--n>=0)e+=t[n];return e},t.product=function(t){var e=1,n=t.length;while(--n>=0)e*=t[n];return e},t.min=function(t){var e=t[0],n=0;while(++n<t.length)t[n]<e&&(e=t[n]);return e},t.max=function(t){var e=t[0],n=0;while(++n<t.length)t[n]>e&&(e=t[n]);return e},t.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(n){var r=n.map(e.log),o=t.mean(r);return e.exp(o)},t.median=function(t){var e=t.length,n=t.slice().sort(r);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,n=[],r=t.length;for(e=1;e<r;e++)n.push(t[e]-t[e-1]);return n},t.rank=function(t){var e,n=[],o={};for(e=0;e<t.length;e++){var i=t[e];o[i]?o[i]++:(o[i]=1,n.push(i))}var a=n.sort(r),c={},s=1;for(e=0;e<a.length;e++){i=a[e];var u=o[i],f=s,l=s+u-1,h=(f+l)/2;c[i]=h,s+=u}return t.map((function(t){return c[t]}))},t.mode=function(t){var e,n=t.length,o=t.slice().sort(r),i=1,a=0,c=0,s=[];for(e=0;e<n;e++)o[e]===o[e+1]?i++:(i>a?(s=[o[e]],a=i,c=0):i===a&&(s.push(o[e]),c++),i=1);return 0===c?s[0]:s},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,n){return t.sumsqerr(e)/(e.length-(n?1:0))},t.pooledvariance=function(e){var n=e.reduce((function(e,n){return e+t.sumsqerr(n)}),0),r=e.reduce((function(t,e){return t+e.length}),0);return n/(r-e.length)},t.deviation=function(e){for(var n=t.mean(e),r=e.length,o=new Array(r),i=0;i<r;i++)o[i]=e[i]-n;return o},t.stdev=function(n,r){return e.sqrt(t.variance(n,r))},t.pooledstdev=function(n){return e.sqrt(t.pooledvariance(n))},t.meandev=function(n){for(var r=t.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.mean(o)},t.meddev=function(n){for(var r=t.median(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var n=t.length,o=t.slice().sort(r);return[o[e.round(n/4)-1],o[e.round(n/2)-1],o[e.round(3*n/4)-1]]},t.quantiles=function(t,n,i,a){var c,s,u,f,l,h,p=t.slice().sort(r),d=[n.length],m=t.length;for("undefined"===typeof i&&(i=3/8),"undefined"===typeof a&&(a=3/8),c=0;c<n.length;c++)s=n[c],u=i+s*(1-i-a),f=m*s+u,l=e.floor(o(f,1,m-1)),h=o(f-l,0,1),d[c]=(1-h)*p[l-1]+h*p[l];return d},t.percentile=function(t,e,n){var o=t.slice().sort(r),i=e*(o.length+(n?1:-1))+(n?0:1),a=parseInt(i),c=i-a;return a+1<o.length?o[a-1]+c*(o[a]-o[a-1]):o[a-1]},t.percentileOfScore=function(t,e,n){var r,o,i=0,a=t.length,c=!1;for("strict"===n&&(c=!0),o=0;o<a;o++)r=t[o],(c&&r<e||!c&&r<=e)&&i++;return i/a},t.histogram=function(n,r){r=r||4;var o,i=t.min(n),a=(t.max(n)-i)/r,c=n.length,s=[];for(o=0;o<r;o++)s[o]=0;for(o=0;o<c;o++)s[e.min(e.floor((n[o]-i)/a),r-1)]+=1;return s},t.covariance=function(e,n){var r,o=t.mean(e),i=t.mean(n),a=e.length,c=new Array(a);for(r=0;r<a;r++)c[r]=(e[r]-o)*(n[r]-i);return t.sum(c)/(a-1)},t.corrcoeff=function(e,n){return t.covariance(e,n)/t.stdev(e,1)/t.stdev(n,1)},t.spearmancoeff=function(e,n){return e=t.rank(e),n=t.rank(n),t.corrcoeff(e,n)},t.stanMoment=function(n,r){for(var o=t.mean(n),i=t.stdev(n),a=n.length,c=0,s=0;s<a;s++)c+=e.pow((n[s]-o)/i,r);return c/n.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var i=t.prototype;(function(e){for(var r=0;r<e.length;r++)(function(e){i[e]=function(r,o){var a=[],c=0,s=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(s,i[e].call(s,r))})),this;if(this.length>1){for(s=!0===r?this:this.transpose();c<s.length;c++)a[c]=t[e](s[c]);return a}return t[e](this[0],r)}})(e[r])})("cumsum cumprod".split(" ")),function(e){for(var r=0;r<e.length;r++)(function(e){i[e]=function(r,o){var a=[],c=0,s=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(s,i[e].call(s,r))})),this;if(this.length>1){for("sumrow"!==e&&(s=!0===r?this:this.transpose());c<s.length;c++)a[c]=t[e](s[c]);return!0===r?t[e](t.utils.toVector(a)):a}return t[e](this[0],r)}})(e[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var r=0;r<e.length;r++)(function(e){i[e]=function(){var r,o=[],a=0,c=this,s=Array.prototype.slice.call(arguments);if(n(s[s.length-1])){r=s[s.length-1];var u=s.slice(0,s.length-1);return setTimeout((function(){r.call(c,i[e].apply(c,u))})),this}r=void 0;var f=function(n){return t[e].apply(c,[n].concat(s))};if(this.length>1){for(c=c.transpose();a<c.length;a++)o[a]=f(c[a]);return o}return f(this[0])}})(e[r])}("quantiles percentileOfScore".split(" "))}(t,Math),function(t,e){t.gammaln=function(t){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015;for(o=(r=n=t)+5.5,o-=(n+.5)*e.log(o);i<6;i++)c+=a[i]/++r;return e.log(2.5066282746310007*c/n)-o},t.loggam=function(t){var n,r,o,i,a,c,s,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=t,s=0,1==t||2==t)return 0;for(t<=7&&(s=e.floor(7-t),n=t+s),r=1/(n*n),o=2*e.PI,a=u[9],c=8;c>=0;c--)a*=r,a+=u[c];if(i=a/n+.5*e.log(o)+(n-.5)*e.log(n)-n,t<=7)for(c=1;c<=s;c++)i-=e.log(n-1),n-=1;return i},t.gammafn=function(t){var n,r,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,u=0,f=0,l=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(i=h%1+36e-17,!i)return 1/0;s=(1&h?-1:1)*e.PI/e.sin(e.PI*i),h=1-h}for(o=h,r=h<1?h++:(h-=u=(0|h)-1)-1,n=0;n<8;++n)l=(l+a[n])*r,f=f*r+c[n];if(i=l/f+1,o<h)i/=o;else if(o>h)for(n=0;n<u;++n)i*=h,h++;return s&&(i=s/i),i},t.gammap=function(e,n){return t.lowRegGamma(e,n)*t.gammafn(e)},t.lowRegGamma=function(n,r){var o,i=t.gammaln(n),a=n,c=1/n,s=c,u=r+1-n,f=1/1e-30,l=1/u,h=l,p=1,d=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;p<=d;p++)c+=s*=r/++a;return c*e.exp(-r+n*e.log(r)-i)}for(;p<=d;p++)o=-p*(p-n),u+=2,l=o*l+u,f=u+o/f,l=1/l,h*=l*f;return 1-h*e.exp(-r+n*e.log(r)-i)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(n,r){return n>170||r>170?e.exp(t.combinationln(n,r)):t.factorial(n)/t.factorial(r)/t.factorial(n-r)},t.combinationln=function(e,n){return t.factorialln(e)-t.factorialln(n)-t.factorialln(e-n)},t.permutation=function(e,n){return t.factorial(e)/t.factorial(e-n)},t.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?e.exp(t.betaln(n,r)):t.gammafn(n)*t.gammafn(r)/t.gammafn(n+r)},t.betaln=function(e,n){return t.gammaln(e)+t.gammaln(n)-t.gammaln(e+n)},t.betacf=function(t,n,r){var o,i,a,c,s=1e-30,u=1,f=n+r,l=n+1,h=n-1,p=1,d=1-f*t/l;for(e.abs(d)<s&&(d=s),d=1/d,c=d;u<=100;u++)if(o=2*u,i=u*(r-u)*t/((h+o)*(n+o)),d=1+i*d,e.abs(d)<s&&(d=s),p=1+i/p,e.abs(p)<s&&(p=s),d=1/d,c*=d*p,i=-(n+u)*(f+u)*t/((n+o)*(l+o)),d=1+i*d,e.abs(d)<s&&(d=s),p=1+i/p,e.abs(p)<s&&(p=s),d=1/d,a=d*p,c*=a,e.abs(a-1)<3e-7)break;return c},t.gammapinv=function(n,r){var o,i,a,c,s,u,f,l=0,h=r-1,p=1e-8,d=t.gammaln(r);if(n>=1)return e.max(100,r+100*e.sqrt(r));if(n<=0)return 0;for(r>1?(u=e.log(h),f=e.exp(h*(u-1)-d),s=n<.5?n:1-n,a=e.sqrt(-2*e.log(s)),o=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,n<.5&&(o=-o),o=e.max(.001,r*e.pow(1-1/(9*r)-o/(3*e.sqrt(r)),3))):(a=1-r*(.253+.12*r),o=n<a?e.pow(n/a,1/r):1-e.log(1-(n-a)/(1-a)));l<12;l++){if(o<=0)return 0;if(i=t.lowRegGamma(r,o)-n,a=r>1?f*e.exp(-(o-h)+h*(e.log(o)-u)):e.exp(-o+h*e.log(o)-d),c=i/a,o-=a=c/(1-.5*e.min(1,c*((r-1)/o-1))),o<=0&&(o=.5*(o+a)),e.abs(a)<p*o)break}return o},t.erf=function(t){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=a.length-1,s=!1,u=0,f=0;for(t<0&&(t=-t,s=!0),n=2/(2+t),r=4*n-2;c>0;c--)o=u,u=r*u-f+a[c],f=o;return i=n*e.exp(-t*t+.5*(a[0]+r*u)-f),s?i-1:1-i},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(n){var r,o,i,a,c=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,i=e.sqrt(-2*e.log(a/2)),r=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);c<2;c++)o=t.erfc(r)-a,r+=o/(1.1283791670955126*e.exp(-r*r)-r*o);return n<1?r:-r},t.ibetainv=function(n,r,o){var i,a,c,s,u,f,l,h,p,d,m,g=1e-8,E=r-1,v=o-1,y=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(c=n<.5?n:1-n,s=e.sqrt(-2*e.log(c)),l=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,n<.5&&(l=-l),h=(l*l-3)/6,p=2/(1/(2*r-1)+1/(2*o-1)),d=l*e.sqrt(h+p)/p-(1/(2*o-1)-1/(2*r-1))*(h+5/6-2/(3*p)),l=r/(r+o*e.exp(2*d))):(i=e.log(r/(r+o)),a=e.log(o/(r+o)),s=e.exp(r*i)/r,u=e.exp(o*a)/o,d=s+u,l=n<s/d?e.pow(r*d*n,1/r):1-e.pow(o*d*(1-n),1/o)),m=-t.gammaln(r)-t.gammaln(o)+t.gammaln(r+o);y<10;y++){if(0===l||1===l)return l;if(f=t.ibeta(l,r,o)-n,s=e.exp(E*e.log(l)+v*e.log(1-l)+m),u=f/s,l-=s=u/(1-.5*e.min(1,u*(E/l-v/(1-l)))),l<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),e.abs(s)<g*l&&y>0)break}return l},t.ibeta=function(n,r,o){var i=0===n||1===n?0:e.exp(t.gammaln(r+o)-t.gammaln(r)-t.gammaln(o)+r*e.log(n)+o*e.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*t.betacf(n,r,o)/r:1-i*t.betacf(1-n,o,r)/o)},t.randn=function(n,r){var o,i,a,c,s;if(r||(r=n),n)return t.create(n,r,(function(){return t.randn()}));do{o=t._random_fn(),i=1.7156*(t._random_fn()-.5),a=o-.449871,c=e.abs(i)+.386595,s=a*a+c*(.196*c-.25472*a)}while(s>.27597&&(s>.27846||i*i>-4*e.log(o)*o*o));return i/o},t.randg=function(n,r,o){var i,a,c,s,u,f,l=n;if(o||(o=r),n||(n=1),r)return f=t.zeros(r,o),f.alter((function(){return t.randg(n)})),f;n<1&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do{u=t.randn(),s=1+a*u}while(s<=0);s*=s*s,c=t._random_fn()}while(c>1-.331*e.pow(u,4)&&e.log(c)>.5*u*u+i*(1-s+e.log(s)));if(n==l)return i*s;do{c=t._random_fn()}while(0===c);return e.pow(c,1/l)*i*s},function(e){for(var n=0;n<e.length;n++)(function(e){t.fn[e]=function(){return t(t.map(this,(function(n){return t[e](n)})))}})(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)(function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}})(e[n])}("randn".split(" "))}(t,Math),function(t,e){function n(t,n,r,o){var i,a=0,c=1,s=1,u=1,f=0,l=0;while(e.abs((s-l)/s)>o)l=s,i=-(n+f)*(n+r+f)*t/(n+2*f)/(n+2*f+1),a=s+i*a,c=u+i*c,f+=1,i=f*(r-f)*t/(n+2*f-1)/(n+2*f),s=a+i*s,u=c+i*u,a/=u,c/=u,s/=u,u=1;return s/n}function r(t){return t/e.abs(t)}function o(n,r,o){var i=12,a=6,c=-30,s=-50,u=60,f=8,l=3,h=2,p=3,d=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],m=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],g=.5*n;if(g>=f)return 1;var E,v=2*t.normal.cdf(g,0,1,1,0)-1;v=v>=e.exp(s/o)?e.pow(v,o):0,E=n>l?h:p;for(var y=g,N=(f-g)/E,T=y+N,R=0,A=o-1,M=1;M<=E;M++){for(var O=0,w=.5*(T+y),I=.5*(T-y),S=1;S<=i;S++){var C,b;a<S?(C=i-S+1,b=d[C-1]):(C=S,b=-d[C-1]);var U=I*b,L=w+U,x=L*L;if(x>u)break;var _=2*t.normal.cdf(L,0,1,1,0),k=2*t.normal.cdf(L,n,1,1,0),P=.5*_-.5*k;P>=e.exp(c/A)&&(P=m[C-1]*e.exp(-.5*x)*e.pow(P,A),O+=P)}O*=2*I*o/e.sqrt(2*e.PI),R+=O,y=T,T+=N}return v+=R,v<=e.exp(c/r)?0:(v=e.pow(v,r),v>=1?1:v)}function i(t,n,r){var o=.322232421088,i=.099348462606,a=-1,c=.588581570495,s=-.342242088547,u=.531103462366,f=-.204231210125,l=.10353775285,h=-453642210148e-16,p=.0038560700634,d=.8832,m=.2368,g=1.214,E=1.208,v=1.4142,y=120,N=.5-.5*t,T=e.sqrt(e.log(1/(N*N))),R=T+((((T*h+f)*T+s)*T+a)*T+o)/((((T*p+l)*T+u)*T+c)*T+i);r<y&&(R+=(R*R*R+R)/r/4);var A=d-m*R;return r<y&&(A+=-g/r+E*R/r),R*(A*e.log(n-1)+v)}(function(e){for(var n=0;n<e.length;n++)(function(e){t[e]=function t(e,n,r){return this instanceof t?(this._a=e,this._b=n,this._c=r,this):new t(e,n,r)},t.fn[e]=function(n,r,o){var i=t[e](n,r,o);return i.data=this,i},t[e].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?t.alter(n,(function(){return t[e].sample(r,o,i)})):t[e].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)(function(n){t[e].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!==typeof r?t.fn.map.call(r,(function(r){return t[e][n](r,o,i,a)})):t[e][n](r,o,i,a)}})(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){t[e].prototype[n]=function(){return t[e][n](this._a,this._b,this._c)}})(n[r])}("mean median mode variance".split(" "))})(e[n])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?e.pow(n,r-1)*e.pow(1-n,o-1)/t.betafn(r,o):e.exp((r-1)*e.log(n)+(o-1)*e.log(1-n)-t.betaln(r,o))},cdf:function(e,n,r){return e>1||e<0?1*(e>1):t.ibeta(e,n,r)},inv:function(e,n,r){return t.ibetainv(e,n,r)},mean:function(t,e){return t/(t+e)},median:function(e,n){return t.ibetainv(.5,e,n)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,n){var r=t.randg(e);return r/(r+t.randg(n))},variance:function(t,n){return t*n/(e.pow(t+n,2)*(t+n+1))}}),t.extend(t.centralF,{pdf:function(n,r,o){var i,a,c;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/t.betafn(r/2,o/2)*e.pow(r/o,r/2)*e.pow(n,r/2-1)*e.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),a=o/(o+n*r),c=r*a/2,c*t.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(e,n,r){return e<0?0:t.ibeta(n*e/(n*e+r),n/2,r/2)},inv:function(e,n,r){return r/(n*(1/t.ibetainv(e,n/2,r/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,n){var r=2*t.randg(e/2),o=2*t.randg(n/2);return r/e/(o/n)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,n,r){return r<0?0:r/(e.pow(t-n,2)+e.pow(r,2))/e.PI},cdf:function(t,n,r){return e.atan((t-n)/r)/e.PI+.5},inv:function(t,n,r){return n+r*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(n,r){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*r+n}}),t.extend(t.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:e.exp((r/2-1)*e.log(n)-n/2-r/2*e.log(2)-t.gammaln(r/2))},cdf:function(e,n){return e<0?0:t.lowRegGamma(n/2,e/2)},inv:function(e,n){return 2*t.gammapinv(e,.5*n)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,n){return t<0?0:n*e.exp(-n*t)},cdf:function(t,n){return t<0?0:1-e.exp(-n*t)},inv:function(t,n){return-e.log(1-t)/n},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(n){return-1/n*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:e.exp((r-1)*e.log(n)-n/o-t.gammaln(r)-r*e.log(o))},cdf:function(e,n,r){return e<0?0:t.lowRegGamma(n,e/r)},inv:function(e,n,r){return t.gammapinv(e,n)*r},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,n){return t.randg(e)*n},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(n,r,o){return n<=0?0:e.exp(-(r+1)*e.log(n)-o/n-t.gammaln(r)+r*e.log(o))},cdf:function(e,n,r){return e<=0?0:1-t.lowRegGamma(n,r/e)},inv:function(e,n,r){return r/t.gammapinv(1-e,n)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,n){return n/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,n,r){return 0===t&&1===n?r:1===t&&1===r?n:e.exp(e.log(n)+e.log(r)+(n-1)*e.log(t)+(r-1)*e.log(1-e.pow(t,n)))},cdf:function(t,n,r){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,n),r)},inv:function(t,n,r){return e.pow(1-e.pow(1-t,1/r),1/n)},mean:function(e,n){return n*t.gammafn(1+1/e)*t.gammafn(n)/t.gammafn(1+1/e+n)},median:function(t,n){return e.pow(1-e.pow(2,-1/n),1/t)},mode:function(t,n){if(t>=1&&n>=1&&1!==t&&1!==n)return e.pow((t-1)/(t*n-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,n,r){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(r)-e.pow(e.log(t)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*t.erf((e.log(n)-r)/e.sqrt(2*o*o))},inv:function(n,r,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*n)+r)},mean:function(t,n){return e.exp(t+n*n/2)},median:function(t){return e.exp(t)},mode:function(t,n){return e.exp(t-n*n)},sample:function(n,r){return e.exp(t.randn()*r+n)},variance:function(t,n){return(e.exp(n*n)-1)*e.exp(2*t+n*n)}}),t.extend(t.noncentralt,{pdf:function(n,r,o){var i=1e-14;return e.abs(o)<i?t.studentt.pdf(n,r):e.abs(n)<i?e.exp(t.gammaln((r+1)/2)-o*o/2-.5*e.log(e.PI*r)-t.gammaln(r/2)):r/n*(t.noncentralt.cdf(n*e.sqrt(1+2/r),r+2,o)-t.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){var i=1e-14,a=200;if(e.abs(o)<i)return t.studentt.cdf(n,r);var c=!1;n<0&&(c=!0,o=-o);var s=t.normal.cdf(-o,0,1),u=i+1,f=u,l=n*n/(n*n+r),h=0,p=e.exp(-o*o/2),d=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;while(h<a||f>i||u>i)f=u,h>0&&(p*=o*o/(2*h),d*=o*o/(2*(h+.5))),u=p*t.beta.cdf(l,h+.5,r/2)+d*t.beta.cdf(l,h+1,r/2),s+=.5*u,h++;return c?1-s:s}}),t.extend(t.normal,{pdf:function(t,n,r){return e.exp(-.5*e.log(2*e.PI)-e.log(r)-e.pow(t-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+t.erf((n-r)/e.sqrt(2*o*o)))},inv:function(e,n,r){return-1.4142135623730951*r*t.erfcinv(2*e)+n},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,n){return t.randn()*n+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,n,r){return t<n?0:r*e.pow(n,r)/e.pow(t,r+1)},cdf:function(t,n,r){return t<n?0:1-e.pow(n/t,r)},inv:function(t,n,r){return n/e.pow(1-t,1/r)},mean:function(t,n){if(!(n<=1))return n*e.pow(t,n)/(n-1)},median:function(t,n){return t*(n*e.SQRT2)},mode:function(t){return t},variance:function(t,n){if(!(n<=2))return t*t*n/(e.pow(n-1,2)*(n-2))}}),t.extend(t.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(e.sqrt(r)*t.betafn(.5,r/2))*e.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return t.ibeta((n+e.sqrt(n*n+r))/(2*e.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=t.ibetainv(2*e.min(n,1-n),.5*r,.5);return o=e.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return t.randn()*e.sqrt(n/(2*t.randg(n/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,n,r){return t<0||n<0||r<0?0:r/n*e.pow(t/n,r-1)*e.exp(-e.pow(t/n,r))},cdf:function(t,n,r){return t<0?0:1-e.exp(-e.pow(t/n,r))},inv:function(t,n,r){return n*e.pow(-e.log(1-t),1/r)},mean:function(e,n){return e*t.gammafn(1+1/n)},median:function(t,n){return t*e.pow(e.log(2),1/n)},mode:function(t,n){return n<=1?0:t*e.pow((n-1)/n,1/n)},sample:function(n,r){return n*e.pow(-e.log(t._random_fn()),1/r)},variance:function(n,r){return n*n*t.gammafn(1+2/r)-e.pow(t.weibull.mean(n,r),2)}}),t.extend(t.uniform,{pdf:function(t,e,n){return t<e||t>n?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(e,n){return t.mean(e,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t._random_fn()-1)},variance:function(t,n){return e.pow(n-t,2)/12}}),t.extend(t.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:t.combination(r,n)*e.pow(o,n)*e.pow(1-o,r-n)},cdf:function(r,o,i){var a,c=1e-10;if(r<0)return 0;if(r>=o)return 1;if(i<0||i>1||o<=0)return NaN;r=e.floor(r);var s=i,u=r+1,f=o-r,l=u+f,h=e.exp(t.gammaln(l)-t.gammaln(f)-t.gammaln(u)+u*e.log(s)+f*e.log(1-s));return a=s<(u+1)/(l+2)?h*n(s,u,f,c):1-h*n(1-s,f,u,c),e.round(1/c*(1-a))/(1/c)}}),t.extend(t.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:t.combination(n+r-1,r-1)*e.pow(1-o,n)*e.pow(o,r))},cdf:function(e,n,r){var o=0,i=0;if(e<0)return 0;for(;i<=e;i++)o+=t.negbin.pdf(i,n,r);return o}}),t.extend(t.hypgeom,{pdf:function(n,r,o,i){if(n!==n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?t.hypgeom.pdf(r-o-i+n,r,r-o,r-i):t.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return t.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return t.hypgeom.pdf(n,r,i,o);for(var a=1,c=0,s=0;s<n;s++){while(a>1&&c<i)a*=1-o/(r-c),c++;a*=(i-s)*(o-s)/((s+1)*(r-o-i+s+1))}for(;c<i;c++)a*=1-o/(r-c);return e.min(1,e.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?t.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-t.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-t.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return t.hypgeom.cdf(n,r,i,o);for(var a=1,c=1,s=0,u=0;u<n;u++){while(a>1&&s<i){var f=1-o/(r-s);c*=f,a*=f,s++}c*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1)),a+=c}for(;s<i;s++)a*=1-o/(r-s);return e.min(1,e.max(0,a))}}),t.extend(t.poisson,{pdf:function(n,r){return r<0||n%1!==0||n<0?0:e.pow(r,n)*e.exp(-r)/t.factorial(n)},cdf:function(e,n){var r=[],o=0;if(e<0)return 0;for(;o<=e;o++)r.push(t.poisson.pdf(o,n));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(n){var r=1,o=0,i=e.exp(-n);do{o++,r*=t._random_fn()}while(r>i);return o-1},sampleLarge:function(n){var r,o,i,a,c,s,u,f,l,h,p=n;a=e.sqrt(p),c=e.log(p),u=.931+2.53*a,s=.02483*u-.059,f=1.1239+1.1328/(u-3.4),l=.9277-3.6224/(u-2);while(1){if(o=e.random()-.5,i=e.random(),h=.5-e.abs(o),r=e.floor((2*s/h+u)*o+p+.43),h>=.07&&i<=l)return r;if(!(r<0||h<.013&&i>h)&&e.log(i)+e.log(f)-e.log(s/(h*h)+u)<=r*c-p-t.loggam(r+1))return r}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||r>n?NaN:t<e||t>n?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=n?0:t>=r?1:t<=o?e.pow(t-n,2)/((r-n)*(o-n)):1-e.pow(r-t,2)/((r-n)*(r-o))},inv:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=(o-n)/(r-n)?n+(r-n)*e.sqrt(t*((o-n)/(r-n))):n+(r-n)*(1-e.sqrt((1-t)*(1-(o-n)/(r-n))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,n,r){return r<=(t+n)/2?n-e.sqrt((n-t)*(n-r))/e.sqrt(2):r>(t+n)/2?t+e.sqrt((n-t)*(r-t))/e.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(n,r,o){var i=t._random_fn();return i<(o-n)/(r-n)?n+e.sqrt(i*(r-n)*(o-n)):r-e.sqrt((1-i)*(r-n)*(r-o))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),t.extend(t.arcsine,{pdf:function(t,n,r){return r<=n?NaN:t<=n||t>=r?0:2/e.PI*e.pow(e.pow(r-n,2)-e.pow(2*t-n-r,2),-.5)},cdf:function(t,n,r){return t<n?0:t<r?2/e.PI*e.asin(e.sqrt((t-n)/(r-n))):1},inv:function(t,n,r){return n+(.5-.5*e.cos(e.PI*t))*(r-n)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,n){return n<=t?NaN:e.pow(n-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,n,r){return r<=0?0:e.exp(-e.abs(t-n)/r)/(2*r)},cdf:function(t,n,r){return r<=0?0:t<n?.5*e.exp((t-n)/r):1-.5*e.exp(-(t-n)/r)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(n,o){var i=t._random_fn()-.5;return n-o*r(i)*e.log(1-2*e.abs(i))}}),t.extend(t.tukey,{cdf:function(n,r,i){var a=1,c=r,s=16,u=8,f=-30,l=1e-14,h=100,p=800,d=5e3,m=25e3,g=1,E=.5,v=.25,y=.125,N=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],T=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||a<1||c<2)return NaN;if(!Number.isFinite(n))return 1;if(i>m)return o(n,a,c);var R,A=.5*i,M=A*e.log(i)-i*e.log(2)-t.gammaln(A),O=A-1,w=.25*i;R=i<=h?g:i<=p?E:i<=d?v:y,M+=e.log(R);for(var I=0,S=1;S<=50;S++){for(var C=0,b=(2*S-1)*R,U=1;U<=s;U++){var L,x,_;if(u<U?(L=U-u-1,x=M+O*e.log(b+N[L]*R)-(N[L]*R+b)*w):(L=U-1,x=M+O*e.log(b-N[L]*R)+(N[L]*R-b)*w),x>=f){_=u<U?n*e.sqrt(.5*(N[L]*R+b)):n*e.sqrt(.5*(-N[L]*R+b));var k=o(_,a,c),P=k*T[L]*e.exp(x);C+=P}}if(S*R>=1&&C<=l)break;I+=C}if(C>l)throw new Error("tukey.cdf failed to converge");return I>1&&(I=1),I},inv:function(n,r,o){var a=1,c=r,s=1e-4,u=50;if(o<2||a<1||c<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var f,l=i(n,c,o),h=t.tukey.cdf(l,r,o)-n;f=h>0?e.max(0,l-1):l+1;for(var p,d=t.tukey.cdf(f,r,o)-n,m=1;m<u;m++){p=f-d*(f-l)/(d-h),h=d,l=f,p<0&&(p=0,d=-n),d=t.tukey.cdf(p,r,o)-n,f=p;var g=e.abs(f-l);if(g<s)return p}throw new Error("tukey.inv failed to converge")}})}(t,Math),function(t,e){var n=Array.prototype.push,r=t.utils.isArray;function o(e){return r(e)||e instanceof t}t.extend({add:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t+n[e][r]}))):t.map(e,(function(t){return t+n}))},subtract:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t-n[e][r]||0}))):t.map(e,(function(t){return t-n}))},divide:function(e,n){return o(n)?(o(n[0])||(n=[n]),t.multiply(e,t.inv(n))):t.map(e,(function(t){return t/n}))},multiply:function(e,n){var r,i,a,c,s,u,f,l;if(void 0===e.length&&void 0===n.length)return e*n;if(s=e.length,u=e[0].length,f=t.zeros(s,a=o(n)?n[0].length:u),l=0,o(n)){for(;l<a;l++)for(r=0;r<s;r++){for(c=0,i=0;i<u;i++)c+=e[r][i]*n[i][l];f[r][l]=c}return 1===s&&1===l?f[0][0]:f}return t.map(e,(function(t){return t*n}))},outer:function(e,n){return t.multiply(e.map((function(t){return[t]})),[n])},dot:function(e,n){o(e[0])||(e=[e]),o(n[0])||(n=[n]);for(var r,i,a=1===e[0].length&&1!==e.length?t.transpose(e):e,c=1===n[0].length&&1!==n.length?t.transpose(n):n,s=[],u=0,f=a.length,l=a[0].length;u<f;u++){for(s[u]=[],r=0,i=0;i<l;i++)r+=a[u][i]*c[u][i];s[u]=r}return 1===s.length?s[0]:s},pow:function(n,r){return t.map(n,(function(t){return e.pow(t,r)}))},exp:function(n){return t.map(n,(function(t){return e.exp(t)}))},log:function(n){return t.map(n,(function(t){return e.log(t)}))},abs:function(n){return t.map(n,(function(t){return e.abs(t)}))},norm:function(t,n){var r=0,i=0;for(isNaN(n)&&(n=2),o(t[0])&&(t=t[0]);i<t.length;i++)r+=e.pow(e.abs(t[i]),n);return e.pow(r,1/n)},angle:function(n,r){return e.acos(t.dot(n,r)/(t.norm(n)*t.norm(r)))},aug:function(t,e){var r,o=[];for(r=0;r<t.length;r++)o.push(t[r].slice());for(r=0;r<o.length;r++)n.apply(o[r],e[r]);return o},inv:function(e){for(var n,r=e.length,o=e[0].length,i=t.identity(r,o),a=t.gauss_jordan(e,i),c=[],s=0;s<r;s++)for(c[s]=[],n=o;n<a[0].length;n++)c[s][n-o]=a[s][n];return c},det:function t(e){if(2===e.length)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(var n=0,r=0;r<e.length;r++){for(var o=[],i=1;i<e.length;i++){o[i-1]=[];for(var a=0;a<e.length;a++)a<r?o[i-1][a]=e[i][a]:a>r&&(o[i-1][a-1]=e[i][a])}var c=r%2?-1:1;n+=t(o)*e[0][r]*c}return n},gauss_elimination:function(n,r){var o,i,a,c,s=0,u=0,f=n.length,l=n[0].length,h=1,p=0,d=[];for(n=t.aug(n,r),o=n[0].length,s=0;s<f;s++){for(i=n[s][s],u=s,c=s+1;c<l;c++)i<e.abs(n[c][s])&&(i=n[c][s],u=c);if(u!=s)for(c=0;c<o;c++)a=n[s][c],n[s][c]=n[u][c],n[u][c]=a;for(u=s+1;u<f;u++)for(h=n[u][s]/n[s][s],c=s;c<o;c++)n[u][c]=n[u][c]-h*n[s][c]}for(s=f-1;s>=0;s--){for(p=0,u=s+1;u<=f-1;u++)p+=d[u]*n[s][u];d[s]=(n[s][o-1]-p)/n[s][s]}return d},gauss_jordan:function(n,r){var o,i,a,c=t.aug(n,r),s=c.length,u=c[0].length,f=0;for(i=0;i<s;i++){var l=i;for(a=i+1;a<s;a++)e.abs(c[a][i])>e.abs(c[l][i])&&(l=a);var h=c[i];for(c[i]=c[l],c[l]=h,a=i+1;a<s;a++)for(f=c[a][i]/c[i][i],o=i;o<u;o++)c[a][o]-=c[i][o]*f}for(i=s-1;i>=0;i--){for(f=c[i][i],a=0;a<i;a++)for(o=u-1;o>i-1;o--)c[a][o]-=c[i][o]*c[a][i]/f;for(c[i][i]/=f,o=s;o<u;o++)c[i][o]/=f}return c},triaUpSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return void 0!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o-1,-1,-1).forEach((function(a){r=t.arange(a+1,o).map((function(t){return i[t]*e[a][t]})),i[a]=(n[a]-t.sum(r))/e[a][a]})),a?i.map((function(t){return[t]})):i},triaLowSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return void 0!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o).forEach((function(o){r=t.arange(o).map((function(t){return e[o][t]*i[t]})),i[o]=(n[o]-t.sum(r))/e[o][o]})),a?i.map((function(t){return[t]})):i},lu:function(e){var n,r=e.length,o=t.identity(r),i=t.zeros(e.length,e[0].length);return t.arange(r).forEach((function(t){i[0][t]=e[0][t]})),t.arange(1,r).forEach((function(a){t.arange(a).forEach((function(r){n=t.arange(r).map((function(t){return o[a][t]*i[t][r]})),o[a][r]=(e[a][r]-t.sum(n))/i[r][r]})),t.arange(a,r).forEach((function(r){n=t.arange(a).map((function(t){return o[a][t]*i[t][r]})),i[a][r]=e[n.length][r]-t.sum(n)}))})),[o,i]},cholesky:function(n){var r,o=n.length,i=t.zeros(n.length,n[0].length);return t.arange(o).forEach((function(a){r=t.arange(a).map((function(t){return e.pow(i[a][t],2)})),i[a][a]=e.sqrt(n[a][a]-t.sum(r)),t.arange(a+1,o).forEach((function(e){r=t.arange(a).map((function(t){return i[a][t]*i[e][t]})),i[e][a]=(n[a][e]-t.sum(r))/i[a][a]}))})),i},gauss_jacobi:function(n,r,o,i){for(var a,c,s,u,f=0,l=0,h=n.length,p=[],d=[],m=[];f<h;f++)for(p[f]=[],d[f]=[],m[f]=[],l=0;l<h;l++)f>l?(p[f][l]=n[f][l],d[f][l]=m[f][l]=0):f<l?(d[f][l]=n[f][l],p[f][l]=m[f][l]=0):(m[f][l]=n[f][l],p[f][l]=d[f][l]=0);s=t.multiply(t.multiply(t.inv(m),t.add(p,d)),-1),c=t.multiply(t.inv(m),r),a=o,u=t.add(t.multiply(s,o),c),f=2;while(e.abs(t.norm(t.subtract(u,a)))>i)a=u,u=t.add(t.multiply(s,a),c),f++;return u},gauss_seidel:function(n,r,o,i){for(var a,c,s,u,f,l=0,h=n.length,p=[],d=[],m=[];l<h;l++)for(p[l]=[],d[l]=[],m[l]=[],a=0;a<h;a++)l>a?(p[l][a]=n[l][a],d[l][a]=m[l][a]=0):l<a?(d[l][a]=n[l][a],p[l][a]=m[l][a]=0):(m[l][a]=n[l][a],p[l][a]=d[l][a]=0);u=t.multiply(t.multiply(t.inv(t.add(m,p)),d),-1),s=t.multiply(t.inv(t.add(m,p)),r),c=o,f=t.add(t.multiply(u,o),s),l=2;while(e.abs(t.norm(t.subtract(f,c)))>i)c=f,f=t.add(t.multiply(u,c),s),l+=1;return f},SOR:function(n,r,o,i,a){for(var c,s,u,f,l,h=0,p=n.length,d=[],m=[],g=[];h<p;h++)for(d[h]=[],m[h]=[],g[h]=[],c=0;c<p;c++)h>c?(d[h][c]=n[h][c],m[h][c]=g[h][c]=0):h<c?(m[h][c]=n[h][c],d[h][c]=g[h][c]=0):(g[h][c]=n[h][c],d[h][c]=m[h][c]=0);f=t.multiply(t.inv(t.add(g,t.multiply(d,a))),t.subtract(t.multiply(g,1-a),t.multiply(m,a))),u=t.multiply(t.multiply(t.inv(t.add(g,t.multiply(d,a))),r),a),s=o,l=t.add(t.multiply(f,o),u),h=2;while(e.abs(t.norm(t.subtract(l,s)))>i)s=l,l=t.add(t.multiply(f,s),u),h++;return l},householder:function(n){for(var r,o,i,a,c,s=n.length,u=n[0].length,f=0,l=[],h=[];f<s-1;f++){for(r=0,a=f+1;a<u;a++)r+=n[a][f]*n[a][f];for(c=n[f+1][f]>0?-1:1,r=c*e.sqrt(r),o=e.sqrt((r*r-n[f+1][f]*r)/2),l=t.zeros(s,1),l[f+1][0]=(n[f+1][f]-r)/(2*o),i=f+2;i<s;i++)l[i][0]=n[i][f]/(2*o);h=t.subtract(t.identity(s,u),t.multiply(t.multiply(l,t.transpose(l)),2)),n=t.multiply(h,t.multiply(n,h))}return n},QR:function(){var n=t.sum,r=t.arange;function o(o){var i,a,c,s=o.length,u=o[0].length,f=t.zeros(u,u);for(o=t.copy(o),a=0;a<u;a++){for(f[a][a]=e.sqrt(n(r(s).map((function(t){return o[t][a]*o[t][a]})))),i=0;i<s;i++)o[i][a]=o[i][a]/f[a][a];for(c=a+1;c<u;c++)for(f[a][c]=n(r(s).map((function(t){return o[t][a]*o[t][c]}))),i=0;i<s;i++)o[i][c]=o[i][c]-o[i][a]*f[a][c]}return[o,f]}return o}(),lstsq:function(){function e(e){e=t.copy(e);var n=e.length,r=t.identity(n);return t.arange(n-1,-1,-1).forEach((function(n){t.sliceAssign(r,{row:n},t.divide(t.slice(r,{row:n}),e[n][n])),t.sliceAssign(e,{row:n},t.divide(t.slice(e,{row:n}),e[n][n])),t.arange(n).forEach((function(o){var i=t.multiply(e[o][n],-1),a=t.slice(e,{row:o}),c=t.multiply(t.slice(e,{row:n}),i);t.sliceAssign(e,{row:o},t.add(a,c));var s=t.slice(r,{row:o}),u=t.multiply(t.slice(r,{row:n}),i);t.sliceAssign(r,{row:o},t.add(s,u))}))})),r}function n(n,r){var o=!1;void 0===r[0].length&&(r=r.map((function(t){return[t]})),o=!0);var i=t.QR(n),a=i[0],c=i[1],s=n[0].length,u=t.slice(a,{col:{end:s}}),f=t.slice(c,{row:{end:s}}),l=e(f),h=t.transpose(u);void 0===h[0].length&&(h=[h]);var p=t.multiply(t.multiply(l,h),r);return void 0===p.length&&(p=[[p]]),o?p.map((function(t){return t[0]})):p}return n}(),jacobi:function(n){var r,o,i,a,c,s,u,f,l=1,h=n.length,p=t.identity(h,h),d=[];while(1===l){for(s=n[0][1],a=0,c=1,o=0;o<h;o++)for(i=0;i<h;i++)o!=i&&s<e.abs(n[o][i])&&(s=e.abs(n[o][i]),a=o,c=i);for(u=n[a][a]===n[c][c]?n[a][c]>0?e.PI/4:-e.PI/4:e.atan(2*n[a][c]/(n[a][a]-n[c][c]))/2,f=t.identity(h,h),f[a][a]=e.cos(u),f[a][c]=-e.sin(u),f[c][a]=e.sin(u),f[c][c]=e.cos(u),p=t.multiply(p,f),r=t.multiply(t.multiply(t.inv(f),n),f),n=r,l=0,o=1;o<h;o++)for(i=1;i<h;i++)o!=i&&e.abs(n[o][i])>.001&&(l=1)}for(o=0;o<h;o++)d.push(n[o][o]);return[p,d]},rungekutta:function(t,e,n,r,o,i){var a,c,s,u,f;if(2===i)while(r<=n)a=e*t(r,o),c=e*t(r+e,o+a),s=o+(a+c)/2,o=s,r+=e;if(4===i)while(r<=n)a=e*t(r,o),c=e*t(r+e/2,o+a/2),u=e*t(r+e/2,o+c/2),f=e*t(r+e,o+u),s=o+(a+2*c+2*u+f)/6,o=s,r+=e;return o},romberg:function(t,n,r,o){var i,a,c,s,u,f=0,l=(r-n)/2,h=[],p=[],d=[];while(f<o/2){for(u=t(n),c=n,s=0;c<=r;c+=l,s++)h[s]=c;for(i=h.length,c=1;c<i-1;c++)u+=(c%2!==0?4:2)*t(h[c]);u=l/3*(u+t(r)),d[f]=u,l/=2,f++}a=d.length,i=1;while(1!==a){for(c=0;c<a-1;c++)p[c]=(e.pow(4,i)*d[c+1]-d[c])/(e.pow(4,i)-1);a=p.length,d=p,p=[],i++}return d},richardson:function(t,n,r,o){function i(t,e){for(var n,r=0,o=t.length;r<o;r++)t[r]===e&&(n=r);return n}var a,c,s,u,f,l=e.abs(r-t[i(t,r)+1]),h=0,p=[],d=[];while(o>=l)a=i(t,r+o),c=i(t,r),p[h]=(n[a]-2*n[c]+n[2*c-a])/(o*o),o/=2,h++;u=p.length,s=1;while(1!=u){for(f=0;f<u-1;f++)d[f]=(e.pow(4,s)*p[f+1]-p[f])/(e.pow(4,s)-1);u=d.length,p=d,d=[],s++}return p},simpson:function(t,e,n,r){for(var o,i=(n-e)/r,a=t(e),c=[],s=e,u=0,f=1;s<=n;s+=i,u++)c[u]=s;for(o=c.length;f<o-1;f++)a+=(f%2!==0?4:2)*t(c[f]);return i/3*(a+t(n))},hermite:function(t,e,n,r){for(var o,i=t.length,a=0,c=0,s=[],u=[],f=[],l=[];c<i;c++){for(s[c]=1,o=0;o<i;o++)c!=o&&(s[c]*=(r-t[o])/(t[c]-t[o]));for(u[c]=0,o=0;o<i;o++)c!=o&&(u[c]+=1/(t[c]-t[o]));f[c]=(1-2*(r-t[c])*u[c])*(s[c]*s[c]),l[c]=(r-t[c])*(s[c]*s[c]),a+=f[c]*e[c]+l[c]*n[c]}return a},lagrange:function(t,e,n){for(var r,o,i=0,a=0,c=t.length;a<c;a++){for(o=e[a],r=0;r<c;r++)a!=r&&(o*=(n-t[r])/(t[a]-t[r]));i+=o}return i},cubic_spline:function(e,n,r){for(var o,i=e.length,a=0,c=[],s=[],u=[],f=[],l=[],h=[],p=[];a<i-1;a++)l[a]=e[a+1]-e[a];for(u[0]=0,a=1;a<i-1;a++)u[a]=3/l[a]*(n[a+1]-n[a])-3/l[a-1]*(n[a]-n[a-1]);for(a=1;a<i-1;a++)c[a]=[],s[a]=[],c[a][a-1]=l[a-1],c[a][a]=2*(l[a-1]+l[a]),c[a][a+1]=l[a],s[a][0]=u[a];for(f=t.multiply(t.inv(c),s),o=0;o<i-1;o++)h[o]=(n[o+1]-n[o])/l[o]-l[o]*(f[o+1][0]+2*f[o][0])/3,p[o]=(f[o+1][0]-f[o][0])/(3*l[o]);for(o=0;o<i;o++)if(e[o]>r)break;return o-=1,n[o]+(r-e[o])*h[o]+t.sq(r-e[o])*f[o]+(r-e[o])*t.sq(r-e[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,r,o=e.length,i=e[0].length,a=0,c=[],s=[],u=[],f=[],l=[],h=[],p=[],d=[],m=[],g=[];for(a=0;a<o;a++)c[a]=t.sum(e[a])/i;for(a=0;a<i;a++)for(p[a]=[],n=0;n<o;n++)p[a][n]=e[n][a]-c[n];for(p=t.transpose(p),a=0;a<o;a++)for(d[a]=[],n=0;n<o;n++)d[a][n]=t.dot([p[a]],[p[n]])/(i-1);for(u=t.jacobi(d),m=u[0],s=u[1],g=t.transpose(m),a=0;a<s.length;a++)for(n=a;n<s.length;n++)s[a]<s[n]&&(r=s[a],s[a]=s[n],s[n]=r,f=g[a],g[a]=g[n],g[n]=f);for(h=t.transpose(p),a=0;a<o;a++)for(l[a]=[],n=0;n<h.length;n++)l[a][n]=t.dot([g[a]],[h[n]]);return[e,s,g,l]}}),function(e){for(var n=0;n<e.length;n++)(function(e){t.fn[e]=function(n,r){var o=this;return r?(setTimeout((function(){r.call(o,t.fn[e].call(o,n))}),15),this):"number"===typeof t[e](this,n)?t[e](this,n):t(t[e](this,n))}})(e[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(t,e){var n=[].slice,r=t.utils.isNumber,o=t.utils.isArray;function i(t,n,r,o){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*n+r*o)/(n+o),a=e.sqrt(i*(1-i)*(1/n+1/o));return(t-r)/a}t.extend({zscore:function(){var e=n.call(arguments);return r(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):i.length>2?(r=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):(r=i[0],1===i[1]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(n,r,o){var i=e.abs(this.zscore(n,o));return 1===r?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/e.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/e.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=e.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=e.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=e.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-t.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,o,i,a,c,s,u,f,l=n.call(arguments);if(1===l.length){for(c=new Array(l[0].length),u=0;u<l[0].length;u++)c[u]=l[0][u];l=c}for(o=new Array,u=0;u<l.length;u++)o=o.concat(l[u]);for(i=t.mean(o),r=0,u=0;u<l.length;u++)r+=l[u].length*e.pow(t.mean(l[u])-i,2);for(r/=l.length-1,s=0,u=0;u<l.length;u++)for(a=t.mean(l[u]),f=0;f<l[u].length;f++)s+=e.pow(l[u][f]-a,2);return s/=o.length-l.length,r/s},anovaftest:function(){var e,o,i,a,c=n.call(arguments);if(r(c[0]))return 1-t.centralF.cdf(c[0],c[1],c[2]);var s=t.anovafscore(c);for(e=c.length-1,i=0,a=0;a<c.length;a++)i+=c[a].length;return o=i-e-1,1-t.centralF.cdf(s,e,o)},ftest:function(e,n,r){return 1-t.centralF.cdf(e,n,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,n-this.length)}}),t.extend({qscore:function(){var o,i,a,c,s,u=n.call(arguments);return r(u[0])?(o=u[0],i=u[1],a=u[2],c=u[3],s=u[4]):(o=t.mean(u[0]),i=t.mean(u[1]),a=u[0].length,c=u[1].length,s=u[2]),e.abs(o-i)/(s*e.sqrt((1/a+1/c)/2))},qtest:function(){var e,r=n.call(arguments);3===r.length?(e=r[0],r=r.slice(1)):7===r.length?(e=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-t.tukey.cdf(e,i,o-i)},tukeyhsd:function(e){for(var n=t.pooledstdev(e),r=e.map((function(e){return t.mean(e)})),o=e.reduce((function(t,e){return t+e.length}),0),i=[],a=0;a<e.length;++a)for(var c=a+1;c<e.length;++c){var s=t.qtest(r[a],r[c],e[a].length,e[c].length,n,o,e.length);i.push([[a,c],s])}return i}}),t.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,n){return t.normalci(e,n,this.toArray())},tci:function(e,n){return t.tci(e,n,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,1)},twoSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,2)}})}(t,Math),t.models=function(){function e(e){var r=e[0].length,o=t.arange(r).map((function(o){var i=t.arange(r).filter((function(t){return t!==o}));return n(t.col(e,o).map((function(t){return t[0]})),t.col(e,i))}));return o}function n(e,n){var r=e.length,o=n[0].length-1,i=r-o-1,a=t.lstsq(n,e),c=t.multiply(n,a.map((function(t){return[t]}))).map((function(t){return t[0]})),s=t.subtract(e,c),u=t.mean(e),f=t.sum(c.map((function(t){return Math.pow(t-u,2)}))),l=t.sum(e.map((function(t,e){return Math.pow(t-c[e],2)}))),h=f+l,p=f/h;return{exog:n,endog:e,nobs:r,df_model:o,df_resid:i,coef:a,predict:c,resid:s,ybar:u,SST:h,SSE:f,SSR:l,R2:p}}function r(n){var r=e(n.exog),o=Math.sqrt(n.SSR/n.df_resid),i=r.map((function(t){var e=t.SST,n=t.R2;return o/Math.sqrt(e*(1-n))})),a=n.coef.map((function(t,e){return(t-0)/i[e]})),c=a.map((function(e){var r=t.studentt.cdf(e,n.df_resid);return 2*(r>.5?1-r:r)})),s=t.studentt.inv(.975,n.df_resid),u=n.coef.map((function(t,e){var n=s*i[e];return[t-n,t+n]}));return{se:i,t:a,p:c,sigmaHat:o,interval95:u}}function o(e){var n=e.R2/e.df_model/((1-e.R2)/e.df_resid),r=function(e,n,r){return t.beta.cdf(e/(r/n+e),n/2,r/2)},o=1-r(n,e.df_model,e.df_resid);return{F_statistic:n,pvalue:o}}function i(t,e){var i=n(t,e),a=r(i),c=o(i),s=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=c,i.adjust_R2=s,i}return{ols:i}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++){var r=[1];e[n]=r.concat(arguments[n])}return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var r=[1];e[n]=r.concat(arguments[0][n])}return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(e,n){var r,o,i,a,c;if(e.cols()==n.rows()){if(n.rows()>1){for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<n.cols();o++){for(c=0,i=0;i<e.cols();i++)c+=e.toArray()[r][i]*n.toArray()[i][o];a[r][o]=c}return t(a)}for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<n.cols();o++){for(c=0,i=0;i<e.cols();i++)c+=e.toArray()[r][i]*n.toArray()[o];a[r][o]=c}return t(a)}},regress:function(e,n){var r=t.xtranspxinv(e),o=e.transpose(),i=t.matrixmult(t(r),o);return t.matrixmult(i,n)},regresst:function(e,n,r){var o=t.regress(e,n),i={anova:{}},a=t.jMatYBar(e,o);i.yBar=a;var c=n.mean();i.anova.residuals=t.residuals(n,a),i.anova.ssr=t.ssr(a,c),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=t.sse(n,a),i.anova.mse=i.anova.sse/(n.length-(e[0].length-1)-1),i.anova.sst=t.sst(n,c),i.anova.mst=i.anova.sst/(n.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var s,u,f,l=t.xtranspxinv(e),h=0;h<o.length;h++)s=Math.sqrt(i.anova.mse*Math.abs(l[h][h])),u=Math.abs(o[h]/s),f=t.ttest(u,n.length-e[0].length-1,r),i.stats[h]=[o[h],s,u,f];return i.regress=o,i},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e),r=t.inv(n);return r},jMatYBar:function(e,n){var r=t.matrixmult(e,n);return new t(r)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},sse:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},sst:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},matrixsubtract:function(e,n){for(var r=new Array(e.length),o=0;o<e.length;o++){r[o]=new Array(e[o].length);for(var i=0;i<e[o].length;i++)r[o][i]=e[o][i]-n[o][i]}return t(r)}}),t.jStat=t,t}))},60738:function(t,e){var n,r,o;(function(i,a){r=[],n=a,o="function"===typeof n?n.apply(e,r):n,void 0===o||(t.exports=o)})("undefined"!==typeof self&&self,(function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx},t.prototype.pattern=function(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");var e=this.disjunction();this.consumeChar("/");var n={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};while(this.isRegExpFlag())switch(this.popChar()){case"g":c(n,"global");break;case"i":c(n,"ignoreCase");break;case"m":c(n,"multiLine");break;case"u":c(n,"unicode");break;case"y":c(n,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:e,loc:this.loc(0)}},t.prototype.disjunction=function(){var t=[],e=this.idx;t.push(this.alternative());while("|"===this.peekChar())this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(e)}},t.prototype.alternative=function(){var t=[],e=this.idx;while(this.isTerm())t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(e)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead";break}s(e);var n=this.disjunction();return this.consumeChar(")"),{type:e,value:n,loc:this.loc(t)}}u()},t.prototype.quantifier=function(t){var e,n=this.idx;switch(this.popChar()){case"*":e={atLeast:0,atMost:1/0};break;case"+":e={atLeast:1,atMost:1/0};break;case"?":e={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":e={atLeast:r,atMost:r};break;case",":var o;this.isDigit()?(o=this.integerIncludingZero(),e={atLeast:r,atMost:o}):e={atLeast:r,atMost:1/0},this.consumeChar("}");break}if(!0===t&&void 0===e)return;s(e);break}if(!0!==t||void 0!==e)return s(e),"?"===this.peekChar(0)?(this.consumeChar("?"),e.greedy=!1):e.greedy=!0,e.type="Quantifier",e.loc=this.loc(n),e},t.prototype.atom=function(){var t,e=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group();break}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),s(t),t.loc=this.loc(e),this.isQuantifier()&&(t.quantifier=this.quantifier()),t},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i("\n"),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var t=this.positiveInteger();return{type:"GroupBackReference",value:t}},t.prototype.characterClassEscape=function(){var t,e=!1;switch(this.popChar()){case"d":t=f;break;case"D":t=f,e=!0;break;case"s":t=h;break;case"S":t=h,e=!0;break;case"w":t=l;break;case"W":t=l,e=!0;break}return s(t),{type:"Set",value:t,complement:e}},t.prototype.controlEscapeAtom=function(){var t;switch(this.popChar()){case"f":t=i("\f");break;case"n":t=i("\n");break;case"r":t=i("\r");break;case"t":t=i("\t");break;case"v":t=i("\v");break}return s(t),{type:"Character",value:t}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");var e=t.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:e}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var t=this.popChar();return{type:"Character",value:i(t)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var t=this.popChar();return{type:"Character",value:i(t)}}},t.prototype.characterClass=function(){var t=[],e=!1;this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);while(this.isClassAtom()){var n=this.classAtom(),r="Character"===n.type;if(r&&this.isRangeDash()){this.consumeChar("-");var o=this.classAtom(),c="Character"===o.type;if(c){if(o.value<n.value)throw Error("Range out of order in character class");t.push({from:n.value,to:o.value})}else a(n.value,t),t.push(i("-")),a(o.value,t)}else a(n.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var t=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),t=!1;break;default:this.groupIdx++;break}var e=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:t,value:e};return t&&(n.idx=this.groupIdx),n},t.prototype.positiveInteger=function(){var t=this.popChar();if(!1===o.test(t))throw Error("Expecting a positive integer");while(r.test(this.peekChar(0)))t+=this.popChar();return parseInt(t,10)},t.prototype.integerIncludingZero=function(){var t=this.popChar();if(!1===r.test(t))throw Error("Expecting an integer");while(r.test(this.peekChar(0)))t+=this.popChar();return parseInt(t,10)},t.prototype.patternCharacter=function(){var t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(t)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},t.prototype.isDigit=function(){return r.test(this.peekChar(0))},t.prototype.isClassAtom=function(t){switch(void 0===t&&(t=0),this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},t.prototype.isQuantifier=function(){var t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(t)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(t){for(var e="",r=0;r<t;r++){var o=this.popChar();if(!1===n.test(o))throw Error("Expecting a HexDecimal digits");e+=o}var i=parseInt(e,16);return{type:"Character",value:i}},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.input[this.idx+t]},t.prototype.popChar=function(){var t=this.peekChar(0);return this.consumeChar(),t},t.prototype.consumeChar=function(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(t){return{begin:t,end:this.idx}};var e,n=/[0-9a-fA-F]/,r=/[0-9]/,o=/[1-9]/;function i(t){return t.charCodeAt(0)}function a(t,e){void 0!==t.length?t.forEach((function(t){e.push(t)})):e.push(t)}function c(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e]=!0}function s(t){if(void 0===t)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var f=[];for(e=i("0");e<=i("9");e++)f.push(e);var l=[i("_")].concat(f);for(e=i("a");e<=i("z");e++)l.push(e);for(e=i("A");e<=i("Z");e++)l.push(e);var h=[i(" "),i("\f"),i("\n"),i("\r"),i("\t"),i("\v"),i("\t"),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i("\u2028"),i("\u2029"),i(" "),i(" "),i("　"),i("\ufeff")];function p(){}return p.prototype.visitChildren=function(t){for(var e in t){var n=t[e];t.hasOwnProperty(e)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(t){this.visit(t)}),this))}},p.prototype.visit=function(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t);break}this.visitChildren(t)},p.prototype.visitPattern=function(t){},p.prototype.visitFlags=function(t){},p.prototype.visitDisjunction=function(t){},p.prototype.visitAlternative=function(t){},p.prototype.visitStartAnchor=function(t){},p.prototype.visitEndAnchor=function(t){},p.prototype.visitWordBoundary=function(t){},p.prototype.visitNonWordBoundary=function(t){},p.prototype.visitLookahead=function(t){},p.prototype.visitNegativeLookahead=function(t){},p.prototype.visitCharacter=function(t){},p.prototype.visitSet=function(t){},p.prototype.visitGroup=function(t){},p.prototype.visitGroupBackReference=function(t){},p.prototype.visitQuantifier=function(t){},{RegExpParser:t,BaseRegExpVisitor:p,VERSION:"0.5.0"}}))},20043:function(t,e,n){"use strict";var r=n(55326),o=n(19868),i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(o(t)+" is not a function")}},53636:function(t,e,n){"use strict";var r=n(19241),o=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(o(t)+" is not an object")}},61752:function(t,e,n){"use strict";var r=n(72634),o=n(94605),i=n(50419),a=function(t){return function(e,n,a){var c=r(e),s=i(c);if(0===s)return!t&&-1;var u,f=o(a,s);if(t&&n!==n){while(s>f)if(u=c[f++],u!==u)return!0}else for(;s>f;f++)if((t||f in c)&&c[f]===n)return t||f||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},80374:function(t,e,n){"use strict";var r=n(78115),o=n(61789),i=TypeError,a=Object.getOwnPropertyDescriptor,c=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=c?function(t,e){if(o(t)&&!a(t,"length").writable)throw new i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},36387:function(t,e,n){"use strict";var r=n(68031),o=r({}.toString),i=r("".slice);t.exports=function(t){return i(o(t),8,-1)}},52303:function(t,e,n){"use strict";var r=n(69792),o=n(91678),i=n(29818),a=n(53560);t.exports=function(t,e,n){for(var c=o(e),s=a.f,u=i.f,f=0;f<c.length;f++){var l=c[f];r(t,l)||n&&r(n,l)||s(t,l,u(e,l))}}},97302:function(t,e,n){"use strict";var r=n(78115),o=n(53560),i=n(36541);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},36541:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},57147:function(t,e,n){"use strict";var r=n(55326),o=n(53560),i=n(11940),a=n(888);t.exports=function(t,e,n,c){c||(c={});var s=c.enumerable,u=void 0!==c.name?c.name:e;if(r(n)&&i(n,u,c),c.global)s?t[e]=n:a(e,n);else{try{c.unsafe?t[e]&&(s=!0):delete t[e]}catch(f){}s?t[e]=n:o.f(t,e,{value:n,enumerable:!1,configurable:!c.nonConfigurable,writable:!c.nonWritable})}return t}},888:function(t,e,n){"use strict";var r=n(10758),o=Object.defineProperty;t.exports=function(t,e){try{o(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},78115:function(t,e,n){"use strict";var r=n(25336);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},53412:function(t,e,n){"use strict";var r=n(10758),o=n(19241),i=r.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},89988:function(t){"use strict";var e=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw e("Maximum allowed index exceeded");return t}},54791:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},9711:function(t,e,n){"use strict";var r,o,i=n(10758),a=n(54791),c=i.process,s=i.Deno,u=c&&c.versions||s&&s.version,f=u&&u.v8;f&&(r=f.split("."),o=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(o=+r[1]))),t.exports=o},65788:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},36031:function(t,e,n){"use strict";var r=n(10758),o=n(29818).f,i=n(97302),a=n(57147),c=n(888),s=n(52303),u=n(96923);t.exports=function(t,e){var n,f,l,h,p,d,m=t.target,g=t.global,E=t.stat;if(f=g?r:E?r[m]||c(m,{}):r[m]&&r[m].prototype,f)for(l in e){if(p=e[l],t.dontCallGetSet?(d=o(f,l),h=d&&d.value):h=f[l],n=u(g?l:m+(E?".":"#")+l,t.forced),!n&&void 0!==h){if(typeof p==typeof h)continue;s(p,h)}(t.sham||h&&h.sham)&&i(p,"sham",!0),a(f,l,p,t)}}},25336:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(e){return!0}}},25573:function(t,e,n){"use strict";var r=n(25336);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},13342:function(t,e,n){"use strict";var r=n(25573),o=Function.prototype.call;t.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},9485:function(t,e,n){"use strict";var r=n(78115),o=n(69792),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,c=o(i,"name"),s=c&&"something"===function(){}.name,u=c&&(!r||r&&a(i,"name").configurable);t.exports={EXISTS:c,PROPER:s,CONFIGURABLE:u}},68031:function(t,e,n){"use strict";var r=n(25573),o=Function.prototype,i=o.call,a=r&&o.bind.bind(i,i);t.exports=r?a:function(t){return function(){return i.apply(t,arguments)}}},77434:function(t,e,n){"use strict";var r=n(10758),o=n(55326),i=function(t){return o(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t]):r[t]&&r[t][e]}},10227:function(t,e,n){"use strict";var r=n(20043),o=n(11156);t.exports=function(t,e){var n=t[e];return o(n)?void 0:r(n)}},10758:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},69792:function(t,e,n){"use strict";var r=n(68031),o=n(90142),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(o(t),e)}},13022:function(t){"use strict";t.exports={}},43148:function(t,e,n){"use strict";var r=n(78115),o=n(25336),i=n(53412);t.exports=!r&&!o((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},28286:function(t,e,n){"use strict";var r=n(68031),o=n(25336),i=n(36387),a=Object,c=r("".split);t.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===i(t)?c(t,""):a(t)}:a},69347:function(t,e,n){"use strict";var r=n(68031),o=n(55326),i=n(29812),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return a(t)}),t.exports=i.inspectSource},77328:function(t,e,n){"use strict";var r,o,i,a=n(31395),c=n(10758),s=n(19241),u=n(97302),f=n(69792),l=n(29812),h=n(72094),p=n(13022),d="Object already initialized",m=c.TypeError,g=c.WeakMap,E=function(t){return i(t)?o(t):r(t,{})},v=function(t){return function(e){var n;if(!s(e)||(n=o(e)).type!==t)throw new m("Incompatible receiver, "+t+" required");return n}};if(a||l.state){var y=l.state||(l.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,r=function(t,e){if(y.has(t))throw new m(d);return e.facade=t,y.set(t,e),e},o=function(t){return y.get(t)||{}},i=function(t){return y.has(t)}}else{var N=h("state");p[N]=!0,r=function(t,e){if(f(t,N))throw new m(d);return e.facade=t,u(t,N,e),e},o=function(t){return f(t,N)?t[N]:{}},i=function(t){return f(t,N)}}t.exports={set:r,get:o,has:i,enforce:E,getterFor:v}},61789:function(t,e,n){"use strict";var r=n(36387);t.exports=Array.isArray||function(t){return"Array"===r(t)}},55326:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports="undefined"==typeof e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},96923:function(t,e,n){"use strict";var r=n(25336),o=n(55326),i=/#|\.prototype\./,a=function(t,e){var n=s[c(t)];return n===f||n!==u&&(o(e)?r(e):!!e)},c=a.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=a.data={},u=a.NATIVE="N",f=a.POLYFILL="P";t.exports=a},11156:function(t){"use strict";t.exports=function(t){return null===t||void 0===t}},19241:function(t,e,n){"use strict";var r=n(55326);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},4388:function(t){"use strict";t.exports=!1},39830:function(t,e,n){"use strict";var r=n(77434),o=n(55326),i=n(16676),a=n(22371),c=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return o(e)&&i(e.prototype,c(t))}},50419:function(t,e,n){"use strict";var r=n(8621);t.exports=function(t){return r(t.length)}},11940:function(t,e,n){"use strict";var r=n(68031),o=n(25336),i=n(55326),a=n(69792),c=n(78115),s=n(9485).CONFIGURABLE,u=n(69347),f=n(77328),l=f.enforce,h=f.get,p=String,d=Object.defineProperty,m=r("".slice),g=r("".replace),E=r([].join),v=c&&!o((function(){return 8!==d((function(){}),"length",{value:8}).length})),y=String(String).split("String"),N=t.exports=function(t,e,n){"Symbol("===m(p(e),0,7)&&(e="["+g(p(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!a(t,"name")||s&&t.name!==e)&&(c?d(t,"name",{value:e,configurable:!0}):t.name=e),v&&n&&a(n,"arity")&&t.length!==n.arity&&d(t,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?c&&d(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(o){}var r=l(t);return a(r,"source")||(r.source=E(y,"string"==typeof e?e:"")),t};Function.prototype.toString=N((function(){return i(this)&&h(this).source||u(this)}),"toString")},85996:function(t){"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},53560:function(t,e,n){"use strict";var r=n(78115),o=n(43148),i=n(34849),a=n(53636),c=n(22370),s=TypeError,u=Object.defineProperty,f=Object.getOwnPropertyDescriptor,l="enumerable",h="configurable",p="writable";e.f=r?i?function(t,e,n){if(a(t),e=c(e),a(n),"function"===typeof t&&"prototype"===e&&"value"in n&&p in n&&!n[p]){var r=f(t,e);r&&r[p]&&(t[e]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:l in n?n[l]:r[l],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(a(t),e=c(e),a(n),o)try{return u(t,e,n)}catch(r){}if("get"in n||"set"in n)throw new s("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},29818:function(t,e,n){"use strict";var r=n(78115),o=n(13342),i=n(31786),a=n(36541),c=n(72634),s=n(22370),u=n(69792),f=n(43148),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=c(t),e=s(e),f)try{return l(t,e)}catch(n){}if(u(t,e))return a(!o(i.f,t,e),t[e])}},30079:function(t,e,n){"use strict";var r=n(13985),o=n(65788),i=o.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},99542:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},16676:function(t,e,n){"use strict";var r=n(68031);t.exports=r({}.isPrototypeOf)},13985:function(t,e,n){"use strict";var r=n(68031),o=n(69792),i=n(72634),a=n(61752).indexOf,c=n(13022),s=r([].push);t.exports=function(t,e){var n,r=i(t),u=0,f=[];for(n in r)!o(c,n)&&o(r,n)&&s(f,n);while(e.length>u)o(r,n=e[u++])&&(~a(f,n)||s(f,n));return f}},31786:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},99641:function(t,e,n){"use strict";var r=n(13342),o=n(55326),i=n(19241),a=TypeError;t.exports=function(t,e){var n,c;if("string"===e&&o(n=t.toString)&&!i(c=r(n,t)))return c;if(o(n=t.valueOf)&&!i(c=r(n,t)))return c;if("string"!==e&&o(n=t.toString)&&!i(c=r(n,t)))return c;throw new a("Can't convert object to primitive value")}},91678:function(t,e,n){"use strict";var r=n(77434),o=n(68031),i=n(30079),a=n(99542),c=n(53636),s=o([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(c(t)),n=a.f;return n?s(e,n(t)):e}},78083:function(t,e,n){"use strict";var r=n(11156),o=TypeError;t.exports=function(t){if(r(t))throw new o("Can't call method on "+t);return t}},72094:function(t,e,n){"use strict";var r=n(12940),o=n(8287),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},29812:function(t,e,n){"use strict";var r=n(4388),o=n(10758),i=n(888),a="__core-js_shared__",c=t.exports=o[a]||i(a,{});(c.versions||(c.versions=[])).push({version:"3.37.0",mode:r?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"})},12940:function(t,e,n){"use strict";var r=n(29812);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},92106:function(t,e,n){"use strict";var r=n(9711),o=n(25336),i=n(10758),a=i.String;t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol("symbol detection");return!a(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},94605:function(t,e,n){"use strict";var r=n(58294),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},72634:function(t,e,n){"use strict";var r=n(28286),o=n(78083);t.exports=function(t){return r(o(t))}},58294:function(t,e,n){"use strict";var r=n(85996);t.exports=function(t){var e=+t;return e!==e||0===e?0:r(e)}},8621:function(t,e,n){"use strict";var r=n(58294),o=Math.min;t.exports=function(t){var e=r(t);return e>0?o(e,9007199254740991):0}},90142:function(t,e,n){"use strict";var r=n(78083),o=Object;t.exports=function(t){return o(r(t))}},68072:function(t,e,n){"use strict";var r=n(13342),o=n(19241),i=n(39830),a=n(10227),c=n(99641),s=n(96972),u=TypeError,f=s("toPrimitive");t.exports=function(t,e){if(!o(t)||i(t))return t;var n,s=a(t,f);if(s){if(void 0===e&&(e="default"),n=r(s,t,e),!o(n)||i(n))return n;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),c(t,e)}},22370:function(t,e,n){"use strict";var r=n(68072),o=n(39830);t.exports=function(t){var e=r(t,"string");return o(e)?e:e+""}},19868:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},8287:function(t,e,n){"use strict";var r=n(68031),o=0,i=Math.random(),a=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++o+i,36)}},22371:function(t,e,n){"use strict";var r=n(92106);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},34849:function(t,e,n){"use strict";var r=n(78115),o=n(25336);t.exports=r&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},31395:function(t,e,n){"use strict";var r=n(10758),o=n(55326),i=r.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},96972:function(t,e,n){"use strict";var r=n(10758),o=n(12940),i=n(69792),a=n(8287),c=n(92106),s=n(22371),u=r.Symbol,f=o("wks"),l=s?u["for"]||u:u&&u.withoutSetter||a;t.exports=function(t){return i(f,t)||(f[t]=c&&i(u,t)?u[t]:l("Symbol."+t)),f[t]}},84645:function(t,e,n){"use strict";var r=n(36031),o=n(90142),i=n(50419),a=n(80374),c=n(89988),s=n(25336),u=s((function(){return 4294967297!==[].push.call({length:4294967296},1)})),f=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},l=u||!f();r({target:"Array",proto:!0,arity:1,forced:l},{push:function(t){var e=o(this),n=i(e),r=arguments.length;c(n+r);for(var s=0;s<r;s++)e[n]=arguments[s],n++;return a(e,n),n}})}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}!function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}();var r={};!function(){"use strict";var t,e,r,o,i;n(84645);(function(t){t["brand"]="Группа",t["product"]="Запчасть"})(t||(t={})),function(t){t["brand"]="brand",t["product"]="product"}(e||(e={})),function(t){t["GroupColumn1"]="Группа колонок 1",t["GroupColumn2"]="Группа колонок 2",t["GroupColumn3"]="Группа колонок 3"}(r||(r={})),function(t){t["Type"]="Тип",t["Name"]="Наименование",t["Brand"]="Брэнд",t["ProductionDate"]="Дата выпуска",t["CostOne"]="Стоимость первая",t["CostTwo"]="Стоимость вторая",t["Percent"]="Процент",t["Present"]="Наличие",t["Status"]="Статус",t["Comments"]="Комментарий"}(o||(o={})),function(t){t["Type"]="ТИП",t["Name"]="НАИМЕНОВАНИЕ",t["Brand"]="БРЭНД",t["ProductionDate"]="ДАТАВЫПУСКА",t["CostOne"]="СТОИМОСТЬПЕРВАЯ",t["CostTwo"]="СТОИМОСТЬВТОРАЯ",t["Percent"]="ПРОЦЕНТ",t["Present"]="НАЛИЧИЕ",t["Status"]="СТАТУС",t["Comments"]="КОММЕНТАРИЙ"}(i||(i={}));var a,c,s,u,f,l,h,p,d;function m(t){return Object.keys(t)}(function(t){t["Type"]="TypeRow",t["Name"]="Name",t["Brand"]="Brand",t["ProductionDate"]="ProductionDate",t["CostOne"]="CostOne",t["CostTwo"]="CostTwo",t["Percent"]="Percent",t["Present"]="Present",t["Status"]="Status",t["Comments"]="Comments"})(a||(a={})),function(t){t[t["Type"]=0]="Type",t[t["Name"]=1]="Name",t[t["Brand"]=2]="Brand",t[t["ProductionDate"]=3]="ProductionDate",t[t["CostOne"]=4]="CostOne",t[t["CostTwo"]=5]="CostTwo",t[t["Percent"]=6]="Percent",t[t["Present"]=7]="Present",t[t["Status"]=8]="Status",t[t["Comments"]=9]="Comments"}(c||(c={})),function(t){t[t["Numbs"]=-1]="Numbs",t[t["Type"]=0]="Type",t[t["Name"]=1]="Name",t[t["Brand"]=2]="Brand",t[t["ProductionDate"]=3]="ProductionDate",t[t["CostOne"]=4]="CostOne",t[t["CostTwo"]=5]="CostTwo",t[t["Percent"]=6]="Percent",t[t["Present"]=7]="Present",t[t["Status"]=8]="Status",t[t["Comments"]=9]="Comments"}(s||(s={})),function(t){t["EmptyString"]="Пустые строки",t["EmptyStringValue"]=""}(u||(u={})),function(t){t["Default"]="Default",t["Cost"]="Cost"}(f||(f={})),function(t){t["string"]="строка",t["number"]="число",t["undefined"]="тип неопредлен"}(l||(l={})),function(t){t["string"]="string",t["number"]="number",t["undefined"]="тип неопредлен"}(h||(h={})),function(t){t[t["Right"]=2]="Right",t[t["Left"]=0]="Left"}(p||(p={})),function(t){t["AND"]="И",t["OR"]="ИЛИ"}(d||(d={}));
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const g=Symbol("Comlink.proxy"),E=Symbol("Comlink.endpoint"),v=Symbol("Comlink.releaseProxy"),y=Symbol("Comlink.finalizer"),N=Symbol("Comlink.thrown"),T=t=>"object"===typeof t&&null!==t||"function"===typeof t,R={canHandle:t=>T(t)&&t[g],serialize(t){const{port1:e,port2:n}=new MessageChannel;return w(t,e),[n,[n]]},deserialize(t){return t.start(),C(t)}},A={canHandle:t=>T(t)&&N in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}},M=new Map([["proxy",R],["throw",A]]);function O(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}function w(t,e=globalThis,n=["*"]){e.addEventListener("message",(function r(o){if(!o||!o.data)return;if(!O(n,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:i,type:a,path:c}=Object.assign({path:[]},o.data),s=(o.data.argumentList||[]).map(H);let u;try{const e=c.slice(0,-1).reduce(((t,e)=>t[e]),t),n=c.reduce(((t,e)=>t[e]),t);switch(a){case"GET":u=n;break;case"SET":e[c.slice(-1)[0]]=H(o.data.value),u=!0;break;case"APPLY":u=n.apply(e,s);break;case"CONSTRUCT":{const t=new n(...s);u=V(t)}break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;w(t,n),u=j(e,[e])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[N]:0}}Promise.resolve(u).catch((t=>({value:t,[N]:0}))).then((n=>{const[o,c]=G(n);e.postMessage(Object.assign(Object.assign({},o),{id:i}),c),"RELEASE"===a&&(e.removeEventListener("message",r),S(e),y in t&&"function"===typeof t[y]&&t[y]())})).catch((t=>{const[n,r]=G({value:new TypeError("Unserializable return value"),[N]:0});e.postMessage(Object.assign(Object.assign({},n),{id:i}),r)}))})),e.start&&e.start()}function I(t){return"MessagePort"===t.constructor.name}function S(t){I(t)&&t.close()}function C(t,e){return P(t,[],e)}function b(t){if(t)throw new Error("Proxy has been released and is not useable")}function U(t){return z(t,{type:"RELEASE"}).then((()=>{S(t)}))}const L=new WeakMap,x="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(L.get(t)||0)-1;L.set(t,e),0===e&&U(t)}));function _(t,e){const n=(L.get(e)||0)+1;L.set(e,n),x&&x.register(t,e,t)}function k(t){x&&x.unregister(t)}function P(t,e=[],n=function(){}){let r=!1;const o=new Proxy(n,{get(n,i){if(b(r),i===v)return()=>{k(o),U(t),r=!0};if("then"===i){if(0===e.length)return{then:()=>o};const n=z(t,{type:"GET",path:e.map((t=>t.toString()))}).then(H);return n.then.bind(n)}return P(t,[...e,i])},set(n,o,i){b(r);const[a,c]=G(i);return z(t,{type:"SET",path:[...e,o].map((t=>t.toString())),value:a},c).then(H)},apply(n,o,i){b(r);const a=e[e.length-1];if(a===E)return z(t,{type:"ENDPOINT"}).then(H);if("bind"===a)return P(t,e.slice(0,-1));const[c,s]=F(i);return z(t,{type:"APPLY",path:e.map((t=>t.toString())),argumentList:c},s).then(H)},construct(n,o){b(r);const[i,a]=F(o);return z(t,{type:"CONSTRUCT",path:e.map((t=>t.toString())),argumentList:i},a).then(H)}});return _(o,t),o}function B(t){return Array.prototype.concat.apply([],t)}function F(t){const e=t.map(G);return[e.map((t=>t[0])),B(e.map((t=>t[1])))]}const D=new WeakMap;function j(t,e){return D.set(t,e),t}function V(t){return Object.assign(t,{[g]:!0})}function G(t){for(const[e,n]of M)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},D.get(t)||[]]}function H(t){switch(t.type){case"HANDLER":return M.get(t.name).deserialize(t.value);case"RAW":return t.value}}function z(t,e,n){return new Promise((r=>{const o=Y();t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===o&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)}))}function Y(){return new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-")}var W=n(59833),$=n.n(W);let q=[],K=new Map([]);const X=new($())({}),J={async setDataAtRowPropFn(t,e,n,r){return q=[],r&&q.push({changefileldName:e,processed:!0,changes:t}),await Q(t,e,n)}};async function Q(t,e,n){if(K=n,await Z(t,e),q.length)for(const o of q)if(!1===o.processed){await Z(o.changes,o.changefileldName);const t=q.find((t=>t.changefileldName===t.changefileldName));t&&(t.processed=!0)}if(!q.length)return;const r=[];for(const o of q)for(const t of o.changes)r.push([t[0],o.changefileldName,t[1]]);return r}async function Z(t,e){const n=Array.from(K.values()).map((t=>{if(~t.depends.indexOf(e))return t.fieldName})).filter((t=>t));for(const o of n){const e=Array.from(K.values()).find((t=>t.fieldName===o));let n=[];if(e){const i=e.tokens;n=[...i];const c=m(a);for(const e of t){const t=e[0];for(const[r,o]of i.entries())if(c.some((t=>t===o))){const i=q.find((t=>t.changefileldName===o));let a;a=i?i.changes.find((e=>e[0]===t))[1]:e[1],n[r]=String(`"${a}"`)}const a=n.join("");let s;try{s=await X.parse(a);const e=q.find((t=>t.changefileldName===o));if(e){const n=e.changes.findIndex((e=>e[0]===t));~n?e.changes[n]=[t,s]:e.changes.push([t,s])}else q.push({changefileldName:o,processed:!1,changes:[[t,s]]})}catch(r){throw new Error(r.name)}}}}}w(J)}()})();
//# sourceMappingURL=987.e1aab5c7.js.map